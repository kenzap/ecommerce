{"version":3,"file":"index.js","sources":["../../node_modules/@kenzap/k-cloud/index.js","../../src/_/_helpers.js","../../src/_/_print.js","../../src/_/_order_tables.js","../../src/_/_order_preview.js","../../src/_/_cnt_orders.js","../../src/orders/index.js"],"sourcesContent":["/**\n * @name initHeader\n * @description Initiates Kenzap Cloud extension header and related scripts. Verifies user sessions, handles SSO, does cloud space navigation, initializes i18n localization. \n * @param {object} response\n */\nexport const initHeader = (response) => {\n\n    // cache header from backend\n    if(response.header) localStorage.setItem('header', response.header);\n  \n    // load header to html if not present\n    if(!document.querySelector(\"#k-script\")){\n  \n        let child = document.createElement('div');\n        child.innerHTML = localStorage.getItem('header');\n        child = child.firstChild;\n        document.body.prepend(child);\n  \n        // run header scripts\n        Function(document.querySelector(\"#k-script\").innerHTML).call('test');\n    }\n  \n    // load locales if present\n    if(response.locale) window.i18n.init(response.locale); \n}\n\n/*\n * Translates string based on preloaded i18n locale values.\n * \n * @param text {String} text to translate\n * @param p {String} list of parameters, to be replaced with %1$, %2$..\n * @returns {String} - text\n */\nexport const __init = (locale) => {\n\n    if(typeof locale !== 'object' || locale === null) return;\n\n    if(typeof window.i18n === 'undefined') window.i18n = {};\n\n    if(typeof window.i18n.state === 'undefined') window.i18n.state = { locale: {} };\n   \n    window.i18n.state.locale = locale;\n}\n\n/*\n * Translates string based on preloaded i18n locale values.\n * \n * @param text {String} text to translate\n * @param p {String} list of parameters, to be replaced with %1$, %2$..\n * @returns {String} - text\n */\nexport const __ = (text, ...p) => {\n\n    let match = (input, pa) => {\n\n        pa.forEach((p, i) => { input = input.replace('%'+(i+1)+'$', p); }); \n        \n        return input;\n    }\n\n    if(typeof window.i18n === 'undefined') return match(text, p);\n    if(window.i18n.state.locale.values[text] === undefined) return match(text, p);\n\n    return match(window.i18n.state.locale.values[text], p);\n}\n\n/*\n * Converts special characters `&`, `<`, `>`, `\"`, `'` to HTML entities.\n * \n * @param text {String}  text\n * @returns {String} - text\n */\nexport const attr = (text) => {\n\n    text = String(text);\n\n    if(text.length === 0){\n\t\treturn '';\n\t}\n\n    return text.replace(/[&<>'\"]/g, tag => (\n        {\n            '&': '&amp;',\n            '<': '&lt;',\n            '>': '&gt;',\n            \"'\": '&#39;',\n            '\"': '&quot;'\n        } [tag]));\n}\n\n/*\n * Converts special characters `&`, `<`, `>`, `\"`, `'` to HTML entities and does translation\n * \n * @param text {String}  text\n * @returns {String} - text\n */\nexport const __attr = (text, ...p) => {\n\n    text = String(text);\n\n    if(text.length === 0){\n\t\treturn '';\n\t}\n\n    text = __(text, ...p);\n\n    return text.replace(/[&<>'\"]/g, tag => (\n        {\n            '&': '&amp;',\n            '<': '&lt;',\n            '>': '&gt;',\n            \"'\": '&#39;',\n            '\"': '&quot;'\n        } [tag]));\n}\n\n/*\n * Removes special characters `<`, `>`, `\"`, `'` from the link.\n * \n * @param text {String}  text\n * @returns {String} - text\n */\nexport const src = (text) => {\n\n    text = String(text);\n\n    if(text.length === 0){\n\t\treturn '';\n\t}\n\n    return text.replace(/[&<>'\"]/g, tag => (\n        {\n            '<': '&lt;',\n            '>': '&gt;',\n            \"'\": '&#39;',\n            '\"': '&quot;'\n        } [tag]));\n    \n}\n\n/*\n * Converts special characters `<`, `>`, `\"`, `'` from the link and does translation\n * \n * @param text {String}  text\n * @returns {String} - text\n */\nexport const __src = (text, ...p) => {\n\n    text = String(text);\n\n    if(text.length === 0){\n\t\treturn '';\n\t}\n\n    text = __(text, ...p);\n\n    return text.replace(/[&<>'\"]/g, tag => (\n        {\n            '<': '&lt;',\n            '>': '&gt;',\n            \"'\": '&#39;',\n            '\"': '&quot;'\n        } [tag]));\n}\n\n/*\n * Converts special characters `&`, `<`, `>`, `\"`, `'` to HTML entities.\n * \n * @param text {String}  text\n * @returns {String} - text\n */\nexport const html = (text) => {\n\n    text = String(text);\n\n    if(text.length === 0){\n\t\treturn '';\n\t}\n\n    return text.replace(/[&<>'\"]/g, tag => (\n        {\n            '&': '&amp;',\n            '<': '&lt;',\n            '>': '&gt;',\n            \"'\": '&#39;',\n            '\"': '&quot;'\n        } [tag]));\n}\n\n/*\n * Converts special characters `&`, `<`, `>`, `\"`, `'` to HTML entities and does translations\n * \n * @param text {String}  text\n * @returns {String} - text\n */\nexport const __html = (text, ...p) => {\n\n    text = String(text);\n\n    if(text.length === 0){\n\t\treturn '';\n\t}\n\n    text = __(text, ...p);\n\n    return text.replace(/[&<>'\"]/g, tag => (\n        {\n            '&': '&amp;',\n            '<': '&lt;',\n            '>': '&gt;',\n            \"'\": '&#39;',\n            '\"': '&quot;'\n        } [tag]));\n}\n\n/**\n * @name showLoader\n * @description Initiates full screen three dots loader.\n */\nexport const showLoader = () => {\n\n    let el = document.querySelector(\".loader\");\n    if (el) el.style.display = 'block';\n}\n\n/**\n * @name hideLoader\n * @description Removes full screen three dots loader.\n */\nexport const hideLoader = () => {\n\n    let el = document.querySelector(\".loader\");\n    if (el) el.style.display = 'none';\n}\n\n/**\n * @name initFooter\n * @description Removes full screen three dots loader.\n * @param {string} left - Text or html code to be present on the left bottom side of screen\n * @param {string} right - Text or html code to be present on the left bottom side of screen\n */\nexport const initFooter = (left, right) => {\n\n    document.querySelector(\"footer .row\").innerHTML = `\n    <div class=\"d-sm-flex justify-content-center justify-content-sm-between\">\n        <span class=\"text-muted text-center text-sm-left d-block d-sm-inline-block\">${left}</span>\n        <span class=\"float-none float-sm-right d-block mt-1 mt-sm-0 text-center text-muted\">${right}</span>\n    </div>`;\n}\n\n/**\n * @name link\n * @description Handles Cloud navigation links between extensions and its pages. Takes care of custom url parameters.\n * @param {string} slug - Any inbound link\n * \n * @returns {string} link - Returns original link with kenzp cloud space ID identifier.\n */\nexport const link = (slug) => {\n    \n    let urlParams = new URLSearchParams(window.location.search);\n    let sid = urlParams.get('sid') ? urlParams.get('sid') : \"\";\n\n    let postfix = slug.indexOf('?') == -1 ? '?sid='+sid : '&sid='+sid;\n\n    return slug + postfix;\n}\n\n/**\n * @name getSiteId\n * @description Gets current Kenzap Cloud space ID identifier from the URL.\n * \n * @returns {string} id - Kenzap Cloud space ID.\n */\nexport const getSiteId = () => {\n    \n    let urlParams = new URLSearchParams(window.location.search);\n    let id = urlParams.get('sid') ? urlParams.get('sid') : \"\";\n\n    return id;\n}\n\n/**\n * @name spaceID\n * @description Gets current Kenzap Cloud space ID identifier from the URL.\n * \n * @returns {string} id - Kenzap Cloud space ID.\n */\n export const spaceID = () => {\n    \n    let urlParams = new URLSearchParams(window.location.search);\n    let id = urlParams.get('sid') ? urlParams.get('sid') : \"\";\n\n    return id;\n}\n\n/**\n * @name setCookie\n * @description Set cookie by its name to all .kenzap.cloud subdomains\n * @param {string} name - Cookie name.\n * @param {string} value - Cookie value.\n * @param {string} days - Number of days when cookie expires.\n */\n export const setCookie = (name, value, days) => {\n\n    let expires = \"\";\n    if (days) {\n        let date = new Date();\n        date.setTime(date.getTime() + (days * 24 * 60 * 60 * 1000));\n        expires = \";expires=\" + date.toUTCString();\n    }\n    document.cookie = name + \"=\" + (escape(value) || \"\") + expires + \";path=/;domain=.kenzap.cloud\"; \n}\n\n/**\n * @name getCookie\n * @description Read cookie by its name.\n * @param {string} cname - Cookie name.\n * \n * @returns {string} value - Cookie value.\n */\nexport const getCookie = (cname) => {\n\n    let name = cname + \"=\";\n    let decodedCookie = decodeURIComponent(document.cookie);\n    let ca = decodedCookie.split(';');\n    for (let i = 0; i < ca.length; i++) {\n        let c = ca[i];\n        while (c.charAt(0) == ' ') {\n            c = c.substring(1);\n        }\n        if (c.indexOf(name) == 0) {\n            return c.substring(name.length, c.length);\n        }\n    }\n    return \"\";\n}\n\n/**\n * @name checkHeader\n * @description This function tracks UI updates, creates header version checksum and compares it after every page reload\n * @param {object} object - API response.\n */\n export const checkHeader = () => {\n\n    let version = (localStorage.hasOwnProperty('header') && localStorage.hasOwnProperty('header-version')) ? localStorage.getItem('header-version') : 0;\n    let check = window.location.hostname + '/' + spaceID() + '/' + getCookie('locale');\n    if(check != getCookie('check')){ version = 0; console.log('refresh'); }\n    \n    setCookie('check', check, 5);\n\n    return version\n}\n\n/**\n * @name headers\n * @description Default headers object for all Kenzap Cloud fetch queries. \n * @param {object} headers\n */\n export const headers = {\n    'Accept': 'application/json',\n    'Content-Type': 'application/json',\n    'Authorization': 'Bearer ' + getCookie('kenzap_api_key'),\n    'Kenzap-Locale': getCookie('locale') ? getCookie('locale') : \"en\",\n    'Kenzap-Header': checkHeader(),\n    'Kenzap-Token': getCookie('kenzap_token'),\n    'Kenzap-Sid': spaceID(),\n}\n\n/**\n * @name parseApiError\n * @description Set default logics for different API Error responses.\n * @param {object} object - API response.\n */\n export const parseApiError = (data) => {\n\n    // outout to frontend console\n    console.log(data);\n\n    // unstructured failure\n    if(isNaN(data.code)){\n    \n        // structure failure data\n        let log = data;\n        try{ log = JSON.stringify(log); }catch(e){ }\n\n        let params = new URLSearchParams();\n        params.append(\"cmd\", \"report\");\n        params.append(\"sid\", spaceID());\n        params.append(\"token\", getCookie('kenzap_token'));\n        params.append(\"data\", log);\n        \n        // report error\n        fetch('https://api-v1.kenzap.cloud/error/', { method: 'post', headers: { 'Accept': 'application/json', 'Content-type': 'application/x-www-form-urlencoded', }, body: params });\n\n        alert('Can not connect to Kenzap Cloud');  \n        return;\n    }\n    \n    // handle cloud error codes\n    switch(data.code){\n\n        // unauthorized\n        case 401:\n\n            // dev mode\n            if(window.location.href.indexOf('localhost')!=-1){ \n\n                alert(data.reason); \n                return; \n            }\n\n            // production mode\n            location.href=\"https://auth.kenzap.com/?app=65432108792785&redirect=\"+window.location.href; break;\n        \n        // something else\n        default:\n\n            alert(data.reason); \n            break;\n    }\n}\n\n/**\n * @name initBreadcrumbs\n * @description Render ui breadcrumbs.\n * @param {array} data - List of link objects containing link text and url. If url is missing then renders breadcrumb as static text. Requires html holder with .bc class.\n */\nexport const initBreadcrumbs = (data) => {\n\n    let html = '<ol class=\"breadcrumb mt-2 mb-0\">';\n    for(let bc of data){\n        \n        if(typeof(bc.link) === 'undefined'){\n\n            html += `<li class=\"breadcrumb-item\">${ bc.text }</li>`;\n        }else{\n\n            html += `<li class=\"breadcrumb-item\"><a href=\"${ bc.link }\">${ bc.text }</a></li>`;\n        }\n    }\n    html += '</ol>';\n    \n    document.querySelector(\".bc\").innerHTML = html;\n}\n\n/**\n * @name onClick\n * @description One row click event listener declaration. Works with one or many HTML selectors.\n * @param {string} sel - HTML selector, id, class, etc.\n * @param {string} fn - callback function fired on click event.\n */\nexport const onClick = (sel, fn) => {\n\n    if(document.querySelector(sel)) for( let e of document.querySelectorAll(sel) ){\n\n        e.removeEventListener('click', fn, true);\n        e.addEventListener('click', fn, true);\n    }\n}\n\n/**\n * @name onKeyUp\n * @description One row key up event listener declaration. Works with one or many HTML selectors.\n * @param {string} sel - HTML selector, id, class, etc.\n * @param {string} fn - callback function fired on click event.\n */\nexport const onKeyUp = (sel, fn) => {\n\n    if(document.querySelector(sel)) for( let e of document.querySelectorAll(sel) ){\n\n        e.removeEventListener('keyup', fn, true);\n        e.addEventListener('keyup', fn, true);\n    }\n}\n\n/**\n * @name onChange\n * @description One row change event listener declaration. Works with one or many HTML selectors.\n * @param {string} sel - HTML selector, id, class, etc.\n * @param {string} fn - callback function fired on click event.\n */\nexport const onChange = (sel, fn) => {\n\n    if(document.querySelector(sel)) for( let e of document.querySelectorAll(sel) ){\n\n        e.removeEventListener('change', fn, true);\n        e.addEventListener('change', fn, true);\n    }\n}\n\n/**\n * @name loadScript\n * @description Asynchronous script loader function.\n * @param {string} url - HTML selector, id, class, etc.\n * @param {string} cb - callback function fired immediately after script is loaded.\n */\n export const loadScript = (url, cb) => {\n\n    if (!Array.from(document.querySelectorAll('script')).some(elm => elm.src == url)) {\n      let script = document.createElement('script')\n      script.onload = cb\n      script.src = url\n      document.getElementsByTagName('head')[0].appendChild(script)\n    }\n}\n\n/**\n * @name simulateClick\n * @description Trigger on click event without user interaction.\n * @param {string} elem - HTML selector, id, class, etc.\n */\n export const simulateClick = (elem) => {\n\n\t// create our event (with options)\n\tlet evt = new MouseEvent('click', {\n\t\tbubbles: true,\n\t\tcancelable: true,\n\t\tview: window\n\t});\n\n\t// if cancelled, don't dispatch the event\n\t!elem.dispatchEvent(evt);\n};\n\n/**\n * Create a web friendly URL slug from a string.\n *\n * Requires XRegExp (http://xregexp.com) with unicode add-ons for UTF-8 support.\n *\n * Although supported, transliteration is discouraged because\n *     1) most web browsers support UTF-8 characters in URLs\n *     2) transliteration causes a loss of information\n *\n * @author Sean Murphy <sean@iamseanmurphy.com>\n * @copyright Copyright 2012 Sean Murphy. All rights reserved.\n * @license http://creativecommons.org/publicdomain/zero/1.0/\n *\n * @param string s\n * @param object opt\n * @return string\n */\n export const slugify = (s, opt) => {\n\n\ts = String(s);\n\topt = Object(opt);\n\t\n\tvar defaults = {\n\t\t'delimiter': '-',\n\t\t'limit': undefined,\n\t\t'lowercase': true,\n\t\t'replacements': {},\n\t\t'transliterate': (typeof(XRegExp) === 'undefined') ? true : false\n\t};\n\t\n\t// Merge options\n\tfor (var k in defaults) {\n\t\tif (!opt.hasOwnProperty(k)) {\n\t\t\topt[k] = defaults[k];\n\t\t}\n\t}\n\t\n\tvar char_map = {\n\t\t// Latin\n\t\t'À': 'A', 'Á': 'A', 'Â': 'A', 'Ã': 'A', 'Ä': 'A', 'Å': 'A', 'Æ': 'AE', 'Ç': 'C', \n\t\t'È': 'E', 'É': 'E', 'Ê': 'E', 'Ë': 'E', 'Ì': 'I', 'Í': 'I', 'Î': 'I', 'Ï': 'I', \n\t\t'Ð': 'D', 'Ñ': 'N', 'Ò': 'O', 'Ó': 'O', 'Ô': 'O', 'Õ': 'O', 'Ö': 'O', 'Å': 'O', \n\t\t'Ø': 'O', 'Ù': 'U', 'Ú': 'U', 'Û': 'U', 'Ü': 'U', 'Å°': 'U', 'Ý': 'Y', 'Þ': 'TH', \n\t\t'ß': 'ss', \n\t\t'à': 'a', 'á': 'a', 'â': 'a', 'ã': 'a', 'ä': 'a', 'å': 'a', 'æ': 'ae', 'ç': 'c', \n\t\t'è': 'e', 'é': 'e', 'ê': 'e', 'ë': 'e', 'ì': 'i', 'í': 'i', 'î': 'i', 'ï': 'i', \n\t\t'ð': 'd', 'ñ': 'n', 'ò': 'o', 'ó': 'o', 'ô': 'o', 'õ': 'o', 'ö': 'o', 'Å': 'o', \n\t\t'ø': 'o', 'ù': 'u', 'ú': 'u', 'û': 'u', 'ü': 'u', 'Å±': 'u', 'ý': 'y', 'þ': 'th', \n\t\t'ÿ': 'y',\n\n\t\t// Latin symbols\n\t\t'©': '(c)',\n\n\t\t// Greek\n\t\t'Α': 'A', 'Β': 'B', 'Γ': 'G', 'Δ': 'D', 'Ε': 'E', 'Ζ': 'Z', 'Η': 'H', 'Θ': '8',\n\t\t'Ι': 'I', 'Κ': 'K', 'Λ': 'L', 'Μ': 'M', 'Ν': 'N', 'Ξ': '3', 'Ο': 'O', 'Π': 'P',\n\t\t'Ρ': 'R', 'Σ': 'S', 'Τ': 'T', 'Υ': 'Y', 'Φ': 'F', 'Χ': 'X', 'Ψ': 'PS', 'Ω': 'W',\n\t\t'Î': 'A', 'Î': 'E', 'Î': 'I', 'Î': 'O', 'Î': 'Y', 'Î': 'H', 'Î': 'W', 'Îª': 'I',\n\t\t'Î«': 'Y',\n\t\t'α': 'a', 'β': 'b', 'γ': 'g', 'δ': 'd', 'ε': 'e', 'ζ': 'z', 'η': 'h', 'θ': '8',\n\t\t'ι': 'i', 'κ': 'k', 'λ': 'l', 'μ': 'm', 'ν': 'n', 'ξ': '3', 'ο': 'o', 'π': 'p',\n\t\t'ρ': 'r', 'σ': 's', 'τ': 't', 'υ': 'y', 'φ': 'f', 'χ': 'x', 'ψ': 'ps', 'ω': 'w',\n\t\t'Î¬': 'a', 'Î­': 'e', 'Î¯': 'i', 'Ï': 'o', 'Ï': 'y', 'Î®': 'h', 'Ï': 'w', 'ς': 's',\n\t\t'Ï': 'i', 'Î°': 'y', 'Ï': 'y', 'Î': 'i',\n\n\t\t// Turkish\n\t\t'Å': 'S', 'Ä°': 'I', 'Ç': 'C', 'Ü': 'U', 'Ö': 'O', 'Ä': 'G',\n\t\t'Å': 's', 'Ä±': 'i', 'ç': 'c', 'ü': 'u', 'ö': 'o', 'Ä': 'g', \n\n\t\t// Russian\n\t\t'Ð': 'A', 'Ð': 'B', 'Ð': 'V', 'Ð': 'G', 'Ð': 'D', 'Ð': 'E', 'Ð': 'Yo', 'Ð': 'Zh',\n\t\t'Ð': 'Z', 'Ð': 'I', 'Ð': 'J', 'Ð': 'K', 'Ð': 'L', 'Ð': 'M', 'Ð': 'N', 'Ð': 'O',\n\t\t'Ð': 'P', 'Ð ': 'R', 'Ð¡': 'S', 'Ð¢': 'T', 'Ð£': 'U', 'Ð¤': 'F', 'Ð¥': 'H', 'Ð¦': 'C',\n\t\t'Ð§': 'Ch', 'Ð¨': 'Sh', 'Ð©': 'Sh', 'Ðª': '', 'Ð«': 'Y', 'Ð¬': '', 'Ð­': 'E', 'Ð®': 'Yu',\n\t\t'Ð¯': 'Ya',\n\t\t'Ð°': 'a', 'Ð±': 'b', 'Ð²': 'v', 'Ð³': 'g', 'Ð´': 'd', 'Ðµ': 'e', 'Ñ': 'yo', 'Ð¶': 'zh',\n\t\t'Ð·': 'z', 'Ð¸': 'i', 'Ð¹': 'j', 'Ðº': 'k', 'Ð»': 'l', 'Ð¼': 'm', 'Ð½': 'n', 'Ð¾': 'o',\n\t\t'Ð¿': 'p', 'Ñ': 'r', 'Ñ': 's', 'Ñ': 't', 'Ñ': 'u', 'Ñ': 'f', 'Ñ': 'h', 'Ñ': 'c',\n\t\t'Ñ': 'ch', 'Ñ': 'sh', 'Ñ': 'sh', 'Ñ': '', 'Ñ': 'y', 'Ñ': '', 'Ñ': 'e', 'Ñ': 'yu',\n\t\t'Ñ': 'ya',\n\n\t\t// Ukrainian\n\t\t'Ð': 'Ye', 'Ð': 'I', 'Ð': 'Yi', 'Ò': 'G',\n\t\t'Ñ': 'ye', 'Ñ': 'i', 'Ñ': 'yi', 'Ò': 'g',\n\n\t\t// Czech\n\t\t'Ä': 'C', 'Ä': 'D', 'Ä': 'E', 'Å': 'N', 'Å': 'R', 'Š': 'S', 'Å¤': 'T', 'Å®': 'U', \n\t\t'Å½': 'Z', \n\t\t'Ä': 'c', 'Ä': 'd', 'Ä': 'e', 'Å': 'n', 'Å': 'r', 'š': 's', 'Å¥': 't', 'Å¯': 'u',\n\t\t'Å¾': 'z', \n\n\t\t// Polish\n\t\t'Ä': 'A', 'Ä': 'C', 'Ä': 'e', 'Å': 'L', 'Å': 'N', 'Ó': 'o', 'Å': 'S', 'Å¹': 'Z', \n\t\t'Å»': 'Z', \n\t\t'Ä': 'a', 'Ä': 'c', 'Ä': 'e', 'Å': 'l', 'Å': 'n', 'ó': 'o', 'Å': 's', 'Åº': 'z',\n\t\t'Å¼': 'z',\n\n\t\t// Latvian\n\t\t'Ä': 'A', 'Ä': 'C', 'Ä': 'E', 'Ä¢': 'G', 'Äª': 'i', 'Ä¶': 'k', 'Ä»': 'L', 'Å': 'N', \n\t\t'Š': 'S', 'Åª': 'u', 'Å½': 'Z', \n\t\t'Ä': 'a', 'Ä': 'c', 'Ä': 'e', 'Ä£': 'g', 'Ä«': 'i', 'Ä·': 'k', 'Ä¼': 'l', 'Å': 'n',\n\t\t'š': 's', 'Å«': 'u', 'Å¾': 'z'\n\t};\n\t\n\t// Make custom replacements\n\tfor (var k in opt.replacements) {\n\t\ts = s.replace(RegExp(k, 'g'), opt.replacements[k]);\n\t}\n\t\n\t// Transliterate characters to ASCII\n\tif (opt.transliterate) {\n\t\tfor (var k in char_map) {\n\t\t\ts = s.replace(RegExp(k, 'g'), char_map[k]);\n\t\t}\n\t}\n\t\n\t// Replace non-alphanumeric characters with our delimiter\n\tvar alnum = (typeof(XRegExp) === 'undefined') ? RegExp('[^a-z0-9]+', 'ig') : XRegExp('[^\\\\p{L}\\\\p{N}]+', 'ig');\n\ts = s.replace(alnum, opt.delimiter);\n\t\n\t// Remove duplicate delimiters\n\ts = s.replace(RegExp('[' + opt.delimiter + ']{2,}', 'g'), opt.delimiter);\n\t\n\t// Truncate slug to max. characters\n\ts = s.substring(0, opt.limit);\n\t\n\t// Remove delimiter from ends\n\ts = s.replace(RegExp('(^' + opt.delimiter + '|' + opt.delimiter + '$)', 'g'), '');\n\t\n\treturn opt.lowercase ? s.toLowerCase() : s;\n}\n\n/**\n * @name toast\n * @description Triggers toast notification. Adds toast html to the page if missing.\n * @param {string} text - Toast notification.\n */\n export const toast = (text) => {\n\n    // only add once\n    if(!document.querySelector(\".toast\")){\n\n        let html = `\n        <div class=\"position-fixed bottom-0 p-2 m-4 end-0 align-items-center\">\n            <div class=\"toast hide align-items-center text-white bg-dark border-0\" role=\"alert\" aria-live=\"assertive\" aria-atomic=\"true\" data-bs-delay=\"3000\">\n                <div class=\"d-flex\">\n                    <div class=\"toast-body\"></div>\n                    <button type=\"button\" class=\"btn-close btn-close-white me-2 m-auto\" data-bs-dismiss=\"toast\" aria-label=\"Close\"></button>\n                </div>\n            </div>\n        </div>`;\n        if(document.querySelector('body > div')) document.querySelector('body > div').insertAdjacentHTML('afterend', html);\n    }\n\n    let toast = new bootstrap.Toast(document.querySelector('.toast'));\n    document.querySelector('.toast .toast-body').innerHTML = text;  \n    toast.show();\n}","import { getCookie, getSiteId, simulateClick, headers, parseApiError, __html } from '@kenzap/k-cloud';\n\n/* \ntexts to localize\n__('required')\n__('Size')\n__('Small')\n__('Regular')\n__('Large')\n__('Subtotal')\n__('Discount by %')\n__('Discount by value')\n__('Grand Total')\n*/\n\nexport const mt = (val) => {\n\n    return (\"\"+val).length < 2 ? \"0\"+val : val;\n}\n\nexport const getProductId = () => {\n    \n    let urlParams = new URLSearchParams(window.location.search);\n    let id = urlParams.get('id') ? urlParams.get('id') : \"\";\n    return id;\n}\n\nexport const getProductIdFromLink = () => {\n    \n    let url = new URL(window.location.href);\n    let id = url.pathname.trim().split('/').slice(-2)[0];\n    return id;\n}\n\nexport const replaceQueryParam = (param, newval, search) => {\n\n    let regex = new RegExp(\"([?;&])\" + param + \"[^&;]*[;&]?\");\n    let query = search.replace(regex, \"$1\").replace(/&$/, '');\n\n    return (query.length > 2 ? query + \"&\" : \"?\") + (newval ? param + \"=\" + newval : '');\n}\n\nexport const getPageNumberOld = () => {\n\n    let url = window.location.href.split('/');\n    let page = url[url.length-1];\n    let pageN = 1;\n    if(page.indexOf('page')==0){\n      pageN = page.replace('page', '').replace('#', '');\n    }\n    // console.log(pageN);\n    return parseInt(pageN);\n}\n\nexport const getPageNumber = () => {\n\n    let urlParams = new URLSearchParams(window.location.search);\n    let page = urlParams.get('page') ? urlParams.get('page') : 1;\n\n    return parseInt(page);\n}\n\nexport const getPagination = (__, meta, cb) => {\n\n    if(typeof(meta) === 'undefined'){ document.querySelector(\"#listing_info\").innerHTML = __('no records to display'); return; }\n\n    let offset = meta.limit+meta.offset;\n    if(offset>meta.total_records) offset = meta.total_records;\n\n    document.querySelector(\"#listing_info\").innerHTML = __(\"Showing %1$ to %2$ of %3$ entries\", (1+meta.offset), (offset), meta.total_records);\n    //  \"Showing \"+(1+meta.offset)+\" to \"+(offset)+\" of \"+meta.total_records+\" entries\";\n\n    let pbc = Math.ceil(meta.total_records / meta.limit);\n    document.querySelector(\"#listing_paginate\").style.display = (pbc < 2) ? \"none\" : \"block\";\n\n    let page = getPageNumber(); \n    let html = '<ul class=\"pagination d-flex justify-content-end pagination-flat mb-0\">';\n    html += '<li class=\"paginate_button page-item previous\" id=\"listing_previous\"><a href=\"#\" aria-controls=\"order-listing\" data-type=\"prev\" data-page=\"0\" tabindex=\"0\" class=\"page-link\"><span aria-hidden=\"true\">&laquo;</span></li>';\n    let i = 0;\n    while(i<pbc){\n\n        i++; \n        if(((i >= page-3) && (i <= page)) || ((i <= page+3) && (i >=page))){\n\n            html += '<li class=\"paginate_button page-item '+((page==i)?'active':'')+'\"><a href=\"#\" aria-controls=\"order-listing\" data-type=\"page\" data-page=\"'+i+'\" tabindex=\"0\" class=\"page-link\">'+(page==i?i:i)+'</a></li>';      \n        }\n    }  \n    html += '<li class=\"paginate_button page-item next\" id=\"order-listing_next\"><a href=\"#\" aria-controls=\"order-listing\" data-type=\"next\" data-page=\"2\" tabindex=\"0\" class=\"page-link\"><span aria-hidden=\"true\">&raquo;</span></a></li>';\n    html += '</ul>'\n\n    document.querySelector(\"#listing_paginate\").innerHTML = html;\n\n    let page_link = document.querySelectorAll(\".page-link\");\n    for (const l of page_link) {\n        \n        l.addEventListener('click', function(e) {\n\n            let p = parseInt(getPageNumber());\n            let ps = p;\n            switch(l.dataset.type){ \n                case 'prev': p-=1; if(p<1) p = 1; break;\n                case 'page': p=l.dataset.page; break;\n                case 'next': p+=1; if(p>pbc) p = pbc; break;\n            }\n            \n            // update url\n            if (window.history.replaceState) {\n\n                // let url = window.location.href.split('/page');\n                // let urlF = (url[0]+'/page'+p).replace('//page', '/page');\n\n                let str = window.location.search;\n                str = replaceQueryParam('page', p, str);\n                // window.location = window.location.pathname + str\n\n                // prevents browser from storing history with each change:\n                window.history.replaceState(\"kenzap-cloud\", document.title, window.location.pathname + str);\n            }\n\n            // only refresh if page differs\n            if(ps!=p) cb();\n            \n            e.preventDefault();\n            return false;\n        });\n    }\n}\n\nexport const formatStatus = (__, st) => {\n\n    st = parseInt(st); \n    switch(st){ \n      case 0: return '<div class=\"badge bg-warning text-dark fw-light\">' + __('Draft') + '</div>';\n      case 1: return '<div class=\"badge bg-primary fw-light\">' + __('Published') + '</div>';\n      case 3: return '<div class=\"badge bg-secondary fw-light\">' + __('Unpublished') + '</div>';\n      default: return '<div class=\"badge bg-secondary fw-light\">' + __('Drafts') + '</div>';\n    }\n}\n\n/**\n    * Render price\n    * @public\n    */\n export const priceFormat = function(_this, price) {\n\n    price = makeNumber(price);\n\n    price = (Math.round(parseFloat(price) * 100)/100).toFixed(2);\n    \n    switch(_this.state.settings.currency_symb_loc){\n        case 'left': price = _this.state.settings.currency_symb + price; break;\n        case 'right': price = price + _this.state.settings.currency_symb; break;\n    }\n\n    return price;\n}\n\nexport const makeNumber = function(price) {\n\n    price = price ? price : 0;\n    price = parseFloat(price);\n    price = Math.round(price * 100) / 100;\n    return price;\n}\n\nexport const formatTime = (__, timestamp) => {\n\t\n    const d = new Date(parseInt(timestamp) * 1000);\n    return d.toLocaleDateString();\n\n    let a = new Date(timestamp * 1000);\n    let months = [__('Jan'), __('Feb'), __('Mar'), __('Apr'), __('May'), __('Jun'), __('Jul'), __('Aug'), __('Sep'), __('Oct'), __('Nov'), __('Dec')];\n    let year = a.getFullYear();\n    let month = months[a.getMonth()];\n    let date = a.getDate();\n    let hour = a.getHours();\n    let min = a.getMinutes();\n    let sec = a.getSeconds();\n    let time = date + ' ' + month + ' ' + year; // + ' ' + hour + ':' + min + ':' + sec ;\n    return time;\n}\n\n// numbers only with allowed exceptions\nexport const onlyNumbers = (sel, chars) => {\n\n    if(!document.querySelector(sel)) return;\n    \n    document.querySelector(sel).addEventListener('keypress', (e) => {\n\n        // console.log(e.which);\n\n        if((!chars.includes(e.which) && isNaN(String.fromCharCode(e.which))) || e.which == 32 || (document.querySelector(sel).value.includes(String.fromCharCode(e.which)) && chars.includes(e.which))){\n\n            // stop character from entering input\n            e.preventDefault(); \n            return false;\n        }\n    });\n}\n\n// nums only validation\nexport const numsOnly = (e, max) => {\n\n    // Only ASCII charactar in that range allowed \n    var ASCIICode = (e.which) ? e.which : e.keyCode \n    if (ASCIICode > 31 && ASCIICode != 46 && (ASCIICode < 48 || ASCIICode > 57)) \n    return false; \n\n    if(parseFloat(e.target.value)>max) \n    return false; \n\n    let dec = e.target.value.split('.');\n    if(dec.length>1)\n    if(dec[1].length>1)\n        return false;\n    \n    return true; \n}\n\nexport const onClick = (sel, fn) => {\n\n    // console.log('onClick');\n    if(document.querySelector(sel)) for( let e of document.querySelectorAll(sel) ){\n\n        e.removeEventListener('click', fn, true);\n        e.addEventListener('click', fn, true);\n    }\n}\n\n// time elapsed since creation \nexport const timeConverterAgo = (__, now, time) => {\n\n    now = parseInt(now);\n    time = parseInt(time);\n\n    // parse as elapsed time\n    let past = now - time;\n    if(past < 60) return __('moments ago');\n    if(past < 3600) return parseInt(past / 60) + ' ' + __('minutes ago');\n    if(past < 86400) return parseInt(past / 60 / 60) + ' ' + __('hours ago');\n\n    // process as normal date\n    var a = new Date(time * 1000);\n    var months = [ __('Jan'), __('Feb'), __('Mar'), __('Apr'), __('May'), __('Jun'), __('Jul'), __('Aug'), __('Sep'), __('Oct'), __('Nov'), __('Dec') ];\n    var year = a.getFullYear();\n    var month = months[a.getMonth()];\n    var date = a.getDate();\n    var hour = a.getHours();\n    var min = a.getMinutes();\n    var sec = a.getSeconds();\n    var time = date + ' ' + month + ' ' + year; // + ' ' + hour + ':' + min + ':' + sec ;\n    return time;\n}\n\nexport const parseVariations = (_this, product) => {\n\n    let html_vars = '';\n    if(typeof(product.variations !== 'undefined'))\n    for(let v in product.variations){\n\n        // variation type\n        let type = '';\t\n        if(product.variations[v].type=='checkbox') type = 'check';\n        if(product.variations[v].type=='radio')    type = 'radio';\n\n        // struct variation\n        html_vars += '\\\n        <b>' + __html(product.variations[v].title) + (product.variations[v].required == '1' ? ' <span class=\"tag\">'+__html('required')+'</span>':'')+'</b>\\\n        <div class=\"kp-'+type+'\" >';\n\n        // variation labels\n        for(let d in product.variations[v].data){\n\n            let checked = false;\n            // for public qr feed\n            // if(typeof(cart.state.product.variations[v]) !== 'undefined' && typeof(cart.state.product.variations[v].list) !== 'undefined' && typeof(cart.state.product.variations[v].list[\"_\"+d]) !== 'undefined'){ checked = true; }\n            \n            // verify variation price validity\n            product.variations[v].data[d]['price'] = makeNumber(product.variations[v].data[d]['price']);\n\n            switch(type){\n                case 'check':\n\n                html_vars += '\\\n                    <label>\\\n                        <input type=\"checkbox\" data-required=\"'+product.variations[v].required+'\" data-indexv=\"'+v+'\" data-index=\"'+d+'\" data-title=\"'+product.variations[v].data[d]['title']+'\" data-titlev=\"'+__(product.variations[v].title)+'\" data-price=\"'+product.variations[v].data[d]['price']+'\" '+(checked?'checked=\"checked\"':'')+'>\\\n                        <div class=\"checkbox\">\\\n                            <svg width=\"20px\" height=\"20px\" viewBox=\"0 0 20 20\">\\\n                                <path d=\"M3,1 L17,1 L17,1 C18.1045695,1 19,1.8954305 19,3 L19,17 L19,17 C19,18.1045695 18.1045695,19 17,19 L3,19 L3,19 C1.8954305,19 1,18.1045695 1,17 L1,3 L1,3 C1,1.8954305 1.8954305,1 3,1 Z\"></path>\\\n                                <polyline points=\"4 11 8 15 16 6\"></polyline>\\\n                            </svg>\\\n                        </div>\\\n                        <span>'+__html(product.variations[v].data[d]['title'])+'</span>\\\n                        <div class=\"price\">+ '+priceFormat(_this, product.variations[v].data[d]['price'])+'</div>\\\n                    </label>';\n                \n                break;\n                case 'radio':\n\n                html_vars += '\\\n                    <label>\\\n                        <input type=\"radio\" data-required=\"'+product.variations[v].required+'\" data-indexv=\"'+v+'\" name=\"radio'+v+'\" data-index=\"'+d+'\" data-title=\"'+product.variations[v].data[d]['title']+'\" data-titlev=\"'+__(product.variations[v].title)+'\" data-price=\"'+product.variations[v].data[d]['price']+'\" '+(checked?'checked=\"checked\"':'')+' />\\\n                        <span>'+__html(product.variations[v].data[d]['title'])+'</span>\\\n                        <div class=\"price\">+ '+priceFormat(_this, product.variations[v].data[d]['price'])+'</div>\\\n                    </label>';\n                \n                break;\n            }\n        }\n\n        html_vars += '</div>';\n    }\n\n    return html_vars;\n}\n\nexport const escape = (htmlStr) => {\n\n    return htmlStr.replace(/&/g, \"&amp;\")\n          .replace(/</g, \"&lt;\")\n          .replace(/>/g, \"&gt;\")\n          .replace(/\"/g, \"&quot;\")\n          .replace(/'/g, \"&#39;\");        \n \n}\n\nexport const unescape = (htmlStr) => {\n\n    htmlStr = htmlStr.replace(/&lt;/g , \"<\");\t \n    htmlStr = htmlStr.replace(/&gt;/g , \">\");     \n    htmlStr = htmlStr.replace(/&quot;/g , \"\\\"\");  \n    htmlStr = htmlStr.replace(/&#39;/g , \"\\'\");   \n    htmlStr = htmlStr.replace(/&amp;/g , \"&\");\n    return htmlStr;\n}\n\nexport const ecommerceUpdates = (_this, source, cb) => {\n\n    // do API query\n    fetch('https://api-v1.kenzap.cloud/ecommerce/', {\n        method: 'post',\n        headers: headers,\n        body: JSON.stringify({\n            query: {\n                updates: {\n                    type:       'updates',\n                    source:     source,\n                }\n            }\n        })\n    })\n    .then(response => response.json())\n    .then(response => {\n\n        if(response.success){\n\n            // do callback\n            cb(response);\n            \n            // parse notifications\n            renderNotifications(_this, response.messages);\n            \n        }else{\n\n\n        }\n    })\n    .catch(error => { // parseApiError(error); \n    });\n}\n\nexport const isMobile = () => {\n\n    const nav = navigator.userAgent.toLowerCase();\n    return (\n        nav.match(/iphone/i) || nav.match(/ipod/i) || nav.match(/ipad/i) || nav.match(/android/i)\n    );\n}\n\n// play notification sound. Ex.: when new order received\nexport const playSound = (_this, max) => {\n \n    // if(!max) max = _this.state.playSound.max_times;\n\n    _this.state.playSound.n = 0;\n\n    if(_this.state.playSound.timer) clearInterval(_this.state.playSound.timer);\n\n    if(_this.state.playSound.allowed) _this.state.playSound.audio.play();\n\n    // console.log(\"playing \" + _this.state.playSound.allowed);\n\n    try{\n        if(_this.state.playSound.allowed && isMobile()) window.navigator.vibrate(200);\n    }catch{\n\n    }\n\n    if(max==1) return;\n\n    _this.state.playSound.timer = setInterval(() => {\n\n        if(!_this.state.playSound.allowed) return;\n         \n        _this.state.playSound.audio.play();\n\n        if(_this.state.playSound.n > max){ clearInterval(_this.state.playSound.timer) }\n\n        _this.state.playSound.n += 1;\n\n    }, 5000);\n\n    // console.log('playSound');\n}\n\nexport const renderNotifications = (_this, messages) => {\n\n    let html = '';\n\n    let play = false;\n\n    // html\n    messages.forEach(msg => {\n\n        if(!_this.state.playSound.nids.includes(msg._id)){ _this.state.playSound.nids.push(msg._id); play = true; }\n\n        if(!document.querySelector('#contents .container [data-id=\"'+msg._id+'\"]')){\n        \n            html += `\n\n            <div class=\"alert alert-${ msg.color } alert-dismissible fade show\" role=\"alert\" data-id=\"${ msg._id }\">\n                <div class=\"d-flex align-items-center\">\n                    <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" fill=\"currentColor\" class=\"bi bi-exclamation-square flex-shrink-0 me-2\" viewBox=\"0 0 16 16\">\n                        <path d=\"M14 1a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1h12zM2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H2z\"/>\n                        <path d=\"M7.002 11a1 1 0 1 1 2 0 1 1 0 0 1-2 0zM7.1 4.995a.905.905 0 1 1 1.8 0l-.35 3.507a.552.552 0 0 1-1.1 0L7.1 4.995z\"/>\n                    </svg>\n                    <div>\n                    ${ msg.msg }\n                    </div>\n                </div>\n                <button type=\"button\" class=\"btn-close btn-dismiss-notify\" data-bs-dismiss=\"alert\" aria-label=\"Close\" data-id=\"${ msg._id }\"></button>\n            </div>`;\n        }\n    });\n\n    // play sound\n    if(play){ \n        // console.log('notify play sound'); \n        playSound(_this, 1); _this.getData(); \n    }\n\n    if(document.querySelector('#contents .container')) document.querySelector('#contents .container').insertAdjacentHTML(\"afterbegin\", html);\n\n    // listeners\n    onClick('.btn-dismiss-notify', (e) => {\n\n        // do API query\n        fetch('https://api-v1.kenzap.cloud/ecommerce/', {\n            method: 'post',\n            headers: headers,\n            body: JSON.stringify({\n                query: {\n                    updates: {\n                        type:       'dismiss',\n                        id:         e.currentTarget.dataset.id,\n                    }\n                }\n            })\n        })\n        .then(response => response.json())\n        .then(response => {\n\n            if(response.success){\n\n\n\n            }else{\n\n\n            }\n        })\n        .catch(error => { // parseApiError(error); \n        });\n    });\n\n    // order open listener\n    if(document.querySelector('.order-details')) for( let el of document.querySelectorAll('.order-details') ){\n\n        if(el.dataset.assigned == \"1\") return;\n\n        el.dataset.assigned = 1;\n\n        el.addEventListener('click', (e) => {\n\n            let el = document.querySelector(\".view-order[data-id='\"+e.currentTarget.dataset.id+\"']\");\n\n            simulateClick(el);\n\n        }, true);\n    }\n}\n\n/*\n* Load additional JS or CSS depencies\n*\n* @param    dep       dependecy. Ex.: hiebee.min.js \n* @param    cb        function to call after script is loaded (optional)       \n* @return \t{Boolen} \tresult status \n* \n*/\nexport const loadAddon = (dep, version, cb) => {\n\n    \n    const url = new URL(dep);\n\n    if(getCookie('debug')) dep = 'http://localhost:3000' + url.pathname;\n    \n    console.log(dep);\n\n    // dependency already loaded, skip\n    if(document.getElementById(dep)){ if(typeof cb === 'function') cb.call(); return; }\n\n    // detect dependency type\n    let t = dep.split('.').slice(-1)[0];\n    // console.log(dep+'loadAddon'+t);\n    switch(t){\n      case 'js':\n        \n        let js = document.createElement(\"script\");\n        js.setAttribute(\"src\", dep);\n        js.id = dep;\n        js.onload = js.onreadystatechange = function() {\n \n          if(!this.readyState || this.readyState == 'complete')\n            if(typeof cb === 'function') cb.call();\n        };\n        document.body.appendChild(js);\n        \n      break;\n      case 'css':\n\n        var head  = document.getElementsByTagName('head')[0];\n        var css  = document.createElement('link');\n        css.id   = dep;\n        css.rel  = 'stylesheet';\n        css.type = 'text/css';\n        css.href = dep;\n        head.appendChild(css);\n\n      break;\n    }\n}\n\nexport const getProductsById = (_this, products, cb) => {\n\n    // do API query\n    const response_raw = fetch('https://api-v1.kenzap.cloud/', {\n        method: 'post',\n        headers: headers,\n        body: JSON.stringify({\n            query: {\n                products: {\n                    type:       'find',\n                    fields:     '*',\n                    key:        'ecommerce-product',\n                    id:         products,\n                    sortby:     {\n                        field: 'created',\n                        order: 'DESC'\n                    }\n                }\n            }\n        })\n    })\n    .then(response => response.json())\n    .then(response => {\n\n        if (response.success) {\n\n            response.products.forEach((product, i) => {\n\n                _this.state.orderSingle.items.push({\n                    cats: [],\n                    id: product._id,\n                    index: i,\n                    note: \"\",\n                    price: product.price,\n                    qty: 1,\n                    sdesc: __html(product.sdesc),\n                    title: __html(product.title),\n                    total: product.price,\n                    type: \"new\",\n                    variations: []\n                });\n            });\n\n            cb(_this);\n        }\n    })\n    .catch(error => { console.log(error); parseApiError(error); });\n}\n\nexport let Base64={_keyStr:\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\",encode:function(e){var t=\"\";var n,r,i,s,o,u,a;var f=0;e=Base64._utf8_encode(e);while(f<e.length){n=e.charCodeAt(f++);r=e.charCodeAt(f++);i=e.charCodeAt(f++);s=n>>2;o=(n&3)<<4|r>>4;u=(r&15)<<2|i>>6;a=i&63;if(isNaN(r)){u=a=64}else if(isNaN(i)){a=64}t=t+this._keyStr.charAt(s)+this._keyStr.charAt(o)+this._keyStr.charAt(u)+this._keyStr.charAt(a)}return t},decode:function(e){var t=\"\";var n,r,i;var s,o,u,a;var f=0;e=e.replace(/[^A-Za-z0-9\\+\\/\\=]/g,\"\");while(f<e.length){s=this._keyStr.indexOf(e.charAt(f++));o=this._keyStr.indexOf(e.charAt(f++));u=this._keyStr.indexOf(e.charAt(f++));a=this._keyStr.indexOf(e.charAt(f++));n=s<<2|o>>4;r=(o&15)<<4|u>>2;i=(u&3)<<6|a;t=t+String.fromCharCode(n);if(u!=64){t=t+String.fromCharCode(r)}if(a!=64){t=t+String.fromCharCode(i)}}t=Base64._utf8_decode(t);return t},_utf8_encode:function(e){e=e.replace(/\\r\\n/g,\"\\n\");var t=\"\";for(var n=0;n<e.length;n++){var r=e.charCodeAt(n);if(r<128){t+=String.fromCharCode(r)}else if(r>127&&r<2048){t+=String.fromCharCode(r>>6|192);t+=String.fromCharCode(r&63|128)}else{t+=String.fromCharCode(r>>12|224);t+=String.fromCharCode(r>>6&63|128);t+=String.fromCharCode(r&63|128)}}return t},_utf8_decode:function(e){var t=\"\";var n=0;var r=c1=c2=0;while(n<e.length){r=e.charCodeAt(n);if(r<128){t+=String.fromCharCode(r);n++}else if(r>191&&r<224){c2=e.charCodeAt(n+1);t+=String.fromCharCode((r&31)<<6|c2&63);n+=2}else{c2=e.charCodeAt(n+1);c3=e.charCodeAt(n+2);t+=String.fromCharCode((r&15)<<12|(c2&63)<<6|c3&63);n+=3}}return t}}\n\nexport const getCurrencies = () => {\n\n    // length 164\n    return [\n        {\"name\":\"Afghan Afghani\",\"code\":\"AFA\",\"symbol\":\"؋\"},\n        {\"name\":\"Albanian Lek\",\"code\":\"ALL\",\"symbol\":\"Lek\"},\n        {\"name\":\"Algerian Dinar\",\"code\":\"DZD\",\"symbol\":\"دج\"},\n        {\"name\":\"Angolan Kwanza\",\"code\":\"AOA\",\"symbol\":\"Kz\"},\n        {\"name\":\"Argentine Peso\",\"code\":\"ARS\",\"symbol\":\"$\"},\n        {\"name\":\"Armenian Dram\",\"code\":\"AMD\",\"symbol\":\"֏\"},\n        {\"name\":\"Aruban Florin\",\"code\":\"AWG\",\"symbol\":\"ƒ\"},\n        {\"name\":\"Australian Dollar\",\"code\":\"AUD\",\"symbol\":\"$\"},\n        {\"name\":\"Azerbaijani Manat\",\"code\":\"AZN\",\"symbol\":\"m\"},\n        {\"name\":\"Bahamian Dollar\",\"code\":\"BSD\",\"symbol\":\"B$\"},\n        {\"name\":\"Bahraini Dinar\",\"code\":\"BHD\",\"symbol\":\".د.ب\"},\n        {\"name\":\"Bangladeshi Taka\",\"code\":\"BDT\",\"symbol\":\"৳\"},\n        {\"name\":\"Barbadian Dollar\",\"code\":\"BBD\",\"symbol\":\"Bds$\"},\n        {\"name\":\"Belarusian Ruble\",\"code\":\"BYR\",\"symbol\":\"Br\"},\n        {\"name\":\"Belgian Franc\",\"code\":\"BEF\",\"symbol\":\"fr\"},\n        {\"name\":\"Belize Dollar\",\"code\":\"BZD\",\"symbol\":\"$\"},\n        {\"name\":\"Bermudan Dollar\",\"code\":\"BMD\",\"symbol\":\"$\"},\n        {\"name\":\"Bhutanese Ngultrum\",\"code\":\"BTN\",\"symbol\":\"Nu.\"},\n        {\"name\":\"Bitcoin\",\"code\":\"BTC\",\"symbol\":\"฿\"},\n        {\"name\":\"Bolivian Boliviano\",\"code\":\"BOB\",\"symbol\":\"Bs.\"},\n        {\"name\":\"Bosnia-Herzegovina Convertible Mark\",\"code\":\"BAM\",\"symbol\":\"KM\"},\n        {\"name\":\"Botswanan Pula\",\"code\":\"BWP\",\"symbol\":\"P\"},\n        {\"name\":\"Brazilian Real\",\"code\":\"BRL\",\"symbol\":\"R$\"},\n        {\"name\":\"British Pound Sterling\",\"code\":\"GBP\",\"symbol\":\"£\"},\n        {\"name\":\"Brunei Dollar\",\"code\":\"BND\",\"symbol\":\"B$\"},\n        {\"name\":\"Bulgarian Lev\",\"code\":\"BGN\",\"symbol\":\"Лв.\"},\n        {\"name\":\"Burundian Franc\",\"code\":\"BIF\",\"symbol\":\"FBu\"},\n        {\"name\":\"Cambodian Riel\",\"code\":\"KHR\",\"symbol\":\"KHR\"},\n        {\"name\":\"Canadian Dollar\",\"code\":\"CAD\",\"symbol\":\"$\"},\n        {\"name\":\"Cape Verdean Escudo\",\"code\":\"CVE\",\"symbol\":\"$\"},\n        {\"name\":\"Cayman Islands Dollar\",\"code\":\"KYD\",\"symbol\":\"$\"},\n        {\"name\":\"CFA Franc BCEAO\",\"code\":\"XOF\",\"symbol\":\"CFA\"},\n        {\"name\":\"CFA Franc BEAC\",\"code\":\"XAF\",\"symbol\":\"FCFA\"},\n        {\"name\":\"CFP Franc\",\"code\":\"XPF\",\"symbol\":\"₣\"},\n        {\"name\":\"Chilean Peso\",\"code\":\"CLP\",\"symbol\":\"$\"},\n        {\"name\":\"Chinese Yuan\",\"code\":\"CNY\",\"symbol\":\"¥\"},\n        {\"name\":\"Colombian Peso\",\"code\":\"COP\",\"symbol\":\"$\"},\n        {\"name\":\"Comorian Franc\",\"code\":\"KMF\",\"symbol\":\"CF\"},\n        {\"name\":\"Congolese Franc\",\"code\":\"CDF\",\"symbol\":\"FC\"},\n        {\"name\":\"Costa Rican Colón\",\"code\":\"CRC\",\"symbol\":\"₡\"},\n        {\"name\":\"Croatian Kuna\",\"code\":\"HRK\",\"symbol\":\"kn\"},\n        {\"name\":\"Cuban Convertible Peso\",\"code\":\"CUC\",\"symbol\":\"$, CUC\"},\n        {\"name\":\"Czech Republic Koruna\",\"code\":\"CZK\",\"symbol\":\"Kč\"},\n        {\"name\":\"Danish Krone\",\"code\":\"DKK\",\"symbol\":\"Kr.\"},\n        {\"name\":\"Djiboutian Franc\",\"code\":\"DJF\",\"symbol\":\"Fdj\"},\n        {\"name\":\"Dominican Peso\",\"code\":\"DOP\",\"symbol\":\"$\"},\n        {\"name\":\"East Caribbean Dollar\",\"code\":\"XCD\",\"symbol\":\"$\"},\n        {\"name\":\"Egyptian Pound\",\"code\":\"EGP\",\"symbol\":\"ج.م\"},\n        {\"name\":\"Eritrean Nakfa\",\"code\":\"ERN\",\"symbol\":\"Nfk\"},\n        {\"name\":\"Estonian Kroon\",\"code\":\"EEK\",\"symbol\":\"kr\"},\n        {\"name\":\"Ethiopian Birr\",\"code\":\"ETB\",\"symbol\":\"Nkf\"},\n        {\"name\":\"Euro\",\"code\":\"EUR\",\"symbol\":\"€\"},\n        {\"name\":\"Falkland Islands Pound\",\"code\":\"FKP\",\"symbol\":\"£\"},\n        {\"name\":\"Fijian Dollar\",\"code\":\"FJD\",\"symbol\":\"FJ$\"},\n        {\"name\":\"Gambian Dalasi\",\"code\":\"GMD\",\"symbol\":\"D\"},\n        {\"name\":\"Georgian Lari\",\"code\":\"GEL\",\"symbol\":\"ლ\"},\n        {\"name\":\"German Mark\",\"code\":\"DEM\",\"symbol\":\"DM\"},\n        {\"name\":\"Ghanaian Cedi\",\"code\":\"GHS\",\"symbol\":\"GH₵\"},\n        {\"name\":\"Gibraltar Pound\",\"code\":\"GIP\",\"symbol\":\"£\"},\n        {\"name\":\"Greek Drachma\",\"code\":\"GRD\",\"symbol\":\"₯, Δρχ, Δρ\"},\n        {\"name\":\"Guatemalan Quetzal\",\"code\":\"GTQ\",\"symbol\":\"Q\"},\n        {\"name\":\"Guinean Franc\",\"code\":\"GNF\",\"symbol\":\"FG\"},\n        {\"name\":\"Guyanaese Dollar\",\"code\":\"GYD\",\"symbol\":\"$\"},\n        {\"name\":\"Haitian Gourde\",\"code\":\"HTG\",\"symbol\":\"G\"},\n        {\"name\":\"Honduran Lempira\",\"code\":\"HNL\",\"symbol\":\"L\"},\n        {\"name\":\"Hong Kong Dollar\",\"code\":\"HKD\",\"symbol\":\"$\"},\n        {\"name\":\"Hungarian Forint\",\"code\":\"HUF\",\"symbol\":\"Ft\"},\n        {\"name\":\"Icelandic króna\",\"code\":\"ISK\",\"symbol\":\"kr\"},\n        {\"name\":\"Indian Rupee\",\"code\":\"INR\",\"symbol\":\"₹\"},\n        {\"name\":\"Indonesian Rupiah\",\"code\":\"IDR\",\"symbol\":\"Rp\"},\n        {\"name\":\"Iranian Rial\",\"code\":\"IRR\",\"symbol\":\"﷼\"},\n        {\"name\":\"Iraqi Dinar\",\"code\":\"IQD\",\"symbol\":\"د.ع\"},\n        {\"name\":\"Israeli New Sheqel\",\"code\":\"ILS\",\"symbol\":\"₪\"},\n        {\"name\":\"Italian Lira\",\"code\":\"ITL\",\"symbol\":\"L,£\"},\n        {\"name\":\"Jamaican Dollar\",\"code\":\"JMD\",\"symbol\":\"J$\"},\n        {\"name\":\"Japanese Yen\",\"code\":\"JPY\",\"symbol\":\"¥\"},\n        {\"name\":\"Jordanian Dinar\",\"code\":\"JOD\",\"symbol\":\"ا.د\"},\n        {\"name\":\"Kazakhstani Tenge\",\"code\":\"KZT\",\"symbol\":\"лв\"},\n        {\"name\":\"Kenyan Shilling\",\"code\":\"KES\",\"symbol\":\"KSh\"},\n        {\"name\":\"Kuwaiti Dinar\",\"code\":\"KWD\",\"symbol\":\"ك.د\"},\n        {\"name\":\"Kyrgystani Som\",\"code\":\"KGS\",\"symbol\":\"лв\"},\n        {\"name\":\"Laotian Kip\",\"code\":\"LAK\",\"symbol\":\"₭\"},\n        {\"name\":\"Latvian Lats\",\"code\":\"LVL\",\"symbol\":\"Ls\"},\n        {\"name\":\"Lebanese Pound\",\"code\":\"LBP\",\"symbol\":\"£\"},\n        {\"name\":\"Lesotho Loti\",\"code\":\"LSL\",\"symbol\":\"L\"},\n        {\"name\":\"Liberian Dollar\",\"code\":\"LRD\",\"symbol\":\"$\"},\n        {\"name\":\"Libyan Dinar\",\"code\":\"LYD\",\"symbol\":\"د.ل\"},\n        {\"name\":\"Lithuanian Litas\",\"code\":\"LTL\",\"symbol\":\"Lt\"},\n        {\"name\":\"Macanese Pataca\",\"code\":\"MOP\",\"symbol\":\"$\"},\n        {\"name\":\"Macedonian Denar\",\"code\":\"MKD\",\"symbol\":\"ден\"},\n        {\"name\":\"Malagasy Ariary\",\"code\":\"MGA\",\"symbol\":\"Ar\"},\n        {\"name\":\"Malawian Kwacha\",\"code\":\"MWK\",\"symbol\":\"MK\"},\n        {\"name\":\"Malaysian Ringgit\",\"code\":\"MYR\",\"symbol\":\"RM\"},\n        {\"name\":\"Maldivian Rufiyaa\",\"code\":\"MVR\",\"symbol\":\"Rf\"},\n        {\"name\":\"Mauritanian Ouguiya\",\"code\":\"MRO\",\"symbol\":\"MRU\"},\n        {\"name\":\"Mauritian Rupee\",\"code\":\"MUR\",\"symbol\":\"₨\"},\n        {\"name\":\"Mexican Peso\",\"code\":\"MXN\",\"symbol\":\"$\"},\n        {\"name\":\"Moldovan Leu\",\"code\":\"MDL\",\"symbol\":\"L\"},\n        {\"name\":\"Mongolian Tugrik\",\"code\":\"MNT\",\"symbol\":\"₮\"},\n        {\"name\":\"Moroccan Dirham\",\"code\":\"MAD\",\"symbol\":\"MAD\"},\n        {\"name\":\"Mozambican Metical\",\"code\":\"MZM\",\"symbol\":\"MT\"},\n        {\"name\":\"Myanmar Kyat\",\"code\":\"MMK\",\"symbol\":\"K\"},\n        {\"name\":\"Namibian Dollar\",\"code\":\"NAD\",\"symbol\":\"$\"},\n        {\"name\":\"Nepalese Rupee\",\"code\":\"NPR\",\"symbol\":\"₨\"},\n        {\"name\":\"Netherlands Antillean Guilder\",\"code\":\"ANG\",\"symbol\":\"ƒ\"},\n        {\"name\":\"New Taiwan Dollar\",\"code\":\"TWD\",\"symbol\":\"$\"},\n        {\"name\":\"New Zealand Dollar\",\"code\":\"NZD\",\"symbol\":\"$\"},\n        {\"name\":\"Nicaraguan Córdoba\",\"code\":\"NIO\",\"symbol\":\"C$\"},\n        {\"name\":\"Nigerian Naira\",\"code\":\"NGN\",\"symbol\":\"₦\"},\n        {\"name\":\"North Korean Won\",\"code\":\"KPW\",\"symbol\":\"₩\"},\n        {\"name\":\"Norwegian Krone\",\"code\":\"NOK\",\"symbol\":\"kr\"},\n        {\"name\":\"Omani Rial\",\"code\":\"OMR\",\"symbol\":\".ع.ر\"},\n        {\"name\":\"Pakistani Rupee\",\"code\":\"PKR\",\"symbol\":\"₨\"},\n        {\"name\":\"Panamanian Balboa\",\"code\":\"PAB\",\"symbol\":\"B/.\"},\n        {\"name\":\"Papua New Guinean Kina\",\"code\":\"PGK\",\"symbol\":\"K\"},\n        {\"name\":\"Paraguayan Guarani\",\"code\":\"PYG\",\"symbol\":\"₲\"},\n        {\"name\":\"Peruvian Nuevo Sol\",\"code\":\"PEN\",\"symbol\":\"S/.\"},\n        {\"name\":\"Philippine Peso\",\"code\":\"PHP\",\"symbol\":\"₱\"},\n        {\"name\":\"Polish Zloty\",\"code\":\"PLN\",\"symbol\":\"zł\"},\n        {\"name\":\"Qatari Rial\",\"code\":\"QAR\",\"symbol\":\"ق.ر\"},\n        {\"name\":\"Romanian Leu\",\"code\":\"RON\",\"symbol\":\"lei\"},\n        {\"name\":\"Russian Ruble\",\"code\":\"RUB\",\"symbol\":\"₽\"},\n        {\"name\":\"Rwandan Franc\",\"code\":\"RWF\",\"symbol\":\"FRw\"},\n        {\"name\":\"Salvadoran Colón\",\"code\":\"SVC\",\"symbol\":\"₡\"},\n        {\"name\":\"Samoan Tala\",\"code\":\"WST\",\"symbol\":\"SAT\"},\n        {\"name\":\"Saudi Riyal\",\"code\":\"SAR\",\"symbol\":\"﷼\"},\n        {\"name\":\"Serbian Dinar\",\"code\":\"RSD\",\"symbol\":\"din\"},\n        {\"name\":\"Seychellois Rupee\",\"code\":\"SCR\",\"symbol\":\"SRe\"},\n        {\"name\":\"Sierra Leonean Leone\",\"code\":\"SLL\",\"symbol\":\"Le\"},\n        {\"name\":\"Singapore Dollar\",\"code\":\"SGD\",\"symbol\":\"$\"},\n        {\"name\":\"Slovak Koruna\",\"code\":\"SKK\",\"symbol\":\"Sk\"},\n        {\"name\":\"Solomon Islands Dollar\",\"code\":\"SBD\",\"symbol\":\"Si$\"},\n        {\"name\":\"Somali Shilling\",\"code\":\"SOS\",\"symbol\":\"Sh.so.\"},\n        {\"name\":\"South African Rand\",\"code\":\"ZAR\",\"symbol\":\"R\"},\n        {\"name\":\"South Korean Won\",\"code\":\"KRW\",\"symbol\":\"₩\"},\n        {\"name\":\"Special Drawing Rights\",\"code\":\"XDR\",\"symbol\":\"SDR\"},\n        {\"name\":\"Sri Lankan Rupee\",\"code\":\"LKR\",\"symbol\":\"Rs\"},\n        {\"name\":\"St. Helena Pound\",\"code\":\"SHP\",\"symbol\":\"£\"},\n        {\"name\":\"Sudanese Pound\",\"code\":\"SDG\",\"symbol\":\".س.ج\"},\n        {\"name\":\"Surinamese Dollar\",\"code\":\"SRD\",\"symbol\":\"$\"},\n        {\"name\":\"Swazi Lilangeni\",\"code\":\"SZL\",\"symbol\":\"E\"},\n        {\"name\":\"Swedish Krona\",\"code\":\"SEK\",\"symbol\":\"kr\"},\n        {\"name\":\"Swiss Franc\",\"code\":\"CHF\",\"symbol\":\"CHf\"},\n        {\"name\":\"Syrian Pound\",\"code\":\"SYP\",\"symbol\":\"LS\"},\n        {\"name\":\"São Tomé and Príncipe Dobra\",\"code\":\"STD\",\"symbol\":\"Db\"},\n        {\"name\":\"Tajikistani Somoni\",\"code\":\"TJS\",\"symbol\":\"SM\"},\n        {\"name\":\"Tanzanian Shilling\",\"code\":\"TZS\",\"symbol\":\"TSh\"},\n        {\"name\":\"Thai Baht\",\"code\":\"THB\",\"symbol\":\"฿\"},\n        {\"name\":\"Tongan Pa'anga\",\"code\":\"TOP\",\"symbol\":\"$\"},\n        {\"name\":\"Trinidad & Tobago Dollar\",\"code\":\"TTD\",\"symbol\":\"$\"},\n        {\"name\":\"Tunisian Dinar\",\"code\":\"TND\",\"symbol\":\"ت.د\"},\n        {\"name\":\"Turkish Lira\",\"code\":\"TRY\",\"symbol\":\"₺\"},\n        {\"name\":\"Turkmenistani Manat\",\"code\":\"TMT\",\"symbol\":\"T\"},\n        {\"name\":\"Ugandan Shilling\",\"code\":\"UGX\",\"symbol\":\"USh\"},\n        {\"name\":\"Ukrainian Hryvnia\",\"code\":\"UAH\",\"symbol\":\"₴\"},\n        {\"name\":\"United Arab Emirates Dirham\",\"code\":\"AED\",\"symbol\":\"إ.د\"},\n        {\"name\":\"Uruguayan Peso\",\"code\":\"UYU\",\"symbol\":\"$\"},\n        {\"name\":\"US Dollar\",\"code\":\"USD\",\"symbol\":\"$\"},\n        {\"name\":\"Uzbekistan Som\",\"code\":\"UZS\",\"symbol\":\"лв\"},\n        {\"name\":\"Vanuatu Vatu\",\"code\":\"VUV\",\"symbol\":\"VT\"},\n        {\"name\":\"Venezuelan  Bolívar\",\"code\":\"VEF\",\"symbol\":\"Bs\"},\n        {\"name\":\"Vietnamese Dong\",\"code\":\"VND\",\"symbol\":\"₫\"},\n        {\"name\":\"Yemeni Rial\",\"code\":\"YER\",\"symbol\":\"﷼\"},\n        {\"name\":\"Zambian Kwacha\",\"code\":\"ZMK\",\"symbol\":\"ZK\"}\n    ];\n}","import { headers, __html, parseApiError, spaceID, toast } from '@kenzap/k-cloud';\nimport { priceFormat } from \"../_/_helpers.js\"\n\nexport const printReceipt = (_this, _id, type, template, debug = false) => {\n\n    let o = {}, data = {}, date = new Date();\n    if(_id==\"test\"){\n\n        o = {\n            _id: \"test\",\n            id: \"test\",\n            created: 1649831099,\n            from: \"dine-in\",\n            idd: \"\",\n            items: [\n                {\n                    cats: [],\n                    id: \"02de5fc62938ba0b031b4e80e962bac15a7285d8\",\n                    index: \"0\",\n                    note: \"\",\n                    price: 45,\n                    qty: 2,\n                    sdesc: \"Salted Egg Crab\",\n                    title: \"咸蛋螃蟹\",\n                    total: 45,\n                    type: \"new\",\n                    variations: [],\n                },\n                {\n                    cats: [],\n                    id: \"69ae96cfb7b25c358dd07560fc55e7d83cae2eb7\",\n                    index: \"0\",\n                    note: \"\",\n                    price: 45,\n                    qty: 1,\n                    sdesc: \"Kam Heong Crab\",\n                    title: \"金香螃蟹\",\n                    total: 45,\n                    type: \"new\",\n                    variations: [],\n                },\n                {\n                    cats: ['Other'],\n                    id: \"a678f2b21a3a3f7e97b6707d8223f32d17ecbefa\",\n                    index: \"0\",\n                    note: \"\",\n                    price: 10,\n                    qty: 12,\n                    sdesc: \"\",\n                    title: \"鱼鳔羮\",\n                    total: 10,\n                    type: \"new\",\n                    variations: [],\n                },\n                {\n                    cats: ['Other'],\n                    id: \"a678f2b21a3a3f7e97b6707d8223f32d17ecbefa\",\n                    index: \"0\",\n                    note: \"\",\n                    price: 25,\n                    qty: 1,\n                    sdesc: \"\",\n                    title: \"螃蟹米粉汤 (粗/幼米粉）\",\n                    total: 25,\n                    type: \"new\",\n                    variations: [],\n                },\n                {\n                    cats: ['Other'],\n                    id: \"a678f2b21a3a3f7e97b6707d8223f32d17ecbefa\",\n                    index: \"0\",\n                    note: \"\",\n                    price: 4,\n                    qty: 1,\n                    sdesc: \"\",\n                    title: \"Fied Chicken Noodles\",\n                    total: 4,\n                    type: \"new\",\n                    variations: [],\n                }\n            ],\n            kid: \"0\",\n            name: \"dine-in\",\n            note: \"\",\n            sid: spaceID,\n            status: \"new\",\n            price: { \n                discount_percent: 10,\n                discount_total: 11.105,\n                discount_value: 0,\n                fee_total: 0,\n                grand_total: 99.95,\n                payment_method: \"Cash\",\n                tax_percent: 0,\n                tax_total: 0,\n                total: 111.05 \n            },\n            step: 1,\n            table: \"table test\",\n            total: 111.05,\n            total_all: 99.95,\n            updated: 1649833845\n        }\n\n    }else{\n        o = _this.state.orders.filter(order => { return order._id == _id; })[0], data = {}, date = new Date();\n    }\n \n    // console.log(o);\n\n    // debug vs actual print\n    data.debug = debug;\n\n    // find receipt template if none is provided\n    if(!template){\n\n        // any user designated templates?\n        let templates = _this.state.settings['templates'].filter(template => { return template.type == \"receipt\" && (template.user == _this.state.user.id); });\n        \n        // get default templagte\n        if(templates.length == 0) templates = _this.state.settings['templates'].filter(template => { return template.type == \"receipt\" && (template.user == \"\"); });\n\n        // assign template\n        data.print = templates.length > 0 ? templates[0].template : \"Kenzap Cloud: no receipt template found\";\n\n        // default\n        template = templates.length > 0 ? templates[0] : {};\n    }else{\n\n        data.print = template.template;\n    }\n\n    console.log(template);\n\n    // find max char per line parameter\n    let cols_p = data.print.indexOf('[W:'); let cols = 20;\n    if(cols_p!=-1){ cols = parseInt(data.print.substr(cols_p+3, 2)); data.print = data.print.substr(0, cols_p) + data.print.substr(cols_p+6, data.print.length); }\n\n    // order id\n    data.print = data.print.replace(/{{order_id}}/g, o.id);\n\n    // table no\n    data.print = data.print.replace(/{{order_table}}/g, o.table ? o.table : \"\");\n\n    // current time\n    data.print = data.print.replace(/{{date_time}}/g, date.toLocaleString([], { dateStyle: 'medium', timeStyle: 'short', }));\n\n    // order items\n    data.print = data.print.replace(/{{order_items}}/g, getPrintItems(_this, o, '', cols));\n\n    // order items restricted by category\n    const matches = data.print.matchAll(/{{order_items:(.*?):start}}/g);\n    Array.from(matches, x => x[1]).forEach(cat => {\n\n        // console.log(cat);\n\n        // const items_match = data.print.matchAll(/{{order_items:Frog:start}}([\\s\\S]*?){{order_items:Frog:end}}/g);\n\n        let items_restricted = getPrintItems(_this, o, cat, cols);\n\n        // order items cat\n        let replace = \"{{order_items:\"+cat+\"}}\";\n        let re = new RegExp(replace,\"g\");\n        data.print = data.print.replace(re, items_restricted);\n\n        // remove entire block if no items for requested category are present \n        if(items_restricted.length<2){\n\n            let start = data.print.indexOf(\"{{order_items:\"+cat+\":start}}\");\n            let end = data.print.indexOf(\"{{order_items:\"+cat+\":end}}\") + (\"{{order_items:\"+cat+\":end}}\").length;\n\n            data.print = data.print.slice(0, start) + data.print.slice(end);\n\n        // get rid of start/end row indicators\n        }else{\n\n            replace = \"\\n{{order_items:\"+cat+\":start}}\";\n            re = new RegExp(replace,\"g\");\n            data.print = data.print.replace(re, '');\n\n            replace = \"\\n{{order_items:\"+cat+\":end}}\";\n            re = new RegExp(replace,\"g\");\n            data.print = data.print.replace(re, '');\n        }\n    });\n\n    // order note\n    let note = !o.note || o.note == '<br>' ? '' : o.note;\n    if(note.length>0){\n        //  data.print += '[C]================================';\n        data.print = data.print.replace(/{{order_note}}/g, '[C]================================\\n' + note + '\\n[C]================================\\n');\n    }\n\n    // order totals\n    data.print = data.print.replace(/{{total}}/g, priceFormat(_this, o.price.total));\n    data.print = data.print.replace(/{{tax_total}}/g, priceFormat(_this, o.price.tax_total));\n    data.print = data.print.replace(/{{discount_total}}/g, priceFormat(_this, o.price.discount_total));\n    data.print = data.print.replace(/{{grand_total}}/g, priceFormat(_this, o.price.grand_total));\n\n    let order_totals  = '';\n    order_totals += '[L]' + __('Subtotal')+'[R]' + priceFormat(_this, o.price.total) + '\\n';\n    if(o.price.discount_total > 0) order_totals += '[L]'+__('Discount')+'[R]-' + priceFormat(_this, o.price.discount_total) + '\\n';\n    if(o.price.fee_total > 0) order_totals += '[L]'+_this.state.settings.fee_display+'[R]' + priceFormat(_this, o.price.fee_total) + '\\n';\n    if(o.price.tax_total > 0) order_totals += '[L]'+_this.state.settings.tax_display+'[R]' + priceFormat(_this, o.price.tax_total) + '\\n';\n    if(o.price.grand_total > 0) order_totals += '[L]'+__('Grand Total')+'[R]' + priceFormat(_this, o.price.grand_total);\n\n    data.print = data.print.replace(/{{order_totals}}/g, order_totals);\n\n    // qr link\n    // data.print = data.print.replace(/{{qr_link}}/g, 'http://'+_this.state.qr_settings.slug + '.kenzap.site');\n    if(document.querySelector('#qr-number')) data.print = data.print.replace(/{{qr_number}}/g, document.querySelector('#qr-number').value);\n\n    if(data.debug){ console.log(data.print); }\n\n    let printers = type == \"user\" ? template[\"user_print\"] : template[\"auto_print\"];\n\n    // console.log(printers);\n\n    data[\"user\"] = _this.state.user.id;\n    data[\"printers\"] = printers;\n    data[\"type\"] = \"receipt\";\n\n    // process styling\n    data.print = processStyling(data.print, cols);\n\n    // console.log(data.print); return;\n\n    // send data\n    fetch('https://api-print.kenzap.cloud:5001/', {\n        method: 'post',\n        headers: headers,\n        body: JSON.stringify({\n            query: {\n                print: {\n                    type:       'print',\n                    data:       data,\n                    sid:        spaceID(),\n                }\n            }\n        })\n    })\n    .then(response => response.json())\n    .then(response => {\n\n        if (response.success){\n\n            toast( __('Printing order #'+o.id) );\n\n        }else{\n\n            parseApiError(response);\n        }\n    })\n    .catch(error => {\n\n        parseApiError(error);\n    });\n\n    _this.state.printRequest = null;\n\n    return true;\n}\n\nexport const processStyling = (print, cols) => {\n\n    // preprocess lines\n    let rows = print.split('\\n');\n    let output = \"\";\n    for(let row of rows){\n\n        let max_char = cols;\n\n        let s = row.indexOf('[S]');\n        let r = row.indexOf('[R]');\n        let l = row.indexOf('[L]');\n        let c = row.indexOf('[C]');\n        \n        // chinese, japanese.. chars are twice the size of latin chars, deduct it\n        max_char -= countDoubledChars(row) ? countDoubledChars(row) : 1;\n\n        // [S] stretch to fit row width\n        if(s!=-1){\n\n            row = row.substr(0, s) + row.substr(s+3, row.length);\n        }\n\n        // [R] right aign text\n        if(r!=-1){ \n\n            let spaceN = max_char - (row.substr(0, r) + row.substr(r+3, row.length)).length;\n\n            // other tags offset\n            if(l!=-1) spaceN += 3; if(c!=-1) spaceN += 3;\n\n            row = row.substr(0, r) + addSpaces(spaceN) + row.substr(r+3, row.length)\n        }\n\n        // [L] left align text\n        if(l!=-1){\n\n            let spaceN = max_char - (row.substr(0, l) + row.substr(l+3, row.length)).length;\n            row = row.substr(0, l) + row.substr(l+3, row.length) + addSpaces(spaceN); \n        }\n\n        // [C] center align text\n        if(c!=-1){ \n            \n            let spaceN = max_char - (row.substr(0, r) + row.substr(r+3, row.length)).length;\n\n            row = addSpaces(Math.floor(spaceN/2)) + row.substr(0, c) + row.substr(c+3, row.length) + addSpaces(Math.ceil(spaceN/2));\n        }\n\n        // clean empty row\n        let empty = 0; [...row].forEach(char => { if (char==\" \") empty +=1 ; }); if(empty>=max_char) row = \"\"; // console.log(empty + \" \" + max_char);\n\n        output += row+\"\\n\";\n    }\n\n    return output;\n}\n\nexport const addSpaces = (l) => {\n\n    let s = \"\";\n    for(let i=0;i<=l;i++){s+=\" \";}\n    return s;\n}\n\nexport const printReceiptLegacy = (_this, _id, type, template) => {\n\n    let o = _this.state.orders.filter(order => { return order._id == _id; })[0], data = {}, date = new Date();\n\n    // debug vs actual print\n    data.debug = false;\n\n    // find receipt template if none is provided\n    if(!template){\n\n        // any user designated templates?\n        let templates = _this.state.settings['templates'].filter(template => { return template.type == \"receipt\" && (template.user == _this.state.user.id); });\n        \n        // get default templagte\n        if(templates.length == 0) templates = _this.state.settings['templates'].filter(template => { return template.type == \"receipt\" && (template.user == \"\"); });\n\n        // assign template\n        data.print = templates.length > 0 ? templates[0].template : \"Kenzap Cloud: no receipt template found\";\n\n        // default\n        template = templates.length > 0 ? templates[0] : {};\n    }else{\n\n        data.print = template.template;\n    }\n\n    // order id\n    data.print = data.print.replace(/{{order_id}}/g, o.id);\n\n    // table no\n    data.print = data.print.replace(/{{order_table}}/g, o.table ? o.table : \"\");\n\n    // current time\n    data.print = data.print.replace(/{{date_time}}/g, date.toLocaleString([], { dateStyle: 'medium', timeStyle: 'short', }));\n\n    // order items\n    data.print = data.print.replace(/{{order_items}}/g, getPrintItems(_this, o, ''));\n\n    // order items restricted by category\n    const matches = data.print.matchAll(/{{order_items:(.*?):start}}/g);\n    Array.from(matches, x => x[1]).forEach(cat => {\n\n        // const items_match = data.print.matchAll(/{{order_items:Frog:start}}([\\s\\S]*?){{order_items:Frog:end}}/g);\n\n        let items_restricted = getPrintItems(_this, o, cat);\n\n        // order items cat\n        let replace = \"{{order_items:\"+cat+\"}}\";\n        let re = new RegExp(replace,\"g\");\n        data.print = data.print.replace(re, items_restricted);\n\n        // remove entire block if no items for requested category are present \n        if(items_restricted.length<2){\n\n            console.log(\"removing entire block\");\n\n            let start = data.print.indexOf(\"{{order_items:\"+cat+\":start}}\");\n            let end = data.print.indexOf(\"{{order_items:\"+cat+\":end}}\") + (\"{{order_items:\"+cat+\":end}}\").length;\n\n            data.print = data.print.slice(0, start) + data.print.slice(end);\n\n            // replace = \"\\n{{order_items:\"+cat+\":start}}([\\s\\S]){{order_items:\"+cat+\":end}}\";\n            // re = new RegExp(replace,\"g\");\n            // data.print = data.print.replace(re, \"\");\n\n        // get rid of start/end row indicators\n        }else{\n\n            replace = \"\\n{{order_items:\"+cat+\":start}}\";\n            re = new RegExp(replace,\"g\");\n            data.print = data.print.replace(re, '');\n\n            replace = \"\\n{{order_items:\"+cat+\":end}}\";\n            re = new RegExp(replace,\"g\");\n            data.print = data.print.replace(re, '');\n        }\n    });\n\n    // order note\n    let note = !o.note || o.note == '<br>' ? '' : o.note;\n    if(note.length>0){\n        //  data.print += '[C]================================';\n        data.print = data.print.replace(/{{order_note}}/g, '[C]================================\\n' + note + '\\n[C]================================\\n');\n    }\n\n    // order totals\n    data.print = data.print.replace(/{{total}}/g, priceFormat(_this, o.price.total));\n    data.print = data.print.replace(/{{tax_total}}/g, priceFormat(_this, o.price.tax_total));\n    data.print = data.print.replace(/{{discount_total}}/g, priceFormat(_this, o.price.discount_total));\n    data.print = data.print.replace(/{{grand_total}}/g, priceFormat(_this, o.price.grand_total));\n\n    let order_totals  = '';\n    order_totals += '[L]'+__('Subtotal')+'[R]' + priceFormat(_this, o.price.total) + '\\n';\n    if(o.price.discount_total > 0) order_totals += '[L]'+__('Discount')+'[R]-' + priceFormat(_this, o.price.discount_total) + '\\n';\n    if(o.price.fee_total > 0) order_totals += '[L]'+_this.state.settings.fee_display+'[R]' + priceFormat(_this, o.price.fee_total) + '\\n';\n    if(o.price.tax_total > 0) order_totals += '[L]'+_this.state.settings.tax_display+'[R]' + priceFormat(_this, o.price.tax_total) + '\\n';\n    if(o.price.grand_total > 0) order_totals += '[L]'+__('Grand Total')+'[R]' + priceFormat(_this, o.price.grand_total);\n\n    data.print = data.print.replace(/{{order_totals}}/g, order_totals);\n\n    // qr link\n    data.print = data.print.replace(/{{qr_link}}/g, 'http://'+_this.state.qr_settings.slug + '.kenzap.site');\n    data.print = data.print.replace(/{{qr_number}}/g, document.querySelector('#qr-number').value);\n\n    // let str = 'kenzapprint://kenzapprint.app?data='+encodeURIComponent(JSON.stringify(data));\n    \n    console.log(data.print);\n\n    if(data.debug){ console.log(data.print); console.log(str); }\n\n    let printers = type == \"user\" ? template[\"user_print\"] : template[\"auto_print\"];\n\n    data[\"user\"] = _this.state.user.id;\n    data[\"printers\"] = printers;\n    data[\"type\"] = \"receipt\";\n\n    // send data\n    fetch('https://api-print.kenzap.cloud:5001/', {\n        method: 'post',\n        headers: headers,\n        body: JSON.stringify({\n            query: {\n                print: {\n                    type:       'print',\n                    data:       data,\n                    sid:        spaceID(),\n                }\n            }\n        })\n    })\n    .then(response => response.json())\n    .then(response => {\n\n        if (response.success){\n\n            toast( __('Printing order #'+o.id) );\n\n        }else{\n\n            parseApiError(response);\n        }\n    })\n    .catch(error => {\n\n        parseApiError(error);\n    });\n\n    _this.state.printRequest = null;\n\n    return true;\n}\n\n/*\n* 58mm wide thermal printers are best to display 20-32 chars per line\n*\n* @param    txt         text with long product item titles to process\n* @param    end_ofst    previous iteation offset     \n* @param    cols        max chars per line \n* @return \t{String} \ttxt\n* \n*/\nexport const row_latin = (txt, end_ofst) => {\n\n    let output = '', max_char = 32 - end_ofst, max_ofst = 4, ofst_prev = 0, ofst = 0, ci = 0;\n    // console.log(max_char);\n    for(let i = 0; i < Math.ceil(txt.length / max_char); i++){\n\n        // add new line print from second loop only\n        if(i>0) output += '\\n[L]';\n\n        // ofst store first available whitespace break in words\n        ofst = ci = 0;\n        for(let e = max_ofst; e > -1 * max_ofst; e--){\n\n            ci = ((max_char + ofst_prev) * i) + max_char + e; if(txt[ci] == ' ' || ci == txt.length){ ofst += e; break; }\n        }\n\n        // add line row\n        output += txt.substr((max_char + ofst_prev) * i, max_char + ofst);\n\n        // line ends earlier than expected, skip loop\n        if(ci == txt.length) break;\n\n        ofst_prev = ofst;\n    }\n\n    return output;\n};\n\nexport const row = (txt, start_ofst, end_ofst, cols) => {\n\n    cols-=1;\n\n    let output = '', max_ofst = 6, ofst_prev = 0, ofst = 0, ci = 0;\n\n    let first_row = true;\n\n    for(let i = 0; i < txt.length; i++){\n        \n        output += txt[i];\n\n        ofst += (1 + countDoubledChars(txt[i]));\n\n        // first loop\n        if(first_row && ofst >= cols - (start_ofst + end_ofst)){ output += '\\n[L]'; ofst = 0; first_row = false;}\n\n        // other loops\n        if(ofst >= cols - end_ofst){ output += '\\n[L]'; ofst = 0; }\n    }\n\n    return output;\n}\n\nexport const countDoubledChars = (text) => {\n\n    // This matches all CJK ideographs.\n    var cjkRegEx = /[\\u3400-\\u4db5\\u4e00-\\u9fa5\\uf900-\\ufa2d]/;\n  \n    var wordCount = 0;\n    var inWord = false;\n    var length = text.length;\n    for (var i = 0; i < length; i++) {\n\n      var curChar = text.charAt(i);\n      if (cjkRegEx.test(curChar)) {\n\n        // Character is a CJK ideograph.\n        // Count it as a word.\n        wordCount += inWord ? 2 : 1;\n        inWord = false;\n      }\n    }\n\n    return wordCount;\n}\n\nexport const getPrintItems = (_this, o, cat, cols) => {\n\n    let items = '';\n\n    // console.log(o.items);\n  \n    for(let i in o.items){\n\n        if(o.items[i].cats == undefined) o.items[i].cats = [];\n\n        if(!o.items[i].cats.includes(cat) && cat.length > 0) continue;\n\n        let total = priceFormat(_this, o.items[i].total);\n        // let end_ofst = ((o.items[i].qty+\"\") + \" X \" + (total+\"\")).length;\n        // items += `[L]<b>${ o.items[i].qty } X ${ row(__(o.items[i].title), end_ofst) }</b>[R]${ total }\\n`;\n        items += `[L]${ o.items[i].qty } X ${ row( __(o.items[i].title), (o.items[i].qty+\"\").length + 3, (total+\"\").length, cols) }[R]${ total }\\n`;\n        for(let v in o.items[i].variations){\n\n            items += `[L] ${ row( __(o.items[i].variations[v].title), 1, 0, cols) }:`;\n            for(let l in  o.items[i].variations[v].list) items += ` ${ __(o.items[i].variations[v].list[l].title) },`;\n\n            if(items.endsWith(',')) items = items.substring(0, items.length - 1) + '\\n';\n            if(!items.endsWith('\\n')) items = items + '\\n';\n        }\n    }\n\n    if(items.endsWith('\\n')) items = items.substring(0, items.length - 1);\n \n    return items;\n}\n\nexport const printQRNative = (_this, order) => {\n\n    // vars\n    let o = order, data = {}, date = new Date();\n\n    // debug vs actual print\n    data.debug = false;\n\n    // get qr template\n    data.print = _this.state.settings.qr_template;\n\n    // qr link\n    data.print = data.print.replace(/{{qr_link}}/g, 'http://'+_this.state.qr_settings.slug + '.kenzap.site');\n    data.print = data.print.replace(/{{qr_number}}/g, document.querySelector('#qr-number').value);\n\n    if(data.debug) { console.log(data.print); console.log(str); }\n\n    let str = 'kenzapprint://kenzapprint.app?data='+encodeURIComponent(JSON.stringify(data));\n\n    return str;\n}\n\nexport const printQR = (_this, qrnum) => {\n\n    // vars\n    let data = {}, date = new Date();\n\n    // debug vs actual print\n    data.debug = false;\n\n    // find QR template\n    let templates = _this.state.settings['templates'].filter(template => { return template.type == \"qr\" && (template.user == \"\" || template.user == _this.state.user.id); });\n\n    // get qr template\n    data.print = templates.length > 0 ? templates[0].template : \"Kenzap Cloud: no qr template found\";\n\n    // qr link\n    data.print = data.print.replace(/{{qr_link}}/g, 'http://'+_this.state.qr_settings.slug + '.kenzap.site');\n\n    // qr number\n    qrnum = qrnum ? qrnum : document.querySelector('#qr-number').value;\n\n    // qr number replace\n    data.print = data.print.replace(/{{qr_number}}/g, qrnum);\n\n    // find max char per line parameter\n    let cols_p = data.print.indexOf('[W:'); let cols = 20;\n    if(cols_p!=-1){ cols = parseInt(data.print.substr(cols_p+3, 2)); data.print = data.print.substr(0, cols_p) + data.print.substr(cols_p+6, data.print.length); }\n    \n    // pricess styling\n    data.print = processStyling(data.print, cols);\n  \n    // if(data.debug) { console.log(data.print); }\n    console.log(data.print);\n\n    let printers = templates[0][\"user_print\"];\n\n    data[\"user\"] = _this.state.user.id;\n    data[\"printers\"] = printers;\n    data[\"type\"] = \"qr\";\n\n    // return;\n\n    // send data\n    fetch('https://api-print.kenzap.cloud:5001/', {\n        method: 'post',\n        headers: headers,\n        body: JSON.stringify({\n            query: {\n                print: {\n                    type:       'print',\n                    data:       data,\n                    sid:        spaceID(),\n                }\n            }\n        })\n    })\n    .then(response => response.json())\n    .then(response => {\n\n        if (response.success){\n\n            toast( __('Printing') );\n\n        }else{\n\n            parseApiError(response);\n        }\n    })\n    .catch(error => {\n\n        parseApiError(error);\n    });\n}\n\nexport const autoPrint = (_this) => {\n\n    // console.log(\"autoPrint\");\n\n    // find auto printing receipt\n    let templates = _this.state.settings['templates'].filter(template => { return template.auto_print_action == \"new\" && template.type == \"receipt\" && (template.user == \"\" || template.user == _this.state.user.id); });\n\n    if(templates.length == 0) return false;\n\n    autoPrintLoop(_this, templates[0]); setInterval((_this) => { autoPrintLoop(_this, templates[0]); }, 7000, _this);\n}\n\nexport const autoPrintLoop = (_this, template) => {\n\n    let last_print_id = localStorage.hasOwnProperty(\"last_print_id\") ? localStorage.getItem(\"last_print_id\") : 0;\n    let i = _this.state.orders.length;\n\n    while (i > 0){\n\n        i--;\n\n        if(_this.state.orders[i].status == \"new\" && parseInt(_this.state.orders[i].id) > last_print_id){\n\n            localStorage.setItem(\"last_print_id\", _this.state.orders[i].id);\n\n            printReceipt(_this, _this.state.orders[i]._id, \"auto\", template);\n\n            return false;\n        }\n    }\n}\n\nexport const isPrintQREnabled = (_this) => {\n\n    // find QR template\n    let templates = _this.state.settings['templates'].filter(template => { return template.type == \"qr\" && (template.user == \"\" || template.user == _this.state.user.id); });\n\n    return templates.length > 0 ? true : false;\n}","import { headers, showLoader, hideLoader, onClick, onKeyUp, simulateClick, parseApiError, spaceID, __html } from '@kenzap/k-cloud';\nimport { priceFormat, getPageNumber, makeNumber, parseVariations, timeConverterAgo, escape, onlyNumbers, unescape } from \"../_/_helpers.js\"\nimport { printQR } from \"../_/_print.js\"\n\nexport const tables = {\n\n    _this: null,\n    firstLoad: true,\n    state: { orderSingle: null },\n    render: (_this, e) => {\n\n        if(_this.state.settings.tables != \"1\") return;\n\n        let s = '', table_list = _this.state.settings.table_list.trim().split('\\n');\n       \n        let html = `<div id=\"table_list\" class=\"row row-cols-1 row-cols-lg-5 row-cols-md-3 row-cols-sm-2 g-3 mb-3\">`;\n\n        _this.state.orders.forEach(o => {\n\n            if(o.table) if(o.table.length>0) if(!table_list.includes(o.table)) table_list.push(o.table);\n        });\n\n        // console.log(table_list);\n\n        table_list.forEach((el, i) => {\n\n            html += tables.structTableCard(_this, i, el, { orders: _this.state.orders, meta: _this.state.meta }); \n\n        });\n\n        html += '</div>';\n\n        if(document.querySelector('#table_list')) document.querySelector('#table_list').remove();\n        \n        document.querySelector('#orders-after-header').insertAdjacentHTML(\"beforeend\", html);\n\n        // print custom QR code\n        if(tables.firstLoad){\n         \n            tables.firstLoad = false; onClick('.print-qr', (e) => {\n        \n                e.preventDefault();\n\n                printQR(_this, e.currentTarget.dataset.qrnum);\n            });\n        }\n    },\n    renderField: (_this, a, item, x) => {\n\n        let html = '';\n        switch(a.e){\n            \n            case 'price': \n\n                html = `<div data-id=\"${x}\" data-type=\"key-number\" class=\"${ a.classList ? a.classList : \"\" } ms-2 d-inline-block\" ${ a.editable ? 'contenteditable=\"true\"':'' } data-id=\"${x}\" data-value=\"${ item }\">${ priceFormat(_this, item) }</div>`;\n                return html;\n            case 'text': \n\n                html = `<div data-id=\"${x}\" data-type=\"text\" class=\"${ a.classList ? a.classList : \"\" } ms-2 d-inline-block\" ${ a.editable ? 'contenteditable=\"true\"':'' } data-id=\"${x}\">${ item }</div>`;\n                return html;\n            case 'textarea': return '<textarea type=\"text\" rows=\"4\" class=\"form-control order-form pv \" data-type=\"textarea\" id=\"'+x+'\" value=\"'+item+'\">'+item+'</textarea>';\n            case 'items': \n\n                // parse product items\n                html = `<table class=\"items order-form\" data-type=\"items\"><tr><th><div class=\"me-1 me-sm-3\">${ __('Product') }</div></th><th class=\"qty\"><div class=\"me-1 me-sm-3\">${ __('Qty') }</div></th><th class=\"tp\"><div class=\"me-1 me-sm-3\">${ __('Total') }</div></th><th></th></tr>`;\n                for(let x in item){ html += preview.structOrderItemTable(_this, x, item, false); }\n\n                // add row for manual product entry\n                html += `<tr class=\"new-item-row\">\n                            <td>\n                                <div class=\"me-1 me-sm-3 mt-2\">\n                                    <input type=\"text\" value=\"\" autocomplete=\"off\" placeholder=\"${ __('Search..') }\" class=\"form-control edit-item\" data-id=\"\" data-index=\"\" list=\"item-suggestions\">\n                                    <span class=\"select-list-group__toggle\"> </span>\n                                    <ul class=\"s-list my-1 shadow-sm\" data-toggle=\"false\"></ul>\n                                    <datalist id=\"item-suggestions\" class=\"fs-12 d-none\"></datalist>\n                                </div>\n                            </td>\n                            <td class=\"qty\">\n                                <div class=\"me-1 me-sm-3 mt-2\">\n                                    <input type=\"text\" value=\"\" autocomplete=\"off\" class=\"form-control text-right edit-qty\">\n                                </div>\n                            </td>\n                            <td class=\"tp\">\n                                <div class=\"me-1 me-sm-3 mt-2\">\n                                    <input type=\"text\" value=\"\" autocomplete=\"off\" class=\"form-control edit-tp\">\n                                </div>\n                            </td>\n                            <td class=\"align-middle text-center pt-2\"> \n                                <svg xmlns=\"http://www.w3.org/2000/svg\" fill=\"currentColor\" viewBox=\"0 0 16 16\" width=\"24\" height=\"24\" class=\"bi bi-plus-circle text-success align-middle add-item\"><path d=\"M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z\"></path><path d=\"M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4z\"></path></svg>\n                            </td>\n                        </tr>`;\n\n                html += `</table><div class=\"item-vars-input mt-3\"> </div>`;\n\n                return html;\n            default: \n            \n                if(x == '_id') item = item.substr(0, 6);\n\n                html = `<div data-id=\"${x}\" data-type=\"text\" class=\"${ a.classList ? a.classList : \"\" } ms-2 d-inline-block\" ${ a.editable ? 'contenteditable=\"true\"':'' } data-id=\"${x}\">${ item }</div>`;\n                return html;\n        }\n  },\n \n  structTableCard: (_this, i, el, response) => {\n\n    let ii = 0;\n    let order = {};\n    let id_last = 0;\n    \n    response.orders.forEach((o, index) => { if(o.table == el+'' && o.id > id_last){ ii = index; order = o; id_last = o.id; } });\n\n    order = order ? order : {};\n    order['id'] = order.id ? order.id : \"\";\n    order['_id'] = order._id ? order._id : \"\";\n    order['created'] = order.created ? order.created : \"\";\n\n    let classes = \"\";\n    let _id_header = order._id ? order._id : \"\", _id_body = _id_header;\n\n    switch(order['status']){\n\n        case 'new': classes = \"text-dark bg-warning\";  break;\n        case 'paid': classes = \"text-white bg-primary\"; break;\n        case 'processing': classes = \"text-white bg-primary\"; break;\n        case 'completed': classes = \"text-white bg-secondary\"; _id_body = \"\"; break;\n        case 'failed': classes = \"text-white bg-danger\"; _id_body = \"\"; break;\n        case 'refunded': classes = \"text-white bg-danger\"; _id_body = \"\"; break;\n        default: classes = \"text-white bg-secondary\"; _id_body = \"\"; break;\n    }\n\n    return `\n    <div class=\"col\">\n        <div class=\"card ${ classes } mb-2 \" style=\"max-width: 18rem;\">\n            <div class=\"card-header view-order po ${ _id_header && order['status'] == 'completed' ? \"bg-success\" : \"\" }\" data-id=\"${ _id_header }\" data-table=\"${ el }\" ${ _id_header ? 'data-index=\"' + ii + '\"' : '' }\">${ order.id ? __html(\"last order #%1$\", order.id) : \"&nbsp;\" }</div>\n            <div class=\"card-body d-flex align-items-center justify-content-center view-order po\" style=\"min-height:140px;\" data-id=\"${ _id_body }\" data-table=\"${ el }\" ${ _id_body ? 'data-index=\"' + ii + '\"' : '' }\">\n                <h5 class=\"card-title\">${ __(\"Table %1$\", el) }</h5>\n            </div>\n            <div class=\"card-footer d-flex justify-content-between\">\n                ${ order['created'] ? timeConverterAgo(__, response.meta.time, order['created']) : '&nbsp;' }\n                <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" fill=\"currentColor\" class=\"bi bi-qr-code-scan print-qr po ${ _this.state.settings.qr_print ? \"\" : \"d-none\" } \" viewBox=\"0 0 16 16\" data-qrnum=\"${ el }\">\n                    <path d=\"M0 .5A.5.5 0 0 1 .5 0h3a.5.5 0 0 1 0 1H1v2.5a.5.5 0 0 1-1 0v-3Zm12 0a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v3a.5.5 0 0 1-1 0V1h-2.5a.5.5 0 0 1-.5-.5ZM.5 12a.5.5 0 0 1 .5.5V15h2.5a.5.5 0 0 1 0 1h-3a.5.5 0 0 1-.5-.5v-3a.5.5 0 0 1 .5-.5Zm15 0a.5.5 0 0 1 .5.5v3a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1 0-1H15v-2.5a.5.5 0 0 1 .5-.5ZM4 4h1v1H4V4Z\"></path>\n                    <path d=\"M7 2H2v5h5V2ZM3 3h3v3H3V3Zm2 8H4v1h1v-1Z\"></path>\n                    <path d=\"M7 9H2v5h5V9Zm-4 1h3v3H3v-3Zm8-6h1v1h-1V4Z\"></path>\n                    <path d=\"M9 2h5v5H9V2Zm1 1v3h3V3h-3ZM8 8v2h1v1H8v1h2v-2h1v2h1v-1h2v-1h-3V8H8Zm2 2H9V9h1v1Zm4 2h-1v1h-2v1h3v-2Zm-4 2v-1H8v1h2Z\"></path>\n                    <path d=\"M12 9h2V8h-2v1Z\"></path>\n                </svg>\n            </div>\n        </div>\n    </div>`;\n  }\n}","import { headers, showLoader, hideLoader, onClick, onKeyUp, simulateClick, parseApiError, spaceID, __html, onChange } from '@kenzap/k-cloud';\nimport { priceFormat, getPageNumber, makeNumber, parseVariations, escape, onlyNumbers, getProductsById, unescape } from \"../_/_helpers.js\"\n\nexport const preview = {\n\n    _this: null,\n    state: { orderSingle: null },\n    renderOrder: (_this, e) => {\n\n        _this.state.changes = false;\n        _this.modal = document.querySelector(\".order-modal\");\n        _this.modalCont = new bootstrap.Modal(_this.modal);\n        _this.modalOpen = true;\n        _this.rowMark = -1;\n        let i = e.currentTarget.dataset.index;\n\n        // to properly handle back button on mobiles\n        history.pushState({ pageID: 'orders' }, 'Orders', window.location.pathname + window.location.search + \"#editing\");\n\n        _this.modal.addEventListener('hide.bs.modal', function (e) {\n\n            if (window.location.href.indexOf(\"#editing\") == -1) return;\n\n            history.pushState({ pageID: 'orders' }, 'Orders', window.location.pathname + window.location.search);\n        });\n\n        // is new order ?\n        if (typeof (i) === 'undefined') {\n\n            _this.state.orderSingle = {\n                _id: \"new\",\n                created: 1649831099,\n                from: \"dine-in\",\n                id: \"\",\n                idd: \"\",\n                items: [],\n                kid: \"0\",\n                name: \"dine-in\",\n                note: \"\",\n                sid: spaceID,\n                status: \"new\",\n                price: { 'discount_percent': 0 },\n                step: 1,\n                table: e.currentTarget.dataset.table ? e.currentTarget.dataset.table : \"-\",\n                total: 0,\n                updated: 1649833845\n            }\n\n            // auto add product\n            if(_this.state.orderSingle._id == 'new' && _this.state.settings.add_products == \"1\"){\n\n                let products = _this.state.settings.add_products_list.trim().split('\\n');\n\n                getProductsById(_this, products, preview.renderOrderUI);\n\n            }else{\n\n                preview.renderOrderUI(_this);\n            }\n\n        } else {\n\n            _this.state.orderSingle = _this.state.orders[i];\n\n            preview.renderOrderUI(_this);\n        }\n        \n        // console.log(_this.state.orderSingle.items);\n\n        // prevent modal closure if user clicks on white space areas\n        // if(modal) modal.addEventListener('click', (e)=>{ e.preventDefault(); return false; });\n\n        // print listener\n        onClick('.print-order', (e) => {\n\n            e.preventDefault();\n\n            _this.state.printRequest = e.currentTarget.dataset.id;\n\n            simulateClick(_this.modal.querySelector(\".btn-confirm\"));\n        });\n\n        // save changes to orders\n        _this.listeners.modalSuccessBtnFunc = (e) => {\n\n            e.preventDefault();\n\n            _this.updateOrder(i, _this.state.orderSingle._id);\n        }\n\n        onClick('.st-modal li a', (e) => {\n\n            e.preventDefault();\n\n            preview._this.state.changes = true;\n\n            let osm = document.querySelector('#order-status-modal');\n            osm.innerHTML = _this.state.statuses[e.currentTarget.dataset.key].text;\n            osm.dataset.value = e.currentTarget.dataset.key;\n            let list = [];\n\n            // clear previous classes\n            Object.keys(_this.state.statuses).forEach((key) => {\n                list = _this.state.statuses[key].class.split(' ');\n                list.forEach((key) => {\n                    osm.classList.remove(key);\n                });\n            });\n\n            // add new classes\n            list = _this.state.statuses[e.currentTarget.dataset.key].class.split(' ');\n            list.forEach((key) => {\n\n                osm.classList.add(key);\n            });\n        });\n    },\n    renderOrderUI: (_this) => {\n\n        preview.state.orderSingle = _this.state.orderSingle;\n\n        // console.log(preview.state.orderSingle);\n        let items = '';\n\n        // get order status\n        Object.keys(_this.state.statuses).forEach((key, index) => { items += `<li><a class=\"dppi dropdown-item\" data-key=\"${key}\" href=\"#\">${_this.state.statuses[key].text}</a></li>` })\n        let statusSelect = `\n        <div class=\"d-flex justify-content-between\">\n            <div class=\"st-modal st-opts mb-3 me-1 me-sm-3 dropdown\">\n                <a class=\"btn btn-sm ${_this.state.statuses[_this.state.orderSingle['status']].class} dropdown-toggle order-form\" data-id=\"status\" data-type=\"key\" data-value=\"${_this.state.orderSingle['status']}\" href=\"#\" role=\"button\" id=\"order-status-modal\" data-bs-toggle=\"dropdown\" aria-expanded=\"false\" >\n                    ${_this.state.statuses[_this.state.orderSingle['status']].text}\n                </a>\n                <ul class=\"dropdown-menu\" aria-labelledby=\"order-status-modal\">\n                    ${items}\n                </ul>\n            </div>\n            <a href=\"#\" data-index=\"0\" class=\"print-order text-success\" data-id=${preview.state.orderSingle._id}>\n                <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"30\" height=\"30\" fill=\"currentColor\" class=\"bi bi-printer\" viewBox=\"0 0 16 16\">\n                    <path d=\"M2.5 8a.5.5 0 1 0 0-1 .5.5 0 0 0 0 1z\"></path>\n                    <path d=\"M5 1a2 2 0 0 0-2 2v2H2a2 2 0 0 0-2 2v3a2 2 0 0 0 2 2h1v1a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2v-1h1a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2h-1V3a2 2 0 0 0-2-2H5zM4 3a1 1 0 0 1 1-1h6a1 1 0 0 1 1 1v2H4V3zm1 5a2 2 0 0 0-2 2v1H2a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1v3a1 1 0 0 1-1 1h-1v-1a2 2 0 0 0-2-2H5zm7 2v3a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1v-3a1 1 0 0 1 1-1h6a1 1 0 0 1 1 1z\"></path>\n                </svg>\n            </a>\n        </div>\n        `;\n        // kenzapprint://kenzapprint.app?data=%7B%22print%22%3A%22%5BC%5D%3Cu%3E%3Cfont%20size%3D%5C%22big%5C%22%3EORDER%7B%7Border_id_short%7D%7D%3C%2Ffont%3E%3C%2Fu%3E%5Cn%5BC%5DFu%20Zhen%20Seafood%5Cn%5BC%5D%3Cu%20type%3Ddouble%3E%7B%7Bdate_time%7D%7D%3C%2Fu%3E%5Cn%5BC%5D%5Cn%5BC%5D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%5C%22%20%5Cn%5BL%5D%5Cn%5BL%5D%3Cb%3EBEAUTIFUL%20SHIRT%3C%2Fb%3E%5BR%5D9.99%E2%82%AC%5Cn%5BL%5D%20%20%2B%20Size%20%3A%20S%5Cn%5BL%5D%5Cn%5BL%5D%3Cb%3EAWESOME%20HAT%3C%2Fb%3E%5BR%5D24.99%E2%82%AC%5Cn%5BL%5D%20%20%2B%20Size%20%3A%2057%2F58%5Cn%5BL%5D%5Cn%5BC%5D--------------------------------%5Cn%5BR%5DTOTAL%20PRICE%20%3A%5BR%5D34.98%E2%82%AC%5Cn%5BR%5DTAX%20%3A%5BR%5D4.23%E2%82%AC%22%7D\" data-id=\"72b42ad9111e7767aa68174227ba20b5e11d26e4\n\n        // structure modal\n        _this.modal.querySelector(\".modal-dialog\").classList.add('modal-fullscreen');\n        _this.modal.querySelector(\".modal-header .modal-title\").innerHTML = isNaN(_this.state.orderSingle['from']) ? _this.state.orderSingle['from'] : '#' + _this.state.orderSingle['from'];\n        _this.modal.querySelector(\".modal-footer .btn-confirm\").innerHTML = _this.state.orderSingle._id == \"new\" ? __('Create') : __('Update');\n        _this.modal.querySelector(\".btn-confirm\").dataset.loading = false;\n        _this.modal.querySelector(\".modal-footer .btn-secondary\").innerHTML = __('Close');\n\n        let html = statusSelect;\n\n        let fields = { id: { l: __(\"ID\"), classList: \"order-form\" }, from: { l: __(\"From\"), e: \"text\", editable: true, classList: \"order-form\" }, table: { l: __(\"Table\"), e: \"text\", editable: true, classList: \"order-form\" }, items: { l: \"\", e: \"items\" }, fname: { l: __(\"Name\"), e: \"text\" }, lname: { l: __(\"Surname\"), e: \"text\" }, bios: { l: __(\"Bios\"), e: \"textarea\" }, avatar: { l: __(\"Avatar\"), e: \"text\" }, email: { l: __(\"Email\"), e: \"text\" }, countryr: { l: __(\"Country\"), e: \"text\" }, cityr: { l: __(\"City\"), e: \"text\" }, addr1: { l: __(\"Address 1\"), e: \"textarea\" }, addr2: { l: __(\"Address 2\"), e: \"textarea\" }, post: { l: __(\"Post\"), e: \"text\" }, state: { l: __(\"State\"), e: \"text\" }, c1: { l: __(\"Whatsapp\"), e: \"text\" }, c2: { l: __(\"Messenger\"), e: \"text\" }, c3: { l: __(\"Line\"), e: \"text\" }, c4: { l: __(\"Email\"), e: \"text\" }, c5: { l: __(\"Telegram\"), e: \"text\" }, email: { l: __(\"Email\"), e: \"text\" }, bio: { l: __(\"Bio\"), e: \"text\" }, y1: { l: __(\"Name\"), e: \"text\" }, y2: { l: __(\"IBAN\"), e: \"text\" }, y3: { l: __(\"SWIFT\"), e: \"text\" }, y4: { l: __(\"Bank\"), e: \"text\" }, y5: { l: __(\"Bank city\"), e: \"text\" }, y6: { l: __(\"Bank country\"), e: \"text\" }, note: { l: __(\"Note\"), e: \"textarea\" }, s3: { l: __(\"Link 3\"), e: \"text\" }, company: { l: __(\"Company\"), e: \"text\" }, vat: { l: __(\"Tax ID\"), e: \"text\" }, grade: { l: __(\"Grade\"), e: \"text\" }, kenzap_ida: { l: __(\"Kenzap IDA\"), e: \"text\" } };\n\n        // order table details\n        for (let x in fields) {\n\n            if (_this.state.orderSingle[x] === undefined) continue;\n\n            let val = _this.state.orderSingle[x];\n            let field = fields[x].l;\n\n            html += `\n            <div class=\"mb-3 mt-3 order-row keyx-${x} ${x == '_id' || x == 'from' ? \"elipsized\" : \"\"}\"  >\n                <b>${field}</b>${preview.renderField(_this, fields[x], val, x)}\n            </div>`;\n        }\n\n        // totals\n        setTimeout(() => { preview.refreshTotals(); }, 100);\n\n        html += '';\n        _this.modal.querySelector(\".modal-body\").innerHTML = '<div class=\"modal-body-cont\">' + html + '</div>';\n        \n        _this.modalCont.show();\n\n        // table order item listners (remove, add note, adjust variations, etc)\n        preview.tableOrderItemListeners();\n\n        // order item product edit listener\n        preview.suggestOrderItem(_this);\n\n        // hide suggestion list if still present\n        _this.modal.querySelector(\".edit-item\").addEventListener('blur', (e) => { setTimeout(() => { document.querySelector('.s-list').dataset.toggle = false; }, 500); });\n\n        // add product item to order table\n        preview.addOrderItem(_this);\n\n        // calculate totals for new orders only\n        if (_this.state.orderSingle._id == 'new') preview.refreshTotals();\n\n        // focus on item input fields\n        if (_this.state.orderSingle._id == 'new') setTimeout(() => { document.querySelector('.edit-item').focus(); }, 300);\n    },\n    newOrder: (_this) => {\n\n        preview._this = _this;\n        onClick('.add-order', (e) => { preview.renderOrder(_this, e); });\n    },\n    viewOrder: (_this) => {\n\n        preview._this = _this;\n        onClick('.view-order', (e) => { preview.renderOrder(_this, e); });\n    },\n    renderField: (_this, a, item, x) => {\n\n        let html = '';\n        switch (a.e) {\n\n            // case 'text': return '<input type=\"text\" class=\"form-control pv\" id=\"'+x+'\" value=\"'+b+'\">';\n\n            case 'price':\n\n                html = `<div data-id=\"${x}\" data-type=\"key-number\" class=\"${a.classList ? a.classList : \"\"} ms-2 d-inline-block\" ${a.editable ? 'contenteditable=\"true\"' : ''} data-id=\"${x}\" data-value=\"${item}\">${priceFormat(_this, item)}</div>`;\n                return html;\n            case 'text':\n\n                html = `<div data-id=\"${x}\" data-type=\"text\" class=\"${a.classList ? a.classList : \"\"} ms-2 d-inline-block p-1\" ${a.editable ? 'contenteditable=\"true\"' : ''} data-id=\"${x}\" style=\"min-width:50px;\">${item}</div>`;\n                return html;\n            case 'textarea': return '<textarea type=\"text\" rows=\"4\" class=\"form-control order-form pv \" data-type=\"textarea\" id=\"' + x + '\" value=\"' + item + '\">' + item + '</textarea>';\n            case 'items':\n\n                // parse product items\n                html = `<table class=\"items order-form\" data-type=\"items\"><tr><th><div class=\"me-1 me-sm-3\">${__('Product')}</div></th><th class=\"qty\"><div class=\"me-1 me-sm-3\">${__('Qty')}</div></th><th class=\"tp\"><div class=\"me-1 me-sm-3\">${__('Total')}</div></th><th></th></tr>`;\n                for (let x in item) { html += preview.structOrderItemTable(_this, x, item, false); }\n\n                // add row for manual product entry\n                html += `<tr class=\"new-item-row\">\n                            <td>\n                                <div class=\"me-1 me-sm-3 mt-2\">\n                                    <input type=\"text\" value=\"\" autocomplete=\"off\" placeholder=\"${__('Search..')}\" class=\"form-control edit-item\" data-id=\"\" data-cats=\"\" data-index=\"\" list=\"item-suggestions\">\n                                    <span class=\"select-list-group__toggle\"> </span>\n                                    <ul class=\"s-list my-1 shadow-sm\" data-toggle=\"false\"></ul>\n                                    <datalist id=\"item-suggestions\" class=\"fs-12 d-none\"></datalist>\n                                </div>\n                            </td>\n                            <td class=\"qty\">\n                                <div class=\"me-1 me-sm-3 mt-2\">\n                                    <input type=\"text\" value=\"\" autocomplete=\"off\" class=\"form-control text-right edit-qty\">\n                                </div>\n                            </td>\n                            <td class=\"tp\">\n                                <div class=\"me-1 me-sm-3 mt-2 d-flex\">\n                                    <select class=\"form-select form-select edit-discount me-2 d-none\" data-type=\"select\" aria-label=\"Default payment method\">\n                                        <option value=\"\" selected=\"\">%</option>\n                                        <option value=\"eNets\">eNets</option>\n                                        <option value=\"PayNow\">PayNow</option>\n                                    </select>\n                                    <input type=\"text\" value=\"\" autocomplete=\"off\" class=\"form-control edit-tp\">\n                                </div>\n                            </td>\n                            <td class=\"align-middle text-center pt-2\"> \n                                <svg xmlns=\"http://www.w3.org/2000/svg\" fill=\"currentColor\" viewBox=\"0 0 16 16\" width=\"24\" height=\"24\" class=\"bi bi-plus-circle text-success align-middle add-item\"><path d=\"M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z\"></path><path d=\"M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4z\"></path></svg>\n                            </td>\n                        </tr>`;\n\n                html += `</table><div class=\"item-vars-input mt-3\"> </div>`;\n\n                return html;\n            default:\n\n                if (x == '_id') item = item.substr(0, 6);\n\n                html = `<div data-id=\"${x}\" data-type=\"text\" class=\"${a.classList ? a.classList : \"\"} ms-2 d-inline-block\" ${a.editable ? 'contenteditable=\"true\"' : ''} data-id=\"${x}\">${item}</div>`;\n                return html;\n        }\n    },\n    itemOptions: (item) => {\n\n        let options = `\n\n        <div class=\"dropdown text-center\">\n            <a  href=\"#\" role=\"button\" id=\"order-item-options\" data-id=\"status\" data-value=\"\" data-bs-toggle=\"dropdown\" aria-expanded=\"false\">\n                <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" fill=\"currentColor\" class=\"bi bi-three-dots-vertical order-item-options\" viewBox=\"0 0 16 16\"><path d=\"M9.5 13a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0zm0-5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0zm0-5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0z\"/></svg>\n            </a>\n            <ul class=\"dropdown-menu\" aria-labelledby=\"order-item-options\" >\n                <li><a class=\"oio dropdown-item edit-item-note\" data-key=\"edit-item-note\" href=\"#\">${__('Add note')}</a></li>\n                <li><a class=\"oio dropdown-item d-none\" data-key=\"edit-item-variation\" href=\"#\">${__('Add variation')}</a></li>\n                <li><a class=\"oio dropdown-ite d-none\" data-key=\"edit-item-price\" href=\"#\">${__('Adjust price')}</a></li>\n                <li><a class=\"oio dropdown-item text-danger remove-item\" data-key=\"remove-item\" href=\"#\">${__('Remove')}</a></li>\n            </ul>\n        </div>\n    `;\n\n        return options;\n    },\n    structOrderItemTable: (_this, x, item, isNew = false, options = true) => {\n\n        // console.log(item[x].variations);\n\n        if (_this.created != item[x].created) { _this.rowMark += 1; }\n\n        _this.created = item[x].created;\n        item[x].cats = item[x].cats ? item[x].cats : [];\n\n        // parse variations\n        let vars = '', output = ''\n        for (let v in item[x].variations) {\n\n            // parse variation list\n            let list = ''; for (let l in item[x].variations[v].list) list += __html(item[x].variations[v].list[l].title) + \" \";\n            vars += '<div><b class=\"me-1\">' + __html(item[x].variations[v].title) + \"</b> <span>\" + list + \"</span></div> \";\n\n            // meal note\n            if (item[x].variations[v].note !== undefined && item[x].variations[v].note.length > 0) vars += \"<div><b>\" + __('Note') + \"</b> \" + item[x].variations[v].note + \"</div> \";\n        }\n\n        let item_discount = \"\";\n        if(item[x].discount_percent) item_discount = \" (-\" + item[x].discount_percent + \"%)\";\n        if(item[x].discount_value) item_discount = \" (-\" + priceFormat(_this, item[x].discount_value) + \")\";\n\n        // individual discount\n        if(!item[x].discounts) item[x].discounts = [];\n        item[x].discounts.forEach(obj => {\n\n           if(obj.type == \"never\") item[x].discount_type = \"never\";\n        });\n \n        output += '<tr class=\"order-item-row-active row-mark' + _this.rowMark + '\" data-created=\"' + item[x].created + '\" data-x=\"' + x + '\" data-id=\"' + item[x].id + '\" data-vars=\"' + escape(JSON.stringify(item[x].variations)) + '\" data-cats=\"' + escape(JSON.stringify(item[x].cats)) + '\" data-discounts=\"' + escape(JSON.stringify(item[x].discounts)) + '\">';\n        output += '<td><div class=\"item-title\" contenteditable=\"false\" data-value=\"' + item[x].title + '\" data-sdesc=\"' + (item[x].sdesc ? item[x].sdesc : \"\") + '\">' + __html(item[x].title) + '</div><div class=\"item-note text-muted mb-1 ' + ((item[x].note.length == 0 || item[x].note == '<br>') && !isNew ? \"d-none\" : \"\") + '\" contenteditable=\"true\" data-value=\"' + item[x].note + '\">' + item[x].note + '</div><div class=\"vars border-primary item-variations my-1 ps-2 text-secondary\" data-value=\"\">' + vars + '</div></td><td class=\"qty\"><div class=\"me-1 me-sm-3 item-qty\" data-value=\"' + item[x].qty + '\">' + item[x].qty + '</div></td><td class=\"tp\"><div class=\"me-1 me-sm-3 item-total\" data-price=\"' + item[x].price + '\" data-value=\"' + item[x].total + '\" data-discount_type=\"' + (item[x].discount_type ? item[x].discount_type : \"\") + '\" data-discount_percent=\"' + (item[x].discount_percent ? item[x].discount_percent : \"\") + '\" data-discount_value=\"' + (item[x].discount_value ? item[x].discount_value : \"\") + '\">' + priceFormat(_this, item[x].total) + item_discount + '</div><td class=\"' + (options ? '' : 'd-none') + '\">' + preview.itemOptions(item[x]) + '</td></td>';\n        output += '</tr>';\n\n        return output;\n    },\n    suggestOrderItem: (_this) => {\n\n        onKeyUp('.edit-item', (e) => {\n\n            // disable some key for better UX\n            var key = e.keyCode || e.charCode;\n            if (key >= 34 && key <= 45) { return; }\n\n            let s = e.currentTarget.value;\n\n            if (s.length == 1) document.querySelector('.modal-body').scrollTo({\n                top: (document.querySelector('.edit-item').getBoundingClientRect().top - document.querySelector('.modal-body-cont').getBoundingClientRect().top) - 20,\n                behavior: \"smooth\"\n            });\n\n            // empty search string\n            if (s.length == 0 || e.currentTarget !== document.activeElement) { document.querySelector('.s-list').dataset.toggle = false; return; }\n\n            // do API query\n            fetch('https://api-v1.kenzap.cloud/', {\n                method: 'post',\n                headers: headers,\n                body: JSON.stringify({\n                    query: {\n                        products: {\n                            type: 'find',\n                            key: 'ecommerce-product',\n                            fields: ['_id', 'id', 'img', 'status', 'cats', 'variations', 'price', 'discounts', 'title'],\n                            limit: _this.state.slist,\n                            // only suggesting products with status public\n                            term: [\n                                {\n                                    type: \"string\",\n                                    field: \"status\",\n                                    relation: \"=\",\n                                    value: \"1\",\n                                }\n                            ],\n                            offset: s.length > 0 ? 0 : getPageNumber() * _this.state.slist - _this.state.slist,       // automatically calculate the offset of table pagination\n                            search: {                                                                                 // if s is empty search query is ignored\n                                field: 'title',\n                                s: s\n                            },\n                            sortby: {\n                                field: 'title',\n                                order: 'DESC'\n                            },\n                        }\n                    }\n                })\n            })\n                .then(response => response.json())\n                .then(response => {\n\n                    // hide UI loader\n                    hideLoader();\n\n                    // console.log(response);\n\n                    if (response.success) {\n\n                        _this.state.productsSuggestions = response.products;\n\n                        let options = ``;\n                        response.products.forEach((product, index) => {\n\n                            // options += `<option class=\"pso\" data-id=\"${ product._id }\" data-title=\"${ product.title }\" data-index=\"${ index }\" value=\"${ product.title }\">${ product.title }</option>`; \n                            options += `<li class=\"s-list-item py-1\" data-id=\"${product._id}\" data-title=\"${product.title}\" data-index=\"${index}\"  data-display=\"true\" data-highlight=\"false\">${product.title}</li>`;\n                        });\n                        document.querySelector('.s-list').innerHTML = options;\n                        document.querySelector('.s-list').dataset.toggle = true;\n\n                        // suggestion click listener \n                        onClick('.s-list-item', (e) => {\n\n                            let index = e.currentTarget.dataset.index;\n\n                            console.log(_this.state.productsSuggestions[index]);\n                            // console.log(_this.state.productsSuggestions[index]);\n\n                            document.querySelector('.edit-item').dataset.index = index;\n                            document.querySelector('.edit-item').dataset.id = _this.state.productsSuggestions[index]._id;\n                            document.querySelector('.edit-item').dataset.cats = JSON.stringify(_this.state.productsSuggestions[index].cats);\n                            document.querySelector('.edit-item').value = _this.state.productsSuggestions[index].title;\n                            document.querySelector('.edit-item').dataset.discounts = JSON.stringify(_this.state.productsSuggestions[index].discounts);\n                            document.querySelector('.edit-qty').value = 1;\n                            document.querySelector('.edit-qty').dataset.price = _this.state.productsSuggestions[index].price;\n                            document.querySelector('.edit-tp').value = _this.state.productsSuggestions[index].price;\n                            document.querySelector('.edit-tp').dataset.price = _this.state.productsSuggestions[index].price;\n                            document.querySelector('.s-list').dataset.toggle = false;\n                            document.querySelector('.edit-discount').classList.add('d-none');\n\n                            if (_this.state.productsSuggestions[index].discounts) if (_this.state.productsSuggestions[index].discounts.length > 0) {\n\n                                let discount_options = '<option value=\"\">%</option>';\n                                _this.state.productsSuggestions[index].discounts.forEach(discount => {\n                                    if (discount.availability == \"admin\" && discount.type == \"percent\") {\n\n                                        discount_options += '<option data-type=\"percent\" value=\"' + discount.percent + '\">-' + discount.percent + '%</option>';\n                                        document.querySelector('.edit-discount').classList.remove('d-none');\n                                    }\n                                    if (discount.availability == \"admin\" && discount.type == \"value\") {\n\n                                        discount_options += '<option data-type=\"value\" value=\"' + discount.value + '\">-' + priceFormat(preview._this, discount.value) + '</option>';\n                                        document.querySelector('.edit-discount').classList.remove('d-none');\n                                    }\n                                    if (discount.type == \"never\") {\n\n                                        \n                                    }\n                                });\n\n                                document.querySelector('.edit-discount').innerHTML = discount_options;\n\n                                onChange('.edit-discount', e => {\n\n                                    setTimeout(() => { calcItemTotal(); }, 300);\n                                });\n                            }\n\n                            let calcItemTotal = () => {\n\n                                let discount_type = document.querySelector('.edit-discount').options[document.querySelector('.edit-discount').selectedIndex].dataset.type;\n                                let total = parseFloat(document.querySelector('.edit-qty').value) * parseFloat(document.querySelector('.edit-qty').dataset.price);\n                                if (isNaN(total)) {\n                                    total = \"\";\n                                } else {\n\n                                    if (discount_type == \"percent\") {\n                                        total = total - (total * parseInt(document.querySelector('.edit-discount').value) / 100);\n                                    }\n\n                                    if (discount_type == \"value\") {\n                                        total = total - parseFloat(document.querySelector('.edit-discount').value);\n                                    }\n                                }\n                                document.querySelector('.edit-tp').value = total;\n                            }\n\n                            // auto update price when quantity is changed\n                            document.querySelector('.edit-qty').addEventListener('keypress', (e) => {\n\n                                // console.log(e.which);\n                                if (e.which != 8 && isNaN(String.fromCharCode(e.which))) {\n\n                                    e.preventDefault(); // stop character from entering input\n                                    return false;\n                                }\n\n                            });\n\n                            document.querySelector('.edit-qty').addEventListener('keydown', (e) => {\n\n                                // console.log('keydown');\n                                setTimeout(() => { calcItemTotal(); }, 300);\n\n                            });\n\n                            // price can be float number only\n                            document.querySelector('.edit-tp').addEventListener('keypress', (e) => {\n\n                                // console.log(e.which);\n                                if (e.which != 8 && e.which != 46 && isNaN(String.fromCharCode(e.which))) {\n\n                                    e.preventDefault(); // stop character from entering input\n                                    return false;\n                                }\n                            });\n\n                            // focus on quantity field\n                            document.querySelector('.edit-qty').focus();\n                            document.querySelector('.edit-qty').select();\n\n                            // parse selected product variations\n                            // console.log('parseVariations');\n                            document.querySelector('.item-vars-input').innerHTML = parseVariations(_this, _this.state.productsSuggestions[index]);\n\n                        });\n\n                    } else {\n\n                        parseApiError(response);\n                    }\n                })\n                .catch(error => { console.log(error); parseApiError(error); });\n\n        });\n    },\n    tableOrderItemListeners: (e) => {\n\n        // make note field visible below the order item\n        onClick('.edit-item-note', (e) => {\n\n            e.preventDefault();\n\n            let noteEl = e.currentTarget.parentElement.parentElement.parentElement.parentElement.parentElement.querySelector('.item-note');\n            // console.log(noteEl);\n            noteEl.classList.remove('d-none');\n            noteEl.focus();\n\n            preview._this.state.changes = true;\n        });\n\n        // remove order item\n        onClick('.remove-item', (e) => {\n\n            e.preventDefault();\n\n            e.currentTarget.parentElement.parentElement.parentElement.parentElement.parentElement.remove();\n\n            // if(preview._this.state.orderSingle._id == 'new') \n            preview.refreshTotals();\n\n            preview._this.state.changes = true;\n        });\n    },\n    refreshTotals: () => {\n\n        let html = ``, grand_total_temp = 0;\n\n        // calc grand_total_temp\n        for (let price of document.querySelectorAll('.item-total')){ grand_total_temp += makeNumber(price.dataset.value); };\n\n        // defaults\n        let price = { grand_total: 0, total: makeNumber(grand_total_temp), discount_percent: document.querySelector('.discount-percent-inp') ? parseInt(document.querySelector('.discount-percent-inp').value) : preview.state.orderSingle['price']['discount_percent'] ? preview.state.orderSingle['price']['discount_percent'] : 0, discount_value: document.querySelector('.discount-value-inp') ? parseFloat(document.querySelector('.discount-value-inp').value) : preview.state.orderSingle['price']['discount_value'] ? preview.state.orderSingle['price']['discount_value'] : 0, discount_total: 0, fee_total: 0, tax_total: 0, tax_percent: 0 };\n\n        // subtotal\n        let ordertotalsubtotal =\n            `<div class=\"mb-2 mt-2 order-total-subtotal order-row text-right elipsized keyx-total\">\n                <b>${__html('Subtotal')}</b><div class=\"ms-2 d-inline-block\" data-type=\"key-number\" >${priceFormat(preview._this, price.total)}</div>\n             </div>`;\n\n        html += ordertotalsubtotal;\n\n        // console.log(preview.state.orderSingle.price);\n\n        // payment method\n        if (preview._this.state.settings.custom_payment_method == \"1\") {\n\n            let options = '';\n            preview._this.state.settings.payment_methods.trim().split('\\n').forEach((el, i) => {\n\n                options += `<option value=\"${el}\" ${preview.state.orderSingle.price['payment_method'] == el ? 'selected' : ''} >${el}</option>`;\n            });\n\n            let ordertotalpaymentmethod =\n                `<div class=\"mb-2 mt-2 order-total-payment_method order-row text-right keyx-payment_method\">\n                    <b>${__('Payment')}</b>\n                    <div class=\"ms-2 d-inline-block\" >\n                        <select class=\"form-select form-select-sm payment-method-select\" data-type=\"select\" aria-label=\"Default payment method\">\n                            ${options}\n                        </select>\n                    </div>\n                </div>`;\n\n            html += ordertotalpaymentmethod;\n        }\n\n        if (document.querySelector('.order-total-subtotal')) { document.querySelector('.order-total-subtotal').outerHTML = ordertotalsubtotal; }\n\n        // discount\n        html += `<div class=\"mb-2 mt-2 order-total-discount d-flex align-items-center justify-content-end bd-highlight order-row keyx-total\">\n                <div class=\"dropdown\">\n                    <button class=\"btn border-0 dropdown-toggle fw-bold\" type=\"button\" id=\"discount-type\" data-bs-toggle=\"dropdown\" aria-expanded=\"false\">\n                    ${parseFloat(price.discount_value) > 0 ? __('Discount by value') : __('Discount by %')}\n                    </button>\n                    <ul class=\"dropdown-menu discount-type-option\" aria-labelledby=\"discount-type\">\n                        <li><a class=\"dropdown-item\" data-type=\"percent\" href=\"#\">${__('Discount by %')}</a></li>\n                        <li><a class=\"dropdown-item\" data-type=\"value\" href=\"#\">${__('Discount by value')}</a></li>\n                    </ul>\n                </div>\n                <div class=\"ms-2 d-inline-block\" data-type=\"key-number\" >\n                    <input type=\"text\" autocomplete=\"off\" maxlength=\"3\" class=\"discount-percent-inp form-control form-control-sm text-end ${parseFloat(price.discount_value) > 0 ? 'd-none' : ''}\" value=\"${price.discount_percent}\" style=\"max-width:50px;\">\n                    <input type=\"text\" autocomplete=\"off\" class=\"discount-value-inp ${parseFloat(price.discount_value) > 0 ? '' : 'd-none'} form-control form-control-sm text-end\" value=\"${price.discount_value}\" style=\"max-width:120px;\">\n                </div>\n            </div>`;\n\n        // let discount_type\n        // if(document.querySelector(\"#discount-type\").dataset.type == 'percent'){\n        if (parseInt(price.discount_percent) > 0) {\n\n            // if (parseInt(price.discount_percent) > 0 && parseInt(price.discount_percent) <= 100) {\n\n            //     price.discount_total = makeNumber((parseInt(price.discount_percent)) * price.total) / 100;\n            //     grand_total_temp -= price.discount_total;\n            // }\n\n            price.discount_total = 0;\n            for (let item_price of document.querySelectorAll('.item-total')){\n\n                if(item_price.dataset.discount_type != 'never') price.discount_total += makeNumber((parseInt(price.discount_percent)) * makeNumber(item_price.dataset.value)) / 100;\n            }\n\n            grand_total_temp -= price.discount_total;\n        }\n\n        // }else if(document.querySelector(\"#discount-type\").dataset.type == 'value'){\n        if (parseFloat(price.discount_value) > 0) {\n\n            if (parseFloat(price.discount_value) > 0) {\n\n                grand_total_temp -= price.discount_value;\n            }\n        }\n\n        // service charge\n        if (preview._this.state.settings.fee_calc == \"1\") {\n\n            // price.fee_total = makeNumber((preview._this.state.settings.fee_percent)*price.total)/100;\n            price.fee_total = makeNumber((preview._this.state.settings.fee_percent) * grand_total_temp) / 100;\n            price.fee_percent = makeNumber(preview._this.state.settings.fee_percent);\n\n            let ordertotalfee =\n                `<div class=\"mb-2 mt-2 order-total-fee order-row text-right elipsized\">\n                    <b>${__(preview._this.state.settings.fee_display)}</b><div class=\"ms-2 d-inline-block\" data-type=\"key-number\" >${priceFormat(preview._this, price.fee_total)}</div>\n                 </div>`;\n\n            html += ordertotalfee;\n\n            if (document.querySelector('.order-total-fee')) { document.querySelector('.order-total-fee').outerHTML = ordertotalfee; }\n\n            // console.log(price.fee_total);\n\n            grand_total_temp += price.fee_total;\n        }\n\n        // tax \n        if (preview._this.state.settings.tax_calc == \"1\") {\n\n            // console.log(grand_total_temp + ' '  + parseFloat(preview._this.state.settings.tax_percent/100));\n            price.tax_total = makeNumber(((grand_total_temp) * parseFloat(preview._this.state.settings.tax_percent)) / 100);\n            price.tax_percent = makeNumber(preview._this.state.settings.tax_percent);\n            let ordertotaltax =\n                `<div class=\"mb-2 mt-2 order-total-tax order-row text-right elipsized\">\n                    <b>${preview._this.state.settings.tax_display}</b><div class=\"ms-2 d-inline-block\" data-type=\"key-number\" >${priceFormat(preview._this, price.tax_total)}</div>\n                 </div>`;\n\n            html += ordertotaltax;\n\n            if (document.querySelector('.order-total-tax')) { document.querySelector('.order-total-tax').outerHTML = ordertotaltax; }\n\n            grand_total_temp += price.tax_total;\n        }\n\n        // grand total\n        price.grand_total = makeNumber(grand_total_temp);\n        let ordertotalgrandtotal =\n            `<div class=\"mb-2 mt-2 order-total-grandtotal order-row text-right elipsized\">\n                <b>${__html('Grand Total')}</b><div class=\"ms-2 d-inline-block\" data-type=\"key-number\" >${priceFormat(preview._this, price.grand_total)}</div>\n             </div>`;\n\n        html += ordertotalgrandtotal;\n\n        if (document.querySelector('.order-total-grandtotal')) { document.querySelector('.order-total-grandtotal').outerHTML = ordertotalgrandtotal; }\n\n        // if(document.querySelector('.order-total')) document.querySelector('.order-total').remove(); \n        if (document.querySelector('.order-total')) {\n\n            document.querySelector('.order-total').dataset.price = encodeURIComponent(JSON.stringify(price));\n        } else {\n\n            // document.querySelector('.order-total').remove(); \n            document.querySelector('.modal-body-cont').insertAdjacentHTML(\"beforeend\", `<div class=\"mt-5 order-total order-form text-end\" data-type=\"price\" data-price=\"${encodeURIComponent(JSON.stringify(price))}\">${html}</div>`);\n\n            onClick('.discount-type-option li a', (e) => {\n\n                e.preventDefault();\n\n                document.querySelector('#discount-type').dataset.type = e.currentTarget.dataset.type;\n\n                console.log(e.currentTarget.dataset.type);\n\n                switch (e.currentTarget.dataset.type) {\n\n                    case 'value':\n\n                        document.querySelector('#discount-type').innerHTML = __html('Discount by value');\n                        document.querySelector('.discount-value-inp').style.maxWidth = '120px';\n                        document.querySelector('.discount-value-inp').classList.remove('d-none');\n                        document.querySelector('.discount-percent-inp').classList.add('d-none');\n                        document.querySelector('.discount-percent-inp').value = 0;\n                        break;\n                    case 'percent':\n\n                        document.querySelector('#discount-type').innerHTML = __html('Discount by %');\n                        document.querySelector('.discount-percent-inp').style.maxWidth = '70px';\n                        document.querySelector('.discount-value-inp').classList.add('d-none');\n                        document.querySelector('.discount-percent-inp').classList.remove('d-none');\n                        document.querySelector('.discount-value-inp').value = 0;\n                        break;\n                }\n\n                preview._this.state.changes = true;\n                \n                preview.refreshTotals();\n            });\n\n            // restrict discount percent input fields\n            onlyNumbers('.discount-percent-inp', [8]);\n            onKeyUp('.discount-percent-inp', (e) => {\n\n                if (parseInt(e.currentTarget.value) > 100 || parseInt(e.currentTarget.value) < 0) {\n\n                    // console.log(e.currentTarget.value)\n                    e.currentTarget.setCustomValidity(\"wrong percent value\");\n                } else {\n\n                    e.currentTarget.setCustomValidity(\"\");\n                }\n\n                // if(e.currentTarget.value=='') e.currentTarget.value = 0;\n\n                e.currentTarget.parentElement.classList.add(\"was-validated\");\n\n                e.currentTarget.style.maxWidth = '70px';\n\n                preview.refreshTotals();\n            });\n\n            // restrict discount value input fields\n            onlyNumbers('.discount-value-inp', [8, 46]);\n            onKeyUp('.discount-value-inp', (e) => {\n\n                if (parseInt(e.currentTarget.value) < 0 || parseInt(e.currentTarget.value) > price.total) {\n\n                    // console.log(e.currentTarget.value)\n                    e.currentTarget.setCustomValidity(\"wrong discount value\");\n                } else {\n\n                    e.currentTarget.setCustomValidity(\"\");\n                }\n\n                // if(e.currentTarget.value=='') e.currentTarget.value = 0;\n\n                e.currentTarget.parentElement.classList.add(\"was-validated\");\n\n                e.currentTarget.style.maxWidth = '120px';\n\n                preview._this.state.changes = true;\n\n                preview.refreshTotals();\n            });\n        }\n    },\n\n    /*\n    order JSON structure example\n    {\n        \"id\": \"pDqeWHGI1648563700945\",\n        \"idd\": \"ItqvUvlY1648563462357\",\n        \"kid\": \"7851\",\n        \"sid\": \"1000452\",\n        \"from\": \"1 - WP Asia\",\n        \"name\": \"WP Asia\",\n        \"customer\": {\n  \n  \n        },\n        \"note\": \"\",\n        \"note_vendor\": \"\",\n        \"step\": 1,\n        \"items\": [\n            {\n                \"id\": \"24adf24670cf977efe9386b781c9dc18124ac54b\",\n                \"qty\": 2,\n                \"note\": \"\",\n                \"type\": \"new\",\n                \"index\": \"27\",\n                \"price\": 10,\n                \"sdesc\": \"Deep Fried Gyoza with Mentai Sauce\",\n                \"title\": \"11. MENTAI GYOZA\",\n                \"total\": 20,\n                \"variations\": []\n            },\n            {\n                \"id\": \"c070bdb900bb47605b0056f96e7c4c9108fa22fe\",\n                \"qty\": 1,\n                \"note\": \"\",\n                \"type\": \"new\",\n                \"index\": \"24\",\n                \"price\": 8,\n                \"sdesc\": \"Deep-fried Sweet Prawn\",\n                \"title\": \"8. AMAEBI KARAAGE\",\n                \"total\": 8,\n                \"variations\": []\n            }\n        ],\n        \"table\": \"1\",\n        \"total\": 28,\n        \"status\": \"new\",\n        \"created\": 1648563701,\n        \"updated\": 1648563701\n    }\n    */\n    addOrderItem: (_this) => {\n\n        onClick('.add-item', (e) => {\n\n            let x = 0, itemArr = [], item = {};\n\n            // get order item details\n            item.id = document.querySelector('.edit-item').dataset.id;\n            item.cats = JSON.parse(document.querySelector('.edit-item').dataset.cats);\n            item.title = document.querySelector('.edit-item').value;\n            item.total = parseFloat(document.querySelector('.edit-tp').value);\n            item.price = parseInt(document.querySelector('.edit-tp').dataset.price);\n            item.discounts = JSON.parse(document.querySelector('.edit-item').dataset.discounts);\n            item.qty = parseInt(document.querySelector('.edit-qty').value);\n            item.note = \"\";\n            item.created = preview.state.orderSingle.updated; // Date.now() / 1000 | 0;  \n            item.variations = [];\n\n            // get discount\n            let discount_type = document.querySelector('.edit-discount').options[document.querySelector('.edit-discount').selectedIndex].dataset.type;\n            // if (discount_type) item.discount_type;\n            if (discount_type == \"percent\") { item.discount_percent = document.querySelector('.edit-discount').value; }\n            if (discount_type == \"value\") { item.discount_value = document.querySelector('.edit-discount').value; }\n            \n            // working\n            let count = 0;\n            let list = document.querySelectorAll(\".item-vars-input input\");\n            for (const inp of list) {\n\n                let v = count;\n                if (inp.checked) {\n\n                    if (!item.variations[v]) item.variations[v] = {};\n\n                    if (!item.variations[v].list) item.variations[v].list = {};\n\n                    if (!item.variations[v].title) item.variations[v].title = inp.dataset.titlev;\n\n                    // cache selected variations\n                    item.variations[v].list[\"_\" + inp.dataset.index] = { title: inp.dataset.title, price: parseFloat(inp.dataset.price) };\n\n                    item.total += item.qty * parseFloat(inp.dataset.price);\n\n                    count += 1;\n                }\n            }\n\n            if (item.title.length < 2) { alert(__('Incorrect product data')); return; }\n\n            itemArr.push(item);\n\n            let itemRow = preview.structOrderItemTable(_this, x, itemArr, true);\n\n            document.querySelector('.new-item-row').insertAdjacentHTML(\"beforebegin\", itemRow);\n\n            preview.tableOrderItemListeners();\n\n            // calculate totals for new orders only\n            preview.refreshTotals();\n\n            // clear fields\n            document.querySelector('.edit-item').value = \"\";\n            document.querySelector('.edit-tp').value = \"\";\n            document.querySelector('.edit-qty').value = \"\";\n            document.querySelector('.edit-discount').value = \"\";\n            document.querySelector(\".item-vars-input\").innerHTML = \"\";\n\n            // focus back to the input field\n            setTimeout(() => { document.querySelector('.edit-item').focus(); }, 300);\n\n            preview._this.state.changes = true;\n        });\n    },\n}","import { __html } from '@kenzap/k-cloud';\n\nexport const HTMLContent = () => {\n\n    return `\n      <div class=\"container ec-orders\">\n        <div class=\"d-md-flex justify-content-between bd-highlight mb-3\">\n            <nav class=\"bc\" aria-label=\"breadcrumb\"></nav>\n            <button class=\"btn btn-primary add-order btn-add mt-3 mb-1 mt-md-0 mb-md-0\" type=\"button\">${ __html('New order') }</button>\n        </div>\n        <div class=\"d-md-flex justify-content-between bd-highlight mb-3\">\n          <div>\n            <div class=\"col-md-12 page-title\">\n              <div class=\"st-opts st-table dropdown\">\n                  <a class=\"btn btn-outline-secondary dropdown-toggle\" href=\"#\" role=\"button\" id=\"order-status\" data-id=\"status\" data-value=\"\" data-bs-toggle=\"dropdown\" aria-expanded=\"false\">\n                    ${ __html('All') }\n                  </a>\n                  <ul class=\"dropdown-menu\" aria-labelledby=\"order-status\">\n                    <li><a class=\"dppi dropdown-item\" data-key=\"\" href=\"#\" >${ __html('All') }</a></li>\n                    <li><a class=\"dppi dropdown-item\" data-key=\"new\" href=\"#\" >${ __html('New') }</a></li>\n                    <li><a class=\"dppi dropdown-item\" data-key=\"paid\" href=\"#\" >${ __html('Paid') }</a></li>\n                    <li><a class=\"dppi dropdown-item\" data-key=\"processing\" href=\"#\" >${ __html('Processing') }</a></li>\n                    <li><a class=\"dppi dropdown-item\" data-key=\"completed\" href=\"#\" >${ __html('Completed') }</a></li>\n                    <li><a class=\"dppi dropdown-item\" data-key=\"canceled\" href=\"#\" >${ __html('Canceled') }</a></li>\n                    <li><a class=\"dppi dropdown-item\" data-key=\"failed\" href=\"#\" >${ __html('Failed') }</a></li>\n                    <li><a class=\"dppi dropdown-item\" data-key=\"refunded\" href=\"#\" >${ __html('Refunded') }</a></li>\n                  </ul>\n              </div>\n              <div class=\"st-opts\" >\n                <div class=\"input-group-sm mb-0 justify-content-start mb-sm-0\" >\n                  <input id=\"usearch\" type=\"text\" class=\"inp form-control search-input\" autocomplete=\"off\" placeholder=\"${ __html('Search order') }\">\n                </div>\n                <!-- <a id=\"viewSum\" href=\"#\" style=\"margin-left:16px;\">view summary</a> -->\n              </div>\n            </div>\n          </div>\n          <div class=\"qr-print-cnt d-none align-self-center my-3 my-md-0\">\n            <div class=\"d-inline-block\">\n              <input id=\"qr-number\" type=\"text\" class=\"inp form-control form-control-sm qr-number p-0 px-2 me-2 ms-0\" autocomplete=\"off\" style=\"max-width:100px;\" placeholder=\"${ __('QR number') }\">\n            </div>\n            <div class=\"d-inline-block\">\n              <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"30\" height=\"30\" fill=\"currentColor\" class=\"bi bi-qr-code-scan print-qr po\" viewBox=\"0 0 16 16\">\n                <path d=\"M0 .5A.5.5 0 0 1 .5 0h3a.5.5 0 0 1 0 1H1v2.5a.5.5 0 0 1-1 0v-3Zm12 0a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v3a.5.5 0 0 1-1 0V1h-2.5a.5.5 0 0 1-.5-.5ZM.5 12a.5.5 0 0 1 .5.5V15h2.5a.5.5 0 0 1 0 1h-3a.5.5 0 0 1-.5-.5v-3a.5.5 0 0 1 .5-.5Zm15 0a.5.5 0 0 1 .5.5v3a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1 0-1H15v-2.5a.5.5 0 0 1 .5-.5ZM4 4h1v1H4V4Z\"/>\n                <path d=\"M7 2H2v5h5V2ZM3 3h3v3H3V3Zm2 8H4v1h1v-1Z\"/>\n                <path d=\"M7 9H2v5h5V9Zm-4 1h3v3H3v-3Zm8-6h1v1h-1V4Z\"/>\n                <path d=\"M9 2h5v5H9V2Zm1 1v3h3V3h-3ZM8 8v2h1v1H8v1h2v-2h1v2h1v-1h2v-1h-3V8H8Zm2 2H9V9h1v1Zm4 2h-1v1h-2v1h3v-2Zm-4 2v-1H8v1h2Z\"/>\n                <path d=\"M12 9h2V8h-2v1Z\"/>\n              </svg>\n            </div>\n          </div> \n        </div>\n\n        <div id=\"orders-after-header\">\n\n\n        </div>\n\n        <div class=\"row\">\n          <div class=\"col-md-12 grid-margin grid-margin-lg-0 grid-margin-md-0 stretch-card\">\n            <div class=\"card border-white shadow-sm border-0\">\n              <div class=\"card-body p-0\">\n \n                <div class=\"table-responsive\">\n                  <table class=\"table table-hover table-borderless align-middle table-striped table-p-list mb-0\">\n                    <thead>\n                      <tr>\n                        <th><span class=\"ps-1\">${ __html('From') }</span></th>\n                        <th class=\"d-none d-sm-table-cell\">${ __html('Status') }</th>\n                        <th>${ __html('Subtotal') }</th>\n                        <th class=\"d-none d-sm-table-cell\">${ __html('Time') }</th>\n                        <th></th>\n                      </tr>\n                    </thead>\n                    <tbody class=\"list\">\n\n                    </tbody>\n                  </table>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      <div class=\"modal order-modal\" tabindex=\"-1\" data-backdrop=\"static\" data-keyboard=\"false\">\n        <div class=\"modal-dialog \">\n          <div class=\"modal-content\">\n              <div class=\"modal-header\">\n                <h5 class=\"modal-title\"></h5>\n                <button type=\"button\" class=\"btn-close align-self-start-remove\" data-bs-dismiss=\"modal\" aria-label=\"Close\"></button>\n              </div>\n              <div class=\"modal-body\">\n              \n              </div>\n              <div class=\"modal-footer\">\n                <button type=\"button\" class=\"btn btn-primary btn-confirm\"></button>\n                <button type=\"button\" class=\"btn btn-secondary\" data-bs-dismiss=\"modal\"></button>\n              </div>\n          </div>\n        </div>\n      </div>\n\n    `;\n}","// js dependencies\nimport { headers, showLoader, hideLoader, initHeader, initFooter, initBreadcrumbs, parseApiError, getCookie, onClick, onKeyUp, spaceID, toast, link, onChange, __html } from '@kenzap/k-cloud';\nimport { timeConverterAgo, priceFormat, getPageNumber, makeNumber, unescape, mt, playSound, ecommerceUpdates } from \"../_/_helpers.js\"\nimport { tables } from \"../_/_order_tables.js\"\nimport { preview } from \"../_/_order_preview.js\"\nimport { HTMLContent } from \"../_/_cnt_orders.js\"\nimport { printReceipt, autoPrint, isPrintQREnabled } from \"../_/_print.js\"\n\n// where everything happens\nconst _this = {\n  \n    state: {\n        firstLoad: true,\n        changes: false,\n        modalCont: null,\n        modalOpen: false,\n        playSound: { allowed: false, ids: null, nids: [], n: 0, max_times: 5, timer: null, audio: new Audio('https://kenzap.com/static/swiftly.mp3') },\n        orderIDs: [],\n        printLink: null, // storing receipt print pending order \n        printRequest: null, // storing receipt print pending order \n        user: {}, // where user data is cached\n        orders: [], // where all requested orders are cached\n        settings: {}, // where all requested settings are cached\n        qr_settings: {}, // where all requested settings are cached\n        orderSingle: [], // where single order is stored during preview\n        updates: { last_order_id: '', last_order_update: 0 },\n        playTitleTimer: null,\n        refreshTimer: null,\n        statuses: [],\n        limit: 200, // number of records to load per table\n        slistLimit: 10, // product suggestion fetch search limit\n        productsSuggestions: []\n    },\n    init: () => {\n         \n        // load data\n        _this.getData();\n\n        // get latest orders and notifications\n        let cb = (response) => { \n\n            if(_this.state.firstLoad){ \n\n                _this.state.updates.last_order_id = response.last_order_id;\n                _this.state.updates.last_order_update = response.last_order_update;\n            }\n\n            // refresh if order list changes\n            if(response.last_order_update != _this.state.updates.last_order_update){\n\n                playSound(_this, 1);\n\n                _this.getData();\n                 \n                _this.state.updates.last_order_id = response.last_order_id;\n                _this.state.updates.last_order_update = response.last_order_update;\n            }\n        };\n\n        // _this.playSound();\n\n        // ecommerceUpdates(_this, ['messages', 'last_order_id'], cb);\n\n        // turn on data polling for new orders\n        _this.state.refreshTimer = setInterval(() => { ecommerceUpdates(_this, ['messages', 'last_order_id'], cb); }, 5000);\n    },\n    getData: () => {\n\n        // show loader during first load\n        if (_this.state.firstLoad) showLoader();\n\n        // check if any print pending receipts\n        // if (_this.state.printLink){ window.location.href = _this.state.printLink; _this.state.printLink = null; }\n        // if (_this.state.printLink){\n\n        //     printReceipt(_this); \n        //     // window.location.href = _this.state.printLink; _this.state.printLink = null; \n        // }\n        if(_this.state.printRequest){ printReceipt(_this, _this.state.printRequest, \"user\"); }\n\n        // search content\n        let s = document.querySelector('.search-input') ? document.querySelector('.search-input').value : '';\n\n        // search term \n        let term = document.querySelector('#order-status') ? document.querySelector('#order-status').dataset.value: '';\n\n        // skip refresh if modal is open\n        if(document.querySelector('body.modal-open')){ return; }\n        \n        // do API query\n        fetch('https://api-v1.kenzap.cloud/', {\n            method: 'post',\n            headers: headers,\n            body: JSON.stringify({\n                query: {\n                    user: {\n                        type:       'authenticate',\n                        fields:     ['avatar', 'id'],\n                        token:      getCookie('kenzap_token')\n                    },\n                    locale: {\n                        type:       'locale',\n                        source:      ['extension'],\n                        key:         'ecommerce',\n                    },\n                    orders: {\n                        type:       'find',\n                        key:        'ecommerce-order',\n                        fields:     '*',\n                        term:       term != '' ? 'status=\\'' + term +'\\'' : '',\n                        limit:      _this.state.limit,\n                        search:     {                                                           // if s is empty search query is ignored\n                            field: 'from',\n                            s: s\n                        },\n                        sortby:     {\n                            field: 'created',\n                            order: 'DESC'\n                        }\n                    },\n                    // qr_settings: {\n                    //     type:       'get',\n                    //     key:        'qrmenu-settings',\n                    //     fields:     ['slug'],\n                    // },\n                    settings: {\n                        type:       'get',\n                        key:        'ecommerce-settings',\n                        fields:     ['currency', 'currency_symb', 'currency_symb_loc', 'tax_calc', 'tax_percent_auto', 'tax_percent', 'tax_display', 'fee_calc', 'fee_percent', 'fee_display', 'payment_methods', 'custom_payment_method', 'tables', 'table_list', 'add_products', 'add_products_list', 'templates'],\n                    }\n                }\n            })\n        })\n        .then(response => response.json())\n        .then(response => {\n\n            // hide UI loader\n            hideLoader();\n\n            if(response.success){\n                \n                // init header\n                initHeader(response);\n\n                // get core html content \n                _this.loadPageStructure();  \n\n                // render table\n                _this.renderPage(response);\n\n                // bind content listeners\n                _this.initListeners();\n            \n                // initiate footer\n                _this.initFooter();\n\n                // first load\n                _this.state.firstLoad = false;\n\n            }else{\n\n                parseApiError(response);\n            }\n        })\n        .catch(error => { parseApiError(error); });\n    },\n    authUser: (response) => {\n\n        if(response.user){\n            \n            if(response.user.success == true){\n\n                \n            }\n        }\n    },\n    loadPageStructure: () => {\n\n        if(!_this.state.firstLoad) return;\n\n        // get core html content \n        document.querySelector('#contents').innerHTML = HTMLContent();\n    },\n    renderPage: (response) => {\n\n        if(_this.state.firstLoad){\n\n            // initiate breadcrumbs\n            initBreadcrumbs(\n                [\n                    { link: link('https://dashboard.kenzap.cloud'), text: __html('Dashboard') },\n                    { link: link('/'), text: __html('E-commerce') },\n                    { text: __html('Orders') }\n                ]\n            );\n\n            // initialize statuses\n            _this.state.statuses = {\n                'new': { \n                    text: __html('New'),\n                    class: 'btn-warning text-dark fw-light'\n                },\n                'paid': {\n                    text: __html('Paid'),\n                    class: 'btn-primary fw-light'\n                },\n                'processing': { \n                    text: __html('Processing'),\n                    class: 'btn-primary fw-light'\n                },\n                'completed': { \n                    text: __html('Completed'),\n                    class: 'btn-success fw-light'\n                },\n                'canceled': { \n                    text: __html('Canceled'),\n                    class: 'btn-secondary fw-light'\n                },\n                'failed': { \n                    text: __html('Failed'),\n                    class: 'btn-danger fw-light'\n                },\n                'refunded': { \n                    text: __html('Refunded'),\n                    class: 'btn-danger fw-light'\n                }\n            };\n        }\n\n        // cache orders globally\n        _this.state.user = response.user;\n        _this.state.orders = response.orders;\n        _this.state.meta = response.meta;\n        \n        // console.log(_this.state.orders);\n\n        // cache settings globally\n        _this.state.settings = response.settings;\n        // _this.state.qr_settings = response.qr_settings;\n\n        if (!_this.state.settings['templates']){ _this.state.settings['templates'] = []; }\n\n        // enable QR priting\n        _this.state.settings.qr_print = isPrintQREnabled(_this);\n        if (_this.state.settings.qr_print){ document.querySelector(\".qr-print-cnt\").classList.remove('d-none'); }\n\n        // no orders in the list\n        if (response.orders.length == 0){\n\n            document.querySelector(\".table tbody\").innerHTML = `<tr><td colspan=\"5\">${ __html(\"No orders to display.\") }</td></tr>`;\n            return;\n        }\n\n        // generate website table\n        let orderIDsTemp = [];\n        _this.state.newOrderCount = [];\n\n        let list = '', new_ids = '';\n        for (let i in response.orders){\n\n            // save last order ID for ecommerceUpdates\n            // if(i==0) _this.state.lastOrderID = response.orders[i]._id;\n\n            let img = 'https://cdn.kenzap.com/loading.png';\n            orderIDsTemp.push(response.orders[i]._id);\n\n            if(typeof(response.orders[i].status) === 'undefined') response.orders[i].status = 'new';\n\n            if(response.orders[i].status == 'new') new_ids += response.orders[i].id;\n     \n            let applink = {\"print\":\"[C]<u><font size=\\\"big\\\">ORDER{{order_id_short}}</font></u>\\n[C]Fu Zhen Seafood\\n[C]<u type=double>{{date_time}}</u>\\n[C]\\n[C]================================\\\" \\n[L]\\n[L]<b>BEAUTIFUL SHIRT</b>[R]9.99€\\n[L]  + Size : S\\n[L]\\n[L]<b>AWESOME HAT</b>[R]24.99€\\n[L]  + Size : 57/58\\n[L]\\n[C]--------------------------------\\n[R]TOTAL PRICE :[R]34.98€\\n[R]TAX :[R]4.23€\"};\n            let classN = ((_this.state.orderIDs.includes(response.orders[i]._id) || _this.state.firstLoad)?'':'new');\n            list += `\n            <tr class=\"${ classN }\">\n              <td class=\"details view-order\" data-id=\"${ response.orders[i]._id }\" data-index=\"${ i }\">\n                <div class=\"ps-1\" >\n                  <b class=\"\">${ (response.orders[i].id) }</b> ${ response.orders[i].from }\n                  <div class=\" elipsized fst-italic\">${ response.orders[i].note ? response.orders[i].note : \"\" }</div>\n                  <div class=\" d-sm-none\"> <span class=\"me-2\">${ _this.getStatus(response.orders[i].status) }</span> <span class=\"text-muted\">${ timeConverterAgo(__, response.meta.time, response.orders[i].created) }</span> </div>\n                </div>\n              </td>\n              <td class=\"d-none d-sm-table-cell\">\n                <span class=\"fs-12\">${ _this.getStatus(response.orders[i].status) }</span>\n              </td>\n              <td>\n                <span style=\"font-size:18px;\">${ priceFormat(_this, response.orders[i].total) }</span>\n              </td>\n              <td class=\"d-none d-sm-table-cell\">\n                <span style=\"font-size:18px;\">${ timeConverterAgo(__, response.meta.time, response.orders[i].created) }</span>\n              </td>\n              <td class=\"last\">\n                <a href=\"#\" data-id=\"${ response.orders[i]._id }\" data-index=\"${ i }\" class=\"view-order text-success d-none me-4\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" fill=\"currentColor\" class=\"bi bi-eye\" viewBox=\"0 0 16 16\">\n                    <path d=\"M16 8s-3-5.5-8-5.5S0 8 0 8s3 5.5 8 5.5S16 8 16 8zM1.173 8a13.133 13.133 0 0 1 1.66-2.043C4.12 4.668 5.88 3.5 8 3.5c2.12 0 3.879 1.168 5.168 2.457A13.133 13.133 0 0 1 14.828 8c-.058.087-.122.183-.195.288-.335.48-.83 1.12-1.465 1.755C11.879 11.332 10.119 12.5 8 12.5c-2.12 0-3.879-1.168-5.168-2.457A13.134 13.134 0 0 1 1.172 8z\"/>\n                    <path d=\"M8 5.5a2.5 2.5 0 1 0 0 5 2.5 2.5 0 0 0 0-5zM4.5 8a3.5 3.5 0 1 1 7 0 3.5 3.5 0 0 1-7 0z\"/>\n                </svg></a>\n                <a href=\"kenzapprint://kenzapprint.app?data=${ encodeURIComponent(JSON.stringify(applink)) }\" data-id=\"${ response.orders[i]._id }\" data-index=\"${ i }\" class=\"print-order-dis d-none text-success me-2\">\n                <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"20\" height=\"20\" fill=\"currentColor\" class=\"bi bi-printer me-2\" viewBox=\"0 0 16 16\">\n                    <path d=\"M2.5 8a.5.5 0 1 0 0-1 .5.5 0 0 0 0 1z\"/>\n                    <path d=\"M5 1a2 2 0 0 0-2 2v2H2a2 2 0 0 0-2 2v3a2 2 0 0 0 2 2h1v1a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2v-1h1a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2h-1V3a2 2 0 0 0-2-2H5zM4 3a1 1 0 0 1 1-1h6a1 1 0 0 1 1 1v2H4V3zm1 5a2 2 0 0 0-2 2v1H2a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1v3a1 1 0 0 1-1 1h-1v-1a2 2 0 0 0-2-2H5zm7 2v3a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1v-3a1 1 0 0 1 1-1h6a1 1 0 0 1 1 1z\"/>\n                </svg></a>\n                <a href=\"#\" data-id=\"${ response.orders[i]._id }\" data-index=\"${ i }\" class=\"remove-order text-danger me-2\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"19\" height=\"19\" fill=\"currentColor\" class=\"bi bi-trash\" viewBox=\"0 0 16 16\">\n                    <path d=\"M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0V6z\"/>\n                    <path fill-rule=\"evenodd\" d=\"M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1v1zM4.118 4 4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4H4.118zM2.5 3V2h11v1h-11z\"/>\n                </svg></a>\n              </td>\n            </tr>`;\n        }\n        \n        // _this.state.playSoundNow = count_new > 0 ? true : false;\n        // if(_this.state.playSound.ids != new_ids && !document.querySelector('body.modal-open')){ console.log('reload no'); }else{ console.log('reload yes'); _this.getData(); }\n\n        // if(_this.state.playSound.ids){  }\n\n        if(_this.state.playSound.ids && _this.state.playSound.ids!=new_ids && _this.state.playSound.ids.length < new_ids.length){ playSound(_this, 3); }\n\n        _this.state.playSound.ids = new_ids;\n        \n        _this.state.orderIDs = orderIDsTemp;\n\n        // provide result to the page\n        document.querySelector(\".table tbody\").innerHTML = list;\n    },\n    // parse visual page status\n    getStatus: (status) => {\n    \n        return `<div class=\"badge ${ _this.state.statuses[status].class }\">${ _this.state.statuses[status].text }</div>`;\n    },\n    initListeners: () => {\n\n        // view table mode\n        tables.render(_this);\n\n        // view order\n        preview.viewOrder(_this);\n        \n        // remove order\n        onClick('.remove-order', _this.listeners.removeOrder);\n\n        // print order\n        // print.viewOrder(_this);\n        // onClick('.print-order', _this.listeners.printOrder);\n\n        // table status change listener\n        onClick('.st-table li a', _this.listeners.changeStatus);\n\n        // break here if initListeners is called more than once\n        if(!_this.state.firstLoad) return;\n\n        // turn on auto printing \n        autoPrint(_this);\n\n        // add new order listener\n        preview.newOrder(_this);\n\n        // modal success button\n        onClick('.modal .btn-primary', _this.listeners.modalSuccessBtn);\n        \n        // search orders\n        onKeyUp('.search-input', _this.listeners.searchOrders);\n\n        // track first touch iteration to allow sound to play\n        document.body.addEventListener('touchstart', function(){ _this.state.playSound.allowed = true ; }, false);\n        document.body.addEventListener('mousedown', function(){ _this.state.playSound.allowed = true ; }, false);\n\n        // android back pressed\n        window.addEventListener(\"hashchange\", function(e) {\n\n            // close modal if still openned\n            // if(window.location.href.indexOf(\"#editing\")==-1) { e.preventDefault(); if(_this.modalCont){ _this.modalCont.hide(); } return false; }\n            if(_this.modalCont){ e.preventDefault(); _this.modalOpen = false; _this.modalCont.hide(); return false; }\n\t\t});\n    },\n    listeners: {\n\n        newOrder: (e) => {\n\n\n        },\n        changeStatus: (e) => {\n\n            e.preventDefault();\n\n            // console.log(e.currentTarget.dataset.key);\n\n            let os = document.querySelector('#order-status');\n            if(e.currentTarget.dataset.key == \"\"){\n                os.innerHTML = __html('All')\n                os.dataset.value = '';\n            }else{\n                os.innerHTML = _this.state.statuses[e.currentTarget.dataset.key].text;\n                os.dataset.value = e.currentTarget.dataset.key;\n            }\n\n            let list = [];\n\n            // clear previous classes\n            Object.keys(_this.state.statuses).forEach((key) => {\n                list = _this.state.statuses[key].class.split(' ');\n                list.forEach((key) => { \n                    os.classList.remove(key);\n                });\n                os.classList.remove('btn-outline-secondary');\n            });\n\n            // add new classes\n            if(e.currentTarget.dataset.key==''){\n                \n                os.classList.add('btn-outline-secondary');\n            }else{\n                list = _this.state.statuses[e.currentTarget.dataset.key].class.split(' ');\n                list.forEach((key) => { \n                    os.classList.add(key);\n                });\n            }\n\n            // reload table\n            _this.getData();\n        },\n        removeOrder: (e) => {\n\n            e.preventDefault();\n\n            let c = confirm( __('Completely remove this order?') );\n\n            if(!c) return;\n  \n            // send data\n            fetch('https://api-v1.kenzap.cloud/ecommerce/', {\n                method: 'post',\n                headers: headers,\n                body: JSON.stringify({\n                    query: {\n                        product: {\n                            type:       'delete-order',\n                            id:         e.currentTarget.dataset.id,  \n                            sid:        spaceID(),\n                        }\n                    }\n                })\n            })\n            .then(response => response.json())\n            .then(response => {\n\n                if (response.success){\n\n                    // _this.modalCont.hide();\n\n                    _this.getData();\n\n                }else{\n\n                \n                    parseApiError(response);\n                }\n            })\n            .catch(error => {\n                parseApiError(error);\n            });\n        },\n        searchOrders: (e) => {\n\n            e.preventDefault();\n\n            _this.getData();\n        },\n\n        modalSuccessBtn: (e) => {\n            \n            _this.listeners.modalSuccessBtnFunc(e);\n        },\n\n        modalSuccessBtnFunc: null\n    },\n    updateOrder: (i, id) => {\n\n        // print immediately if order has no changes\n        if(!_this.state.changes && _this.state.printRequest){ printReceipt(_this, _this.state.printRequest, \"user\"); _this.modalCont.hide(); return; }\n\n        let modal = document.querySelector(\".modal\");\n        if(modal.querySelector(\".btn-confirm\").dataset.loading === 'true') return;\n        modal.querySelector(\".btn-confirm\").dataset.loading = true;\n        modal.querySelector(\".btn-confirm\").innerHTML = '<span class=\"spinner-border spinner-border-sm me-2\" role=\"status\" aria-hidden=\"true\"></span>' + __html('Loading..');\n\n        let data = {};\n\n        // iterate through all fields\n        for(let s of document.querySelectorAll('.order-form')){\n\n            switch(s.dataset.type){\n          \n                // case 'html': data[s.dataset.id] = s.innerHTML; break;\n                case 'key': \n                    data[s.dataset.id] = s.dataset.value; \n                    break;\n                case 'key-number': \n                    data[s.dataset.id] = makeNumber(s.dataset.value); \n                    break;\n                case 'items':   \n\n                    // data['items'] = {};\n                    data['items'] = [];\n                    for(let item of document.querySelectorAll('.order-item-row-active')){\n\n                        let vars = JSON.parse(unescape(item.dataset.vars));\n                        let cats = JSON.parse(unescape(item.dataset.cats));\n                        let discounts = JSON.parse(unescape(item.dataset.discounts));\n                        let obj = {\n                            \"id\": item.dataset.id,\n                            \"qty\": parseInt(item.querySelector('.item-qty').dataset.value),\n                            \"cats\": cats ? cats : [],\n                            \"discounts\": discounts ? discounts : [],\n                            \"note\": item.querySelector('.item-note').innerHTML,\n                            \"type\": \"new\",\n                            \"index\": \"0\",\n                            \"price\": parseFloat(item.querySelector('.item-total').dataset.price),\n                            \"sdesc\": item.querySelector('.item-title').dataset.sdesc,\n                            \"title\": item.querySelector('.item-title').dataset.value,\n                            // \"priceF\": parseFloat(item.querySelector('.item-total').dataset.value),\n                            \"total\": parseFloat(item.querySelector('.item-total').dataset.value),\n                            \"variations\": id == 'new' ? [] : vars ? vars : [],\n                        }\n\n                        // get discount\n                        // let discount_type = document.querySelector('.edit-discount').options[document.querySelector('.edit-discount').selectedIndex].dataset.type;\n                        if (item.querySelector('.item-total').dataset.discount_percent) { obj.discount_percent = item.querySelector('.item-total').dataset.discount_percent; }\n                        if (item.querySelector('.item-total').dataset.discount_value) { obj.discount_value = item.querySelector('.edit-total').dataset.discount_value; }\n                    \n                        data['items'].push(obj);\n                    }\n                    \n                break\n                case 'text':   \n                    data[s.dataset.id] = s.innerHTML;\n                    break;\n                case 'email':  \n                case 'emails':  \n                case 'select':\n                case 'textarea': \n                    data[s.id] = s.value; \n                    break;\n                case 'radio': \n                    data[s.id] = s.parentElement.parentElement.parentElement.parentElement.parentElement.querySelector('input:checked').value; \n                    break;\n                case 'price':\n                    data['price'] = JSON.parse(decodeURIComponent(s.dataset.price));\n                    data['total'] = data['price']['total'];\n                    data['total_all'] = data['price']['grand_total'];\n                    if(document.querySelector(\".payment-method-select\")) data['price']['payment_method'] = document.querySelector(\".payment-method-select\").value;\n                    break;\n            }\n        }\n\n\n        // we use this data to generate analytical reports\n        let dateObj = new Date();\n        data['created_ymd'] = dateObj.getUTCFullYear() + '' + mt(dateObj.getUTCMonth() + 1) + '' + mt(dateObj.getUTCDate());\n        data['created_ym'] = dateObj.getUTCFullYear() + '' + mt(dateObj.getUTCMonth() + 1);\n        data['created_y'] = dateObj.getUTCFullYear() + '';\n        data['printed'] = _this.state.printRequest ? true : false;\n        data['notify'] = false;\n\n        // console.log(data);\n\n        preview._this.state.changes = false;\n\n        // create new order\n        if(id == 'new'){\n\n            // additional required fields\n            data['name'] = data['from'];\n            data['customer'] = {\n                \"first_name\": data['from'],\n                \"last_name\": \"\",\n                \"kid\": 0,\n            };\n            \n            // get last order ID number\n            fetch('https://api-v1.kenzap.cloud/ecommerce/', {\n                method: 'post',\n                headers: headers,\n                body: JSON.stringify({\n                    query: {\n                        order: {\n                            type:       'create-order',\n                            key:        'ecommerce-order',        \n                            // sid:        localStorage.sid,\n                            data:       data\n                        }\n                    }\n                })\n            })\n            .then(response => response.json())\n            .then(response => {\n                \n                if (response.success){\n\n                    _this.modalCont.hide();\n\n                    toast( __('Order created') );\n\n                    if(_this.state.printRequest == 'new') _this.state.printRequest = data._id;\n                    \n                    // if(_this.state.printLink) _this.state.printLink = printReceipt(_this, data);\n                    // if(_this.state.printLink) _this.state.printLink = printReceipt(_this, data);\n\n                    _this.getData();\n                                    \n                }else{ parseApiError(response); }\n            })\n            .catch(error => { parseApiError(error); });\n\n        // update existing order\n        }else{\n\n            // send data\n            fetch('https://api-v1.kenzap.cloud/ecommerce/', {\n                method: 'post',\n                headers: headers,\n                body: JSON.stringify({\n                    query: {\n                        order: {\n                            type:       'update-order',\n                            id:         id,         \n                            sid:        spaceID(),\n                            data:       data\n                        }\n                    }\n                })\n            })\n            .then(response => response.json())\n            .then(response => {\n\n                if (response.success){\n\n                    _this.modalCont.hide();\n\n                    toast( __('Order updated') );\n\n                    // _this.state.printRequest\n                    // if(_this.state.printLink) _this.state.printLink = printReceipt(_this, data);\n                    \n                    _this.getData();\n\n                }else{\n\n                    parseApiError(response);\n                }\n            })\n            .catch(error => {\n                parseApiError(error);\n            });\n        }\n    },\n    initFooter: () => {\n        \n        initFooter(__('Created by %1$Kenzap%2$. ❤️ Licensed %3$GPL3%4$.', '<a class=\"text-muted\" href=\"https://kenzap.com/\" target=\"_blank\">', '</a>', '<a class=\"text-muted\" href=\"https://github.com/kenzap/ecommerce\" target=\"_blank\">', '</a>'), '');\n    }\n}\n\n_this.init();"],"names":["__","onClick","mt","val","length","getPageNumber","urlParams","URLSearchParams","window","location","search","page","get","parseInt","priceFormat","_this","price","makeNumber","Math","round","parseFloat","toFixed","state","settings","currency_symb_loc","currency_symb","onlyNumbers","sel","chars","document","querySelector","addEventListener","e","includes","which","isNaN","String","fromCharCode","value","preventDefault","fn","querySelectorAll","removeEventListener","timeConverterAgo","now","time","past","a","Date","months","year","getFullYear","month","getMonth","date","getDate","getHours","getMinutes","getSeconds","parseVariations","product","html_vars","variations","v","type","__html","title","required","d","data","checked","escape","htmlStr","replace","unescape","ecommerceUpdates","source","cb","fetch","method","headers","body","JSON","stringify","query","updates","then","response","json","success","renderNotifications","messages","error","isMobile","nav","navigator","userAgent","toLowerCase","match","playSound","max","n","timer","clearInterval","allowed","audio","play","vibrate","setInterval","html","forEach","msg","nids","_id","push","color","getData","insertAdjacentHTML","id","currentTarget","dataset","el","assigned","simulateClick","getProductsById","products","fields","key","sortby","field","order","i","orderSingle","items","cats","index","note","qty","sdesc","total","console","log","parseApiError","printReceipt","template","debug","o","created","from","idd","kid","name","sid","spaceID","status","discount_percent","discount_total","discount_value","fee_total","grand_total","payment_method","tax_percent","tax_total","step","table","total_all","updated","orders","filter","templates","user","print","cols_p","indexOf","cols","substr","toLocaleString","dateStyle","timeStyle","getPrintItems","matches","matchAll","Array","x","cat","items_restricted","re","RegExp","start","end","slice","order_totals","fee_display","tax_display","printers","processStyling","toast","printRequest","rows","split","output","row","max_char","s","r","l","c","countDoubledChars","spaceN","addSpaces","floor","ceil","empty","char","txt","start_ofst","end_ofst","ofst","first_row","text","cjkRegEx","wordCount","inWord","curChar","charAt","test","undefined","list","endsWith","substring","printQR","qrnum","qr_settings","slug","autoPrint","auto_print_action","autoPrintLoop","last_print_id","localStorage","hasOwnProperty","getItem","setItem","isPrintQREnabled","tables","firstLoad","render","table_list","trim","structTableCard","meta","remove","renderField","item","classList","editable","preview","structOrderItemTable","ii","id_last","classes","_id_header","_id_body","qr_print","renderOrder","changes","modal","modalCont","bootstrap","Modal","modalOpen","rowMark","history","pushState","pageID","pathname","href","add_products","add_products_list","renderOrderUI","listeners","modalSuccessBtnFunc","updateOrder","osm","innerHTML","statuses","Object","keys","add","statusSelect","loading","fname","lname","bios","avatar","email","countryr","cityr","addr1","addr2","post","c1","c2","c3","c4","c5","setTimeout","refreshTotals","show","tableOrderItemListeners","suggestOrderItem","toggle","addOrderItem","focus","newOrder","viewOrder","itemOptions","options","isNew","vars","item_discount","discounts","obj","discount_type","onKeyUp","keyCode","charCode","scrollTo","top","getBoundingClientRect","behavior","activeElement","limit","slist","term","relation","offset","hideLoader","productsSuggestions","discount_options","discount","availability","percent","onChange","calcItemTotal","selectedIndex","select","noteEl","parentElement","grand_total_temp","ordertotalsubtotal","custom_payment_method","payment_methods","ordertotalpaymentmethod","outerHTML","item_price","fee_calc","fee_percent","ordertotalfee","tax_calc","ordertotaltax","ordertotalgrandtotal","encodeURIComponent","style","maxWidth","setCustomValidity","itemArr","parse","count","inp","titlev","alert","itemRow","HTMLContent","ids","max_times","Audio","orderIDs","printLink","last_order_id","last_order_update","playTitleTimer","refreshTimer","slistLimit","init","showLoader","token","getCookie","locale","initHeader","loadPageStructure","renderPage","initListeners","initFooter","authUser","initBreadcrumbs","link","orderIDsTemp","newOrderCount","new_ids","applink","classN","getStatus","removeOrder","changeStatus","modalSuccessBtn","searchOrders","hide","os","confirm","decodeURIComponent","dateObj","getUTCFullYear","getUTCMonth","getUTCDate"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;EAAA;EACA;EACA;EACA;EACA;EACO,MAAM,UAAU,GAAG,CAAC,QAAQ,KAAK;AACxC;EACA;EACA,IAAI,GAAG,QAAQ,CAAC,MAAM,EAAE,YAAY,CAAC,OAAO,CAAC,QAAQ,EAAE,QAAQ,CAAC,MAAM,CAAC,CAAC;EACxE;EACA;EACA,IAAI,GAAG,CAAC,QAAQ,CAAC,aAAa,CAAC,WAAW,CAAC,CAAC;EAC5C;EACA,QAAQ,IAAI,KAAK,GAAG,QAAQ,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC;EAClD,QAAQ,KAAK,CAAC,SAAS,GAAG,YAAY,CAAC,OAAO,CAAC,QAAQ,CAAC,CAAC;EACzD,QAAQ,KAAK,GAAG,KAAK,CAAC,UAAU,CAAC;EACjC,QAAQ,QAAQ,CAAC,IAAI,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC;EACrC;EACA;EACA,QAAQ,QAAQ,CAAC,QAAQ,CAAC,aAAa,CAAC,WAAW,CAAC,CAAC,SAAS,CAAC,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;EAC7E,KAAK;EACL;EACA;EACA,IAAI,GAAG,QAAQ,CAAC,MAAM,EAAE,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,MAAM,CAAC,CAAC;EAC1D,EAAC;AAmBD;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACO,MAAMA,IAAE,GAAG,CAAC,IAAI,EAAE,GAAG,CAAC,KAAK;AAClC;EACA,IAAI,IAAI,KAAK,GAAG,CAAC,KAAK,EAAE,EAAE,KAAK;AAC/B;EACA,QAAQ,EAAE,CAAC,OAAO,CAAC,CAAC,CAAC,EAAE,CAAC,KAAK,EAAE,KAAK,GAAG,KAAK,CAAC,OAAO,CAAC,GAAG,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,EAAE,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC;EAC3E;EACA,QAAQ,OAAO,KAAK,CAAC;EACrB,MAAK;AACL;EACA,IAAI,GAAG,OAAO,MAAM,CAAC,IAAI,KAAK,WAAW,EAAE,OAAO,KAAK,CAAC,IAAI,EAAE,CAAC,CAAC,CAAC;EACjE,IAAI,GAAG,MAAM,CAAC,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,MAAM,CAAC,IAAI,CAAC,KAAK,SAAS,EAAE,OAAO,KAAK,CAAC,IAAI,EAAE,CAAC,CAAC,CAAC;AAClF;EACA,IAAI,OAAO,KAAK,CAAC,MAAM,CAAC,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,MAAM,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC,CAAC;EAC3D,EAAC;AA4HD;EACA;EACA;EACA;EACA;EACA;EACA;EACO,MAAM,MAAM,GAAG,CAAC,IAAI,EAAE,GAAG,CAAC,KAAK;AACtC;EACA,IAAI,IAAI,GAAG,MAAM,CAAC,IAAI,CAAC,CAAC;AACxB;EACA,IAAI,GAAG,IAAI,CAAC,MAAM,KAAK,CAAC,CAAC;EACzB,EAAE,OAAO,EAAE,CAAC;EACZ,EAAE;AACF;EACA,IAAI,IAAI,GAAGA,IAAE,CAAC,IAAI,EAAE,GAAG,CAAC,CAAC,CAAC;AAC1B;EACA,IAAI,OAAO,IAAI,CAAC,OAAO,CAAC,UAAU,EAAE,GAAG;EACvC,QAAQ;EACR,YAAY,GAAG,EAAE,OAAO;EACxB,YAAY,GAAG,EAAE,MAAM;EACvB,YAAY,GAAG,EAAE,MAAM;EACvB,YAAY,GAAG,EAAE,OAAO;EACxB,YAAY,GAAG,EAAE,QAAQ;EACzB,SAAS,EAAE,GAAG,CAAC,CAAC,CAAC,CAAC;EAClB,EAAC;AACD;EACA;EACA;EACA;EACA;EACO,MAAM,UAAU,GAAG,MAAM;AAChC;EACA,IAAI,IAAI,EAAE,GAAG,QAAQ,CAAC,aAAa,CAAC,SAAS,CAAC,CAAC;EAC/C,IAAI,IAAI,EAAE,EAAE,EAAE,CAAC,KAAK,CAAC,OAAO,GAAG,OAAO,CAAC;EACvC,EAAC;AACD;EACA;EACA;EACA;EACA;EACO,MAAM,UAAU,GAAG,MAAM;AAChC;EACA,IAAI,IAAI,EAAE,GAAG,QAAQ,CAAC,aAAa,CAAC,SAAS,CAAC,CAAC;EAC/C,IAAI,IAAI,EAAE,EAAE,EAAE,CAAC,KAAK,CAAC,OAAO,GAAG,MAAM,CAAC;EACtC,EAAC;AACD;EACA;EACA;EACA;EACA;EACA;EACA;EACO,MAAM,UAAU,GAAG,CAAC,IAAI,EAAE,KAAK,KAAK;AAC3C;EACA,IAAI,QAAQ,CAAC,aAAa,CAAC,aAAa,CAAC,CAAC,SAAS,GAAG,CAAC;AACvD;AACA,oFAAoF,EAAE,IAAI,CAAC;AAC3F,4FAA4F,EAAE,KAAK,CAAC;AACpG,UAAU,CAAC,CAAC;EACZ,EAAC;AACD;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACO,MAAM,IAAI,GAAG,CAAC,IAAI,KAAK;EAC9B;EACA,IAAI,IAAI,SAAS,GAAG,IAAI,eAAe,CAAC,MAAM,CAAC,QAAQ,CAAC,MAAM,CAAC,CAAC;EAChE,IAAI,IAAI,GAAG,GAAG,SAAS,CAAC,GAAG,CAAC,KAAK,CAAC,GAAG,SAAS,CAAC,GAAG,CAAC,KAAK,CAAC,GAAG,EAAE,CAAC;AAC/D;EACA,IAAI,IAAI,OAAO,GAAG,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC,GAAG,OAAO,CAAC,GAAG,GAAG,OAAO,CAAC,GAAG,CAAC;AACtE;EACA,IAAI,OAAO,IAAI,GAAG,OAAO,CAAC;EAC1B,EAAC;AAeD;EACA;EACA;EACA;EACA;EACA;EACA;EACA,CAAQ,MAAM,OAAO,GAAG,MAAM;EAC9B;EACA,IAAI,IAAI,SAAS,GAAG,IAAI,eAAe,CAAC,MAAM,CAAC,QAAQ,CAAC,MAAM,CAAC,CAAC;EAChE,IAAI,IAAI,EAAE,GAAG,SAAS,CAAC,GAAG,CAAC,KAAK,CAAC,GAAG,SAAS,CAAC,GAAG,CAAC,KAAK,CAAC,GAAG,EAAE,CAAC;AAC9D;EACA,IAAI,OAAO,EAAE,CAAC;EACd,EAAC;AACD;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA,CAAQ,MAAM,SAAS,GAAG,CAAC,IAAI,EAAE,KAAK,EAAE,IAAI,KAAK;AACjD;EACA,IAAI,IAAI,OAAO,GAAG,EAAE,CAAC;EACrB,IAAI,IAAI,IAAI,EAAE;EACd,QAAQ,IAAI,IAAI,GAAG,IAAI,IAAI,EAAE,CAAC;EAC9B,QAAQ,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,OAAO,EAAE,IAAI,IAAI,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,IAAI,CAAC,CAAC,CAAC;EACpE,QAAQ,OAAO,GAAG,WAAW,GAAG,IAAI,CAAC,WAAW,EAAE,CAAC;EACnD,KAAK;EACL,IAAI,QAAQ,CAAC,MAAM,GAAG,IAAI,GAAG,GAAG,IAAI,MAAM,CAAC,KAAK,CAAC,IAAI,EAAE,CAAC,GAAG,OAAO,GAAG,8BAA8B,CAAC;EACpG,EAAC;AACD;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACO,MAAM,SAAS,GAAG,CAAC,KAAK,KAAK;AACpC;EACA,IAAI,IAAI,IAAI,GAAG,KAAK,GAAG,GAAG,CAAC;EAC3B,IAAI,IAAI,aAAa,GAAG,kBAAkB,CAAC,QAAQ,CAAC,MAAM,CAAC,CAAC;EAC5D,IAAI,IAAI,EAAE,GAAG,aAAa,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;EACtC,IAAI,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,EAAE,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;EACxC,QAAQ,IAAI,CAAC,GAAG,EAAE,CAAC,CAAC,CAAC,CAAC;EACtB,QAAQ,OAAO,CAAC,CAAC,MAAM,CAAC,CAAC,CAAC,IAAI,GAAG,EAAE;EACnC,YAAY,CAAC,GAAG,CAAC,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC;EAC/B,SAAS;EACT,QAAQ,IAAI,CAAC,CAAC,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE;EAClC,YAAY,OAAO,CAAC,CAAC,SAAS,CAAC,IAAI,CAAC,MAAM,EAAE,CAAC,CAAC,MAAM,CAAC,CAAC;EACtD,SAAS;EACT,KAAK;EACL,IAAI,OAAO,EAAE,CAAC;EACd,EAAC;AACD;EACA;EACA;EACA;EACA;EACA;EACA,CAAQ,MAAM,WAAW,GAAG,MAAM;AAClC;EACA,IAAI,IAAI,OAAO,GAAG,CAAC,YAAY,CAAC,cAAc,CAAC,QAAQ,CAAC,IAAI,YAAY,CAAC,cAAc,CAAC,gBAAgB,CAAC,IAAI,YAAY,CAAC,OAAO,CAAC,gBAAgB,CAAC,GAAG,CAAC,CAAC;EACxJ,IAAI,IAAI,KAAK,GAAG,MAAM,CAAC,QAAQ,CAAC,QAAQ,GAAG,GAAG,GAAG,OAAO,EAAE,GAAG,GAAG,GAAG,SAAS,CAAC,QAAQ,CAAC,CAAC;EACvF,IAAI,GAAG,KAAK,IAAI,SAAS,CAAC,OAAO,CAAC,CAAC,EAAE,OAAO,GAAG,CAAC,CAAC,CAAC,OAAO,CAAC,GAAG,CAAC,SAAS,CAAC,CAAC,EAAE;EAC3E;EACA,IAAI,SAAS,CAAC,OAAO,EAAE,KAAK,EAAE,CAAC,CAAC,CAAC;AACjC;EACA,IAAI,OAAO,OAAO;EAClB,EAAC;AACD;EACA;EACA;EACA;EACA;EACA;EACA,CAAQ,MAAM,OAAO,GAAG;EACxB,IAAI,QAAQ,EAAE,kBAAkB;EAChC,IAAI,cAAc,EAAE,kBAAkB;EACtC,IAAI,eAAe,EAAE,SAAS,GAAG,SAAS,CAAC,gBAAgB,CAAC;EAC5D,IAAI,eAAe,EAAE,SAAS,CAAC,QAAQ,CAAC,GAAG,SAAS,CAAC,QAAQ,CAAC,GAAG,IAAI;EACrE,IAAI,eAAe,EAAE,WAAW,EAAE;EAClC,IAAI,cAAc,EAAE,SAAS,CAAC,cAAc,CAAC;EAC7C,IAAI,YAAY,EAAE,OAAO,EAAE;EAC3B,EAAC;AACD;EACA;EACA;EACA;EACA;EACA;EACA,CAAQ,MAAM,aAAa,GAAG,CAAC,IAAI,KAAK;AACxC;EACA;EACA,IAAI,OAAO,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC;AACtB;EACA;EACA,IAAI,GAAG,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;EACxB;EACA;EACA,QAAQ,IAAI,GAAG,GAAG,IAAI,CAAC;EACvB,QAAQ,GAAG,EAAE,GAAG,GAAG,IAAI,CAAC,SAAS,CAAC,GAAG,CAAC,CAAC,EAAE,MAAM,CAAC,CAAC,GAAG;AACpD;EACA,QAAQ,IAAI,MAAM,GAAG,IAAI,eAAe,EAAE,CAAC;EAC3C,QAAQ,MAAM,CAAC,MAAM,CAAC,KAAK,EAAE,QAAQ,CAAC,CAAC;EACvC,QAAQ,MAAM,CAAC,MAAM,CAAC,KAAK,EAAE,OAAO,EAAE,CAAC,CAAC;EACxC,QAAQ,MAAM,CAAC,MAAM,CAAC,OAAO,EAAE,SAAS,CAAC,cAAc,CAAC,CAAC,CAAC;EAC1D,QAAQ,MAAM,CAAC,MAAM,CAAC,MAAM,EAAE,GAAG,CAAC,CAAC;EACnC;EACA;EACA,QAAQ,KAAK,CAAC,oCAAoC,EAAE,EAAE,MAAM,EAAE,MAAM,EAAE,OAAO,EAAE,EAAE,QAAQ,EAAE,kBAAkB,EAAE,cAAc,EAAE,mCAAmC,GAAG,EAAE,IAAI,EAAE,MAAM,EAAE,CAAC,CAAC;AACvL;EACA,QAAQ,KAAK,CAAC,iCAAiC,CAAC,CAAC;EACjD,QAAQ,OAAO;EACf,KAAK;EACL;EACA;EACA,IAAI,OAAO,IAAI,CAAC,IAAI;AACpB;EACA;EACA,QAAQ,KAAK,GAAG;AAChB;EACA;EACA,YAAY,GAAG,MAAM,CAAC,QAAQ,CAAC,IAAI,CAAC,OAAO,CAAC,WAAW,CAAC,EAAE,CAAC,CAAC,CAAC;AAC7D;EACA,gBAAgB,KAAK,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;EACnC,gBAAgB,OAAO;EACvB,aAAa;AACb;EACA;EACA,YAAY,QAAQ,CAAC,IAAI,CAAC,uDAAuD,CAAC,MAAM,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC,MAAM;EAC9G;EACA;EACA,QAAQ;AACR;EACA,YAAY,KAAK,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;EAC/B,YAAY,MAAM;EAClB,KAAK;EACL,EAAC;AACD;EACA;EACA;EACA;EACA;EACA;EACO,MAAM,eAAe,GAAG,CAAC,IAAI,KAAK;AACzC;EACA,IAAI,IAAI,IAAI,GAAG,mCAAmC,CAAC;EACnD,IAAI,IAAI,IAAI,EAAE,IAAI,IAAI,CAAC;EACvB;EACA,QAAQ,GAAG,OAAO,EAAE,CAAC,IAAI,CAAC,KAAK,WAAW,CAAC;AAC3C;EACA,YAAY,IAAI,IAAI,CAAC,4BAA4B,GAAG,EAAE,CAAC,IAAI,EAAE,KAAK,CAAC,CAAC;EACpE,SAAS,KAAI;AACb;EACA,YAAY,IAAI,IAAI,CAAC,qCAAqC,GAAG,EAAE,CAAC,IAAI,EAAE,EAAE,GAAG,EAAE,CAAC,IAAI,EAAE,SAAS,CAAC,CAAC;EAC/F,SAAS;EACT,KAAK;EACL,IAAI,IAAI,IAAI,OAAO,CAAC;EACpB;EACA,IAAI,QAAQ,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC,SAAS,GAAG,IAAI,CAAC;EACnD,EAAC;AACD;EACA;EACA;EACA;EACA;EACA;EACA;EACO,MAAMC,SAAO,GAAG,CAAC,GAAG,EAAE,EAAE,KAAK;AACpC;EACA,IAAI,GAAG,QAAQ,CAAC,aAAa,CAAC,GAAG,CAAC,EAAE,KAAK,IAAI,CAAC,IAAI,QAAQ,CAAC,gBAAgB,CAAC,GAAG,CAAC,EAAE;AAClF;EACA,QAAQ,CAAC,CAAC,mBAAmB,CAAC,OAAO,EAAE,EAAE,EAAE,IAAI,CAAC,CAAC;EACjD,QAAQ,CAAC,CAAC,gBAAgB,CAAC,OAAO,EAAE,EAAE,EAAE,IAAI,CAAC,CAAC;EAC9C,KAAK;EACL,EAAC;AACD;EACA;EACA;EACA;EACA;EACA;EACA;EACO,MAAM,OAAO,GAAG,CAAC,GAAG,EAAE,EAAE,KAAK;AACpC;EACA,IAAI,GAAG,QAAQ,CAAC,aAAa,CAAC,GAAG,CAAC,EAAE,KAAK,IAAI,CAAC,IAAI,QAAQ,CAAC,gBAAgB,CAAC,GAAG,CAAC,EAAE;AAClF;EACA,QAAQ,CAAC,CAAC,mBAAmB,CAAC,OAAO,EAAE,EAAE,EAAE,IAAI,CAAC,CAAC;EACjD,QAAQ,CAAC,CAAC,gBAAgB,CAAC,OAAO,EAAE,EAAE,EAAE,IAAI,CAAC,CAAC;EAC9C,KAAK;EACL,EAAC;AACD;EACA;EACA;EACA;EACA;EACA;EACA;EACO,MAAM,QAAQ,GAAG,CAAC,GAAG,EAAE,EAAE,KAAK;AACrC;EACA,IAAI,GAAG,QAAQ,CAAC,aAAa,CAAC,GAAG,CAAC,EAAE,KAAK,IAAI,CAAC,IAAI,QAAQ,CAAC,gBAAgB,CAAC,GAAG,CAAC,EAAE;AAClF;EACA,QAAQ,CAAC,CAAC,mBAAmB,CAAC,QAAQ,EAAE,EAAE,EAAE,IAAI,CAAC,CAAC;EAClD,QAAQ,CAAC,CAAC,gBAAgB,CAAC,QAAQ,EAAE,EAAE,EAAE,IAAI,CAAC,CAAC;EAC/C,KAAK;EACL,EAAC;AAiBD;EACA;EACA;EACA;EACA;EACA;EACA,CAAQ,MAAM,aAAa,GAAG,CAAC,IAAI,KAAK;AACxC;EACA;EACA,CAAC,IAAI,GAAG,GAAG,IAAI,UAAU,CAAC,OAAO,EAAE;EACnC,EAAE,OAAO,EAAE,IAAI;EACf,EAAE,UAAU,EAAE,IAAI;EAClB,EAAE,IAAI,EAAE,MAAM;EACd,EAAE,CAAC,CAAC;AACJ;EACA;EACA,CAAC,CAAC,IAAI,CAAC,aAAa,CAAC,GAAG,CAAC,CAAC;EAC1B,CAAC,CAAC;AAqIF;EACA;EACA;EACA;EACA;EACA;EACA,CAAQ,MAAM,KAAK,GAAG,CAAC,IAAI,KAAK;AAChC;EACA;EACA,IAAI,GAAG,CAAC,QAAQ,CAAC,aAAa,CAAC,QAAQ,CAAC,CAAC;AACzC;EACA,QAAQ,IAAI,IAAI,GAAG,CAAC;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAc,CAAC,CAAC;EAChB,QAAQ,GAAG,QAAQ,CAAC,aAAa,CAAC,YAAY,CAAC,EAAE,QAAQ,CAAC,aAAa,CAAC,YAAY,CAAC,CAAC,kBAAkB,CAAC,UAAU,EAAE,IAAI,CAAC,CAAC;EAC3H,KAAK;AACL;EACA,IAAI,IAAI,KAAK,GAAG,IAAI,SAAS,CAAC,KAAK,CAAC,QAAQ,CAAC,aAAa,CAAC,QAAQ,CAAC,CAAC,CAAC;EACtE,IAAI,QAAQ,CAAC,aAAa,CAAC,oBAAoB,CAAC,CAAC,SAAS,GAAG,IAAI,CAAC;EAClE,IAAI,KAAK,CAAC,IAAI,EAAE,CAAC;EACjB;;EC1pBO,IAAMC,EAAE,GAAG,SAALA,EAAK,CAACC,GAAD,EAAS;IAEvB,OAAO,CAAC,EAAGA,GAAAA,GAAJ,EAASC,MAAT,GAAkB,CAAlB,GAAsB,GAAA,GAAID,GAA1B,GAAgCA,GAAvC,CAAA;EACH,CAHM,CAAA;EAuCA,IAAME,aAAa,GAAG,SAAhBA,aAAgB,GAAM;IAE/B,IAAIC,SAAS,GAAG,IAAIC,eAAJ,CAAoBC,MAAM,CAACC,QAAP,CAAgBC,MAApC,CAAhB,CAAA;EACA,EAAA,IAAIC,IAAI,GAAGL,SAAS,CAACM,GAAV,CAAc,MAAd,CAAwBN,GAAAA,SAAS,CAACM,GAAV,CAAc,MAAd,CAAxB,GAAgD,CAA3D,CAAA;IAEA,OAAOC,QAAQ,CAACF,IAAD,CAAf,CAAA;EACH,CANM,CAAA;EAyFC,IAAMG,WAAW,GAAG,SAAdA,WAAc,CAASC,KAAT,EAAgBC,KAAhB,EAAuB;EAE/CA,EAAAA,KAAK,GAAGC,UAAU,CAACD,KAAD,CAAlB,CAAA;EAEAA,EAAAA,KAAK,GAAG,CAACE,IAAI,CAACC,KAAL,CAAWC,UAAU,CAACJ,KAAD,CAAV,GAAoB,GAA/B,CAAoC,GAAA,GAArC,EAA0CK,OAA1C,CAAkD,CAAlD,CAAR,CAAA;;EAEA,EAAA,QAAON,KAAK,CAACO,KAAN,CAAYC,QAAZ,CAAqBC,iBAA5B;EACI,IAAA,KAAK,MAAL;QAAaR,KAAK,GAAGD,KAAK,CAACO,KAAN,CAAYC,QAAZ,CAAqBE,aAArB,GAAqCT,KAA7C,CAAA;EAAoD,MAAA,MAAA;;EACjE,IAAA,KAAK,OAAL;QAAcA,KAAK,GAAGA,KAAK,GAAGD,KAAK,CAACO,KAAN,CAAYC,QAAZ,CAAqBE,aAArC,CAAA;EAAoD,MAAA,MAAA;EAFtE,GAAA;;EAKA,EAAA,OAAOT,KAAP,CAAA;EACH,CAZO,CAAA;EAcD,IAAMC,UAAU,GAAG,SAAbA,UAAa,CAASD,KAAT,EAAgB;EAEtCA,EAAAA,KAAK,GAAGA,KAAK,GAAGA,KAAH,GAAW,CAAxB,CAAA;EACAA,EAAAA,KAAK,GAAGI,UAAU,CAACJ,KAAD,CAAlB,CAAA;IACAA,KAAK,GAAGE,IAAI,CAACC,KAAL,CAAWH,KAAK,GAAG,GAAnB,CAAA,GAA0B,GAAlC,CAAA;EACA,EAAA,OAAOA,KAAP,CAAA;EACH,CANM,CAAA;EA0BA,IAAMU,WAAW,GAAG,SAAdA,WAAc,CAACC,GAAD,EAAMC,KAAN,EAAgB;EAEvC,EAAA,IAAG,CAACC,QAAQ,CAACC,aAAT,CAAuBH,GAAvB,CAAJ,EAAiC,OAAA;IAEjCE,QAAQ,CAACC,aAAT,CAAuBH,GAAvB,CAAA,CAA4BI,gBAA5B,CAA6C,UAA7C,EAAyD,UAACC,CAAD,EAAO;MAI5D,IAAI,CAACJ,KAAK,CAACK,QAAN,CAAeD,CAAC,CAACE,KAAjB,CAAD,IAA4BC,KAAK,CAACC,MAAM,CAACC,YAAP,CAAoBL,CAAC,CAACE,KAAtB,CAAD,CAAlC,IAAqEF,CAAC,CAACE,KAAF,IAAW,EAAhF,IAAuFL,QAAQ,CAACC,aAAT,CAAuBH,GAAvB,CAAA,CAA4BW,KAA5B,CAAkCL,QAAlC,CAA2CG,MAAM,CAACC,YAAP,CAAoBL,CAAC,CAACE,KAAtB,CAA3C,CAAA,IAA4EN,KAAK,CAACK,QAAN,CAAeD,CAAC,CAACE,KAAjB,CAAtK,EAA+L;EAG3LF,MAAAA,CAAC,CAACO,cAAF,EAAA,CAAA;EACA,MAAA,OAAO,KAAP,CAAA;EACH,KAAA;KATL,CAAA,CAAA;EAWH,CAfM,CAAA;EAoCA,IAAMtC,OAAO,GAAG,SAAVA,OAAU,CAAC0B,GAAD,EAAMa,EAAN,EAAa;EAGhC,EAAA,IAAGX,QAAQ,CAACC,aAAT,CAAuBH,GAAvB,CAAH,EAAA;EAAA,IAAA,IAAA,UAAA,GAAA,0BAAA,CAA8CE,QAAQ,CAACY,gBAAT,CAA0Bd,GAA1B,CAA9C,CAAA;EAAA,QAAA,MAAA,CAAA;;EAAA,IAAA,IAAA;QAAgC,KAA8C,UAAA,CAAA,CAAA,EAAA,EAAA,CAAA,CAAA,MAAA,GAAA,UAAA,CAAA,CAAA,EAAA,EAAA,IAAA,GAAA;EAAA,QAAA,IAArCK,CAAqC,GAAA,MAAA,CAAA,KAAA,CAAA;EAE1EA,QAAAA,CAAC,CAACU,mBAAF,CAAsB,OAAtB,EAA+BF,EAA/B,EAAmC,IAAnC,CAAA,CAAA;EACAR,QAAAA,CAAC,CAACD,gBAAF,CAAmB,OAAnB,EAA4BS,EAA5B,EAAgC,IAAhC,CAAA,CAAA;EACH,OAAA;EAJD,KAAA,CAAA,OAAA,GAAA,EAAA;EAAA,MAAA,UAAA,CAAA,CAAA,CAAA,GAAA,CAAA,CAAA;EAAA,KAAA,SAAA;EAAA,MAAA,UAAA,CAAA,CAAA,EAAA,CAAA;EAAA,KAAA;EAAA,GAAA;EAKH,CARM,CAAA;EAWA,IAAMG,gBAAgB,GAAG,SAAnBA,gBAAmB,CAAC3C,EAAD,EAAK4C,GAAL,EAAUC,IAAV,EAAmB;EAE/CD,EAAAA,GAAG,GAAG/B,QAAQ,CAAC+B,GAAD,CAAd,CAAA;EACAC,EAAAA,IAAI,GAAGhC,QAAQ,CAACgC,IAAD,CAAf,CAAA;EAGA,EAAA,IAAIC,IAAI,GAAGF,GAAG,GAAGC,IAAjB,CAAA;IACA,IAAGC,IAAI,GAAG,EAAV,EAAc,OAAO9C,EAAE,CAAC,aAAD,CAAT,CAAA;EACd,EAAA,IAAG8C,IAAI,GAAG,IAAV,EAAgB,OAAOjC,QAAQ,CAACiC,IAAI,GAAG,EAAR,CAAR,GAAsB,GAAtB,GAA4B9C,EAAE,CAAC,aAAD,CAArC,CAAA;EAChB,EAAA,IAAG8C,IAAI,GAAG,KAAV,EAAiB,OAAOjC,QAAQ,CAACiC,IAAI,GAAG,EAAP,GAAY,EAAb,CAAR,GAA2B,GAA3B,GAAiC9C,EAAE,CAAC,WAAD,CAA1C,CAAA;IAGjB,IAAI+C,CAAC,GAAG,IAAIC,IAAJ,CAASH,IAAI,GAAG,IAAhB,CAAR,CAAA;EACA,EAAA,IAAII,MAAM,GAAG,CAAEjD,EAAE,CAAC,KAAD,CAAJ,EAAaA,EAAE,CAAC,KAAD,CAAf,EAAwBA,EAAE,CAAC,KAAD,CAA1B,EAAmCA,EAAE,CAAC,KAAD,CAArC,EAA8CA,EAAE,CAAC,KAAD,CAAhD,EAAyDA,EAAE,CAAC,KAAD,CAA3D,EAAoEA,EAAE,CAAC,KAAD,CAAtE,EAA+EA,EAAE,CAAC,KAAD,CAAjF,EAA0FA,EAAE,CAAC,KAAD,CAA5F,EAAqGA,EAAE,CAAC,KAAD,CAAvG,EAAgHA,EAAE,CAAC,KAAD,CAAlH,EAA2HA,EAAE,CAAC,KAAD,CAA7H,CAAb,CAAA;EACA,EAAA,IAAIkD,IAAI,GAAGH,CAAC,CAACI,WAAF,EAAX,CAAA;IACA,IAAIC,KAAK,GAAGH,MAAM,CAACF,CAAC,CAACM,QAAF,EAAD,CAAlB,CAAA;EACA,EAAA,IAAIC,IAAI,GAAGP,CAAC,CAACQ,OAAF,EAAX,CAAA;EACA,EAAWR,CAAC,CAACS,QAAF,GAAX;EACA,EAAUT,CAAC,CAACU,UAAF,GAAV;EACA,EAAUV,CAAC,CAACW,UAAF,GAAV;IACA,IAAIb,IAAI,GAAGS,IAAI,GAAG,GAAP,GAAaF,KAAb,GAAqB,GAArB,GAA2BF,IAAtC,CAAA;EACA,EAAA,OAAOL,IAAP,CAAA;EACH,CAtBM,CAAA;EAwBA,IAAMc,eAAe,GAAG,SAAlBA,eAAkB,CAAC5C,KAAD,EAAQ6C,OAAR,EAAoB;IAE/C,IAAIC,SAAS,GAAG,EAAhB,CAAA;EACA,EAAA,IAAA,OAAA,CAAUD,OAAO,CAACE,UAAR,KAAuB,WAAjC,CAAA,EACA,KAAI,IAAIC,CAAR,IAAaH,OAAO,CAACE,UAArB,EAAgC;MAG5B,IAAIE,IAAI,GAAG,EAAX,CAAA;EACA,IAAA,IAAGJ,OAAO,CAACE,UAAR,CAAmBC,CAAnB,CAAA,CAAsBC,IAAtB,IAA4B,UAA/B,EAA2CA,IAAI,GAAG,OAAP,CAAA;EAC3C,IAAA,IAAGJ,OAAO,CAACE,UAAR,CAAmBC,CAAnB,CAAA,CAAsBC,IAAtB,IAA4B,OAA/B,EAA2CA,IAAI,GAAG,OAAP,CAAA;EAG3CH,IAAAA,SAAS,IAAI;AACrB,YADqB,GACNI,MAAM,CAACL,OAAO,CAACE,UAAR,CAAmBC,CAAnB,CAAsBG,CAAAA,KAAvB,CADA,IACiCN,OAAO,CAACE,UAAR,CAAmBC,CAAnB,CAAsBI,CAAAA,QAAtB,IAAkC,GAAlC,GAAwC,qBAAsBF,GAAAA,MAAM,CAAC,UAAD,CAA5B,GAAyC,SAAjF,GAA2F,EAD5H,CACgI,GAAA;AACrJ,wBAFqB,GAEID,IAFJ,GAES,KAFtB,CAAA;;MAKA,KAAI,IAAII,CAAR,IAAaR,OAAO,CAACE,UAAR,CAAmBC,CAAnB,CAAsBM,CAAAA,IAAnC,EAAwC;QAEpC,IAAIC,OAAO,GAAG,KAAd,CAAA;QAKAV,OAAO,CAACE,UAAR,CAAmBC,CAAnB,CAAA,CAAsBM,IAAtB,CAA2BD,CAA3B,CAA8B,CAAA,OAA9B,CAAyCnD,GAAAA,UAAU,CAAC2C,OAAO,CAACE,UAAR,CAAmBC,CAAnB,CAAA,CAAsBM,IAAtB,CAA2BD,CAA3B,CAAA,CAA8B,OAA9B,CAAD,CAAnD,CAAA;;EAEA,MAAA,QAAOJ,IAAP;EACI,QAAA,KAAK,OAAL;EAEAH,UAAAA,SAAS,IAAI;AAC7B;AACA,+DAF6B,GAEmCD,OAAO,CAACE,UAAR,CAAmBC,CAAnB,CAAsBI,CAAAA,QAFzD,GAEkE,iBAFlE,GAEoFJ,CAFpF,GAEsF,gBAFtF,GAEuGK,CAFvG,GAEyG,gBAFzG,GAE0HR,OAAO,CAACE,UAAR,CAAmBC,CAAnB,CAAsBM,CAAAA,IAAtB,CAA2BD,CAA3B,CAA8B,CAAA,OAA9B,CAF1H,GAEiK,iBAFjK,GAEmLpE,EAAE,CAAC4D,OAAO,CAACE,UAAR,CAAmBC,CAAnB,CAAA,CAAsBG,KAAvB,CAFrL,GAEmN,gBAFnN,GAEoON,OAAO,CAACE,UAAR,CAAmBC,CAAnB,CAAA,CAAsBM,IAAtB,CAA2BD,CAA3B,CAAA,CAA8B,OAA9B,CAFpO,GAE2Q,IAF3Q,IAEiRE,OAAO,GAAC,mBAAD,GAAqB,EAF7S,CAEiT,GAAA;AAC9U;AACA;AACA;AACA;AACA;AACA;AACA,+BAT6B,GASGL,MAAM,CAACL,OAAO,CAACE,UAAR,CAAmBC,CAAnB,CAAsBM,CAAAA,IAAtB,CAA2BD,CAA3B,CAAA,CAA8B,OAA9B,CAAD,CATT,GASkD;AAC/E,8CAV6B,GAUkBtD,WAAW,CAACC,KAAD,EAAQ6C,OAAO,CAACE,UAAR,CAAmBC,CAAnB,CAAA,CAAsBM,IAAtB,CAA2BD,CAA3B,EAA8B,OAA9B,CAAR,CAV7B,GAU6E;AAC1G,6BAXgB,CAAA;EAaA,UAAA,MAAA;;EACA,QAAA,KAAK,OAAL;EAEAP,UAAAA,SAAS,IAAI;AAC7B;AACA,4DAF6B,GAEgCD,OAAO,CAACE,UAAR,CAAmBC,CAAnB,CAAA,CAAsBI,QAFtD,GAE+D,iBAF/D,GAEiFJ,CAFjF,GAEmF,eAFnF,GAEmGA,CAFnG,GAEqG,gBAFrG,GAEsHK,CAFtH,GAEwH,gBAFxH,GAEyIR,OAAO,CAACE,UAAR,CAAmBC,CAAnB,CAAsBM,CAAAA,IAAtB,CAA2BD,CAA3B,EAA8B,OAA9B,CAFzI,GAEgL,iBAFhL,GAEkMpE,EAAE,CAAC4D,OAAO,CAACE,UAAR,CAAmBC,CAAnB,CAAA,CAAsBG,KAAvB,CAFpM,GAEkO,gBAFlO,GAEmPN,OAAO,CAACE,UAAR,CAAmBC,CAAnB,CAAsBM,CAAAA,IAAtB,CAA2BD,CAA3B,EAA8B,OAA9B,CAFnP,GAE0R,IAF1R,IAEgSE,OAAO,GAAC,mBAAD,GAAqB,EAF5T,CAEgU,GAAA;AAC7V,+BAH6B,GAGGL,MAAM,CAACL,OAAO,CAACE,UAAR,CAAmBC,CAAnB,CAAsBM,CAAAA,IAAtB,CAA2BD,CAA3B,CAAA,CAA8B,OAA9B,CAAD,CAHT,GAGkD;AAC/E,8CAJ6B,GAIkBtD,WAAW,CAACC,KAAD,EAAQ6C,OAAO,CAACE,UAAR,CAAmBC,CAAnB,CAAA,CAAsBM,IAAtB,CAA2BD,CAA3B,EAA8B,OAA9B,CAAR,CAJ7B,GAI6E;AAC1G,6BALgB,CAAA;EAOA,UAAA,MAAA;EA1BJ,OAAA;EA4BH,KAAA;;EAEDP,IAAAA,SAAS,IAAI,QAAb,CAAA;EACH,GAAA;EAED,EAAA,OAAOA,SAAP,CAAA;EACH,CA5DM,CAAA;EA8DA,IAAMU,QAAM,GAAG,SAATA,MAAS,CAACC,OAAD,EAAa;EAE/B,EAAA,OAAOA,OAAO,CAACC,OAAR,CAAgB,IAAhB,EAAsB,OAAtB,CAAA,CACAA,OADA,CACQ,IADR,EACc,MADd,CAEAA,CAAAA,OAFA,CAEQ,IAFR,EAEc,MAFd,CAGAA,CAAAA,OAHA,CAGQ,IAHR,EAGc,QAHd,CAAA,CAIAA,OAJA,CAIQ,IAJR,EAIc,OAJd,CAAP,CAAA;EAMH,CARM,CAAA;EAUA,IAAMC,QAAQ,GAAG,SAAXA,QAAW,CAACF,OAAD,EAAa;IAEjCA,OAAO,GAAGA,OAAO,CAACC,OAAR,CAAgB,OAAhB,EAA0B,GAA1B,CAAV,CAAA;IACAD,OAAO,GAAGA,OAAO,CAACC,OAAR,CAAgB,OAAhB,EAA0B,GAA1B,CAAV,CAAA;IACAD,OAAO,GAAGA,OAAO,CAACC,OAAR,CAAgB,SAAhB,EAA4B,IAA5B,CAAV,CAAA;IACAD,OAAO,GAAGA,OAAO,CAACC,OAAR,CAAgB,QAAhB,EAA2B,IAA3B,CAAV,CAAA;IACAD,OAAO,GAAGA,OAAO,CAACC,OAAR,CAAgB,QAAhB,EAA2B,GAA3B,CAAV,CAAA;EACA,EAAA,OAAOD,OAAP,CAAA;EACH,CARM,CAAA;EAUA,IAAMG,gBAAgB,GAAG,SAAnBA,gBAAmB,CAAC5D,KAAD,EAAQ6D,MAAR,EAAgBC,EAAhB,EAAuB;IAGnDC,KAAK,CAAC,wCAAD,EAA2C;EAC5CC,IAAAA,MAAM,EAAE,MADoC;EAE5CC,IAAAA,OAAO,EAAEA,OAFmC;EAG5CC,IAAAA,IAAI,EAAEC,IAAI,CAACC,SAAL,CAAe;EACjBC,MAAAA,KAAK,EAAE;EACHC,QAAAA,OAAO,EAAE;EACLrB,UAAAA,IAAI,EAAQ,SADP;EAELY,UAAAA,MAAM,EAAMA,MAAAA;EAFP,SAAA;EADN,OAAA;OADL,CAAA;EAHsC,GAA3C,CAAL,CAYCU,IAZD,CAYM,UAAAC,QAAQ,EAAA;MAAA,OAAIA,QAAQ,CAACC,IAAT,EAAJ,CAAA;EAAA,GAZd,CAaCF,CAAAA,IAbD,CAaM,UAAAC,QAAQ,EAAI;MAEd,IAAGA,QAAQ,CAACE,OAAZ,EAAoB;QAGhBZ,EAAE,CAACU,QAAD,CAAF,CAAA;EAGAG,MAAAA,mBAAmB,CAAC3E,KAAD,EAAQwE,QAAQ,CAACI,QAAjB,CAAnB,CAAA;EAEH,KAGA;EACJ,GA3BD,CA4BO,CAAA,OAAA,CAAA,CAAA,UAAAC,KAAK,EAAI,EA5BhB,CAAA,CAAA;EA8BH,CAjCM,CAAA;EAmCA,IAAMC,QAAQ,GAAG,SAAXA,QAAW,GAAM;EAE1B,EAAA,IAAMC,GAAG,GAAGC,SAAS,CAACC,SAAV,CAAoBC,WAApB,EAAZ,CAAA;IACA,OACIH,GAAG,CAACI,KAAJ,CAAU,SAAV,KAAwBJ,GAAG,CAACI,KAAJ,CAAU,OAAV,CAAxB,IAA8CJ,GAAG,CAACI,KAAJ,CAAU,OAAV,CAA9C,IAAoEJ,GAAG,CAACI,KAAJ,CAAU,UAAV,CADxE,CAAA;EAGH,CANM,CAAA;EASA,IAAMC,SAAS,GAAG,SAAZA,SAAY,CAACpF,KAAD,EAAQqF,GAAR,EAAgB;EAIrCrF,EAAAA,KAAK,CAACO,KAAN,CAAY6E,SAAZ,CAAsBE,CAAtB,GAA0B,CAA1B,CAAA;EAEA,EAAA,IAAGtF,KAAK,CAACO,KAAN,CAAY6E,SAAZ,CAAsBG,KAAzB,EAAgCC,aAAa,CAACxF,KAAK,CAACO,KAAN,CAAY6E,SAAZ,CAAsBG,KAAvB,CAAb,CAAA;EAEhC,EAAA,IAAGvF,KAAK,CAACO,KAAN,CAAY6E,SAAZ,CAAsBK,OAAzB,EAAkCzF,KAAK,CAACO,KAAN,CAAY6E,SAAZ,CAAsBM,KAAtB,CAA4BC,IAA5B,EAAA,CAAA;;IAIlC,IAAG;EACC,IAAA,IAAG3F,KAAK,CAACO,KAAN,CAAY6E,SAAZ,CAAsBK,OAAtB,IAAiCX,QAAQ,EAA5C,EAAgDrF,MAAM,CAACuF,SAAP,CAAiBY,OAAjB,CAAyB,GAAzB,CAAA,CAAA;KADpD,CAEC,gBAAK,EAEL;;IAED,IAAGP,GAAG,IAAE,CAAR,EAAW,OAAA;IAEXrF,KAAK,CAACO,KAAN,CAAY6E,SAAZ,CAAsBG,KAAtB,GAA8BM,WAAW,CAAC,YAAM;MAE5C,IAAG,CAAC7F,KAAK,CAACO,KAAN,CAAY6E,SAAZ,CAAsBK,OAA1B,EAAmC,OAAA;;EAEnCzF,IAAAA,KAAK,CAACO,KAAN,CAAY6E,SAAZ,CAAsBM,KAAtB,CAA4BC,IAA5B,EAAA,CAAA;;MAEA,IAAG3F,KAAK,CAACO,KAAN,CAAY6E,SAAZ,CAAsBE,CAAtB,GAA0BD,GAA7B,EAAiC;QAAEG,aAAa,CAACxF,KAAK,CAACO,KAAN,CAAY6E,SAAZ,CAAsBG,KAAvB,CAAb,CAAA;EAA4C,KAAA;;EAE/EvF,IAAAA,KAAK,CAACO,KAAN,CAAY6E,SAAZ,CAAsBE,CAAtB,IAA2B,CAA3B,CAAA;KARqC,EAUtC,IAVsC,CAAzC,CAAA;EAaH,CAjCM,CAAA;EAmCA,IAAMX,mBAAmB,GAAG,SAAtBA,mBAAsB,CAAC3E,KAAD,EAAQ4E,QAAR,EAAqB;IAEpD,IAAIkB,IAAI,GAAG,EAAX,CAAA;IAEA,IAAIH,IAAI,GAAG,KAAX,CAAA;EAGAf,EAAAA,QAAQ,CAACmB,OAAT,CAAiB,UAAAC,GAAG,EAAI;EAEpB,IAAA,IAAG,CAAChG,KAAK,CAACO,KAAN,CAAY6E,SAAZ,CAAsBa,IAAtB,CAA2B/E,QAA3B,CAAoC8E,GAAG,CAACE,GAAxC,CAAJ,EAAiD;QAAElG,KAAK,CAACO,KAAN,CAAY6E,SAAZ,CAAsBa,IAAtB,CAA2BE,IAA3B,CAAgCH,GAAG,CAACE,GAApC,CAAA,CAAA;;EAA0CP,MAAAA,IAAI,GAAG,IAAP,CAAA;EAAc,KAAA;;EAE3G,IAAA,IAAG,CAAC7E,QAAQ,CAACC,aAAT,CAAuB,iCAAA,GAAkCiF,GAAG,CAACE,GAAtC,GAA0C,IAAjE,CAAJ,EAA2E;EAEvEJ,MAAAA,IAAI,uDAEuBE,GAAG,CAACI,KAF3B,EAAA,0DAAA,CAAA,CAAA,MAAA,CAEyFJ,GAAG,CAACE,GAF7F,EASOF,ypBAAAA,CAAAA,CAAAA,MAAAA,CAAAA,GAAG,CAACA,GATX,EAAA,gMAAA,CAAA,CAAA,MAAA,CAYkHA,GAAG,CAACE,GAZtH,EAAJ,kCAAA,CAAA,CAAA;EAcH,KAAA;KApBL,CAAA,CAAA;;EAwBA,EAAA,IAAGP,IAAH,EAAQ;EAEJP,IAAAA,SAAS,CAACpF,KAAD,EAAQ,CAAR,CAAT,CAAA;;EAAqBA,IAAAA,KAAK,CAACqG,OAAN,EAAA,CAAA;EACxB,GAAA;;EAED,EAAA,IAAGvF,QAAQ,CAACC,aAAT,CAAuB,sBAAvB,CAAH,EAAmDD,QAAQ,CAACC,aAAT,CAAuB,sBAAvB,CAAA,CAA+CuF,kBAA/C,CAAkE,YAAlE,EAAgFR,IAAhF,CAAA,CAAA;EAGnD5G,EAAAA,OAAO,CAAC,qBAAD,EAAwB,UAAC+B,CAAD,EAAO;MAGlC8C,KAAK,CAAC,wCAAD,EAA2C;EAC5CC,MAAAA,MAAM,EAAE,MADoC;EAE5CC,MAAAA,OAAO,EAAEA,OAFmC;EAG5CC,MAAAA,IAAI,EAAEC,IAAI,CAACC,SAAL,CAAe;EACjBC,QAAAA,KAAK,EAAE;EACHC,UAAAA,OAAO,EAAE;EACLrB,YAAAA,IAAI,EAAQ,SADP;EAELsD,YAAAA,EAAE,EAAUtF,CAAC,CAACuF,aAAF,CAAgBC,OAAhB,CAAwBF,EAAAA;EAF/B,WAAA;EADN,SAAA;SADL,CAAA;EAHsC,KAA3C,CAAL,CAYChC,IAZD,CAYM,UAAAC,QAAQ,EAAA;QAAA,OAAIA,QAAQ,CAACC,IAAT,EAAJ,CAAA;EAAA,KAZd,CAaCF,CAAAA,IAbD,CAaM,UAAAC,QAAQ,EAAI;EAEd,MAAA,IAAGA,QAAQ,CAACE,OAAZ,EAAoB,CAOnB;EACJ,KAvBD,CAwBO,CAAA,OAAA,CAAA,CAAA,UAAAG,KAAK,EAAI,EAxBhB,CAAA,CAAA;EA0BH,GA7BM,CAAP,CAAA;;EAgCA,EAAA,IAAG/D,QAAQ,CAACC,aAAT,CAAuB,gBAAvB,CAAH,EAAA;EAAA,IAAA,IAAA,UAAA,GAAA,0BAAA,CAA4DD,QAAQ,CAACY,gBAAT,CAA0B,gBAA1B,CAA5D,CAAA;EAAA,QAAA,MAAA,CAAA;;EAAA,IAAA,IAAA;QAA6C,KAA4D,UAAA,CAAA,CAAA,EAAA,EAAA,CAAA,CAAA,MAAA,GAAA,UAAA,CAAA,CAAA,EAAA,EAAA,IAAA,GAAA;EAAA,QAAA,IAAnDgF,EAAmD,GAAA,MAAA,CAAA,KAAA,CAAA;EAErG,QAAA,IAAGA,EAAE,CAACD,OAAH,CAAWE,QAAX,IAAuB,GAA1B,EAA+B,OAAA;EAE/BD,QAAAA,EAAE,CAACD,OAAH,CAAWE,QAAX,GAAsB,CAAtB,CAAA;EAEAD,QAAAA,EAAE,CAAC1F,gBAAH,CAAoB,OAApB,EAA6B,UAACC,CAAD,EAAO;EAEhC,UAAA,IAAIyF,EAAE,GAAG5F,QAAQ,CAACC,aAAT,CAAuB,uBAAwBE,GAAAA,CAAC,CAACuF,aAAF,CAAgBC,OAAhB,CAAwBF,EAAhD,GAAmD,IAA1E,CAAT,CAAA;YAEAK,aAAa,CAACF,EAAD,CAAb,CAAA;EAEH,SAND,EAMG,IANH,CAAA,CAAA;EAOH,OAAA;EAbD,KAAA,CAAA,OAAA,GAAA,EAAA;EAAA,MAAA,UAAA,CAAA,CAAA,CAAA,GAAA,CAAA,CAAA;EAAA,KAAA,SAAA;EAAA,MAAA,UAAA,CAAA,CAAA,EAAA,CAAA;EAAA,KAAA;EAAA,GAAA;EAcH,CArFM,CAAA;EA0IA,IAAMG,eAAe,GAAG,SAAlBA,eAAkB,CAAC7G,KAAD,EAAQ8G,QAAR,EAAkBhD,EAAlB,EAAyB;EAGpD,EAAqBC,KAAK,CAAC,8BAAD,EAAiC;EACvDC,IAAAA,MAAM,EAAE,MAD+C;EAEvDC,IAAAA,OAAO,EAAEA,OAF8C;EAGvDC,IAAAA,IAAI,EAAEC,IAAI,CAACC,SAAL,CAAe;EACjBC,MAAAA,KAAK,EAAE;EACHyC,QAAAA,QAAQ,EAAE;EACN7D,UAAAA,IAAI,EAAQ,MADN;EAEN8D,UAAAA,MAAM,EAAM,GAFN;EAGNC,UAAAA,GAAG,EAAS,mBAHN;EAINT,UAAAA,EAAE,EAAUO,QAJN;EAKNG,UAAAA,MAAM,EAAM;EACRC,YAAAA,KAAK,EAAE,SADC;EAERC,YAAAA,KAAK,EAAE,MAAA;EAFC,WAAA;EALN,SAAA;EADP,OAAA;OADL,CAAA;EAHiD,GAAjC,CAAL,CAkBpB5C,IAlBoB,CAkBf,UAAAC,QAAQ,EAAA;MAAA,OAAIA,QAAQ,CAACC,IAAT,EAAJ,CAAA;EAAA,GAlBO,CAmBpBF,CAAAA,IAnBoB,CAmBf,UAAAC,QAAQ,EAAI;MAEd,IAAIA,QAAQ,CAACE,OAAb,EAAsB;QAElBF,QAAQ,CAACsC,QAAT,CAAkBf,OAAlB,CAA0B,UAAClD,OAAD,EAAUuE,CAAV,EAAgB;UAEtCpH,KAAK,CAACO,KAAN,CAAY8G,WAAZ,CAAwBC,KAAxB,CAA8BnB,IAA9B,CAAmC;EAC/BoB,UAAAA,IAAI,EAAE,EADyB;YAE/BhB,EAAE,EAAE1D,OAAO,CAACqD,GAFmB;EAG/BsB,UAAAA,KAAK,EAAEJ,CAHwB;EAI/BK,UAAAA,IAAI,EAAE,EAJyB;YAK/BxH,KAAK,EAAE4C,OAAO,CAAC5C,KALgB;EAM/ByH,UAAAA,GAAG,EAAE,CAN0B;EAO/BC,UAAAA,KAAK,EAAEzE,MAAM,CAACL,OAAO,CAAC8E,KAAT,CAPkB;EAQ/BxE,UAAAA,KAAK,EAAED,MAAM,CAACL,OAAO,CAACM,KAAT,CARkB;YAS/ByE,KAAK,EAAE/E,OAAO,CAAC5C,KATgB;EAU/BgD,UAAAA,IAAI,EAAE,KAVyB;EAW/BF,UAAAA,UAAU,EAAE,EAAA;WAXhB,CAAA,CAAA;SAFJ,CAAA,CAAA;QAiBAe,EAAE,CAAC9D,KAAD,CAAF,CAAA;EACH,KAAA;KAzCgB,CAAA,CAAA,OAAA,CAAA,CA2Cd,UAAA6E,KAAK,EAAI;MAAEgD,OAAO,CAACC,GAAR,CAAYjD,KAAZ,CAAA,CAAA;MAAoBkD,aAAa,CAAClD,KAAD,CAAb,CAAA;EAAuB,GA3CxC,EAArB;EA4CH,CA/CM;;ECtiBA,IAAMmD,YAAY,GAAG,SAAfA,YAAe,CAAChI,KAAD,EAAQkG,GAAR,EAAajD,IAAb,EAAmBgF,QAAnB,EAA+C;IAAA,IAAlBC,KAAkB,uEAAV,KAAU,CAAA;IAEvE,IAAIC,CAAC,GAAG,EAAR;QAAY7E,IAAI,GAAG,EAAnB;EAAA,MAAuBf,IAAI,GAAG,IAAIN,IAAJ,EAA9B,CAAA;;IACA,IAAGiE,GAAG,IAAE,MAAR,EAAe;EAEXiC,IAAAA,CAAC,GAAG;EACAjC,MAAAA,GAAG,EAAE,MADL;EAEAK,MAAAA,EAAE,EAAE,MAFJ;EAGA6B,MAAAA,OAAO,EAAE,UAHT;EAIAC,MAAAA,IAAI,EAAE,SAJN;EAKAC,MAAAA,GAAG,EAAE,EALL;EAMAhB,MAAAA,KAAK,EAAE,CACH;EACIC,QAAAA,IAAI,EAAE,EADV;EAEIhB,QAAAA,EAAE,EAAE,0CAFR;EAGIiB,QAAAA,KAAK,EAAE,GAHX;EAIIC,QAAAA,IAAI,EAAE,EAJV;EAKIxH,QAAAA,KAAK,EAAE,EALX;EAMIyH,QAAAA,GAAG,EAAE,CANT;EAOIC,QAAAA,KAAK,EAAE,iBAPX;EAQIxE,QAAAA,KAAK,EAAE,MARX;EASIyE,QAAAA,KAAK,EAAE,EATX;EAUI3E,QAAAA,IAAI,EAAE,KAVV;EAWIF,QAAAA,UAAU,EAAE,EAAA;EAXhB,OADG,EAcH;EACIwE,QAAAA,IAAI,EAAE,EADV;EAEIhB,QAAAA,EAAE,EAAE,0CAFR;EAGIiB,QAAAA,KAAK,EAAE,GAHX;EAIIC,QAAAA,IAAI,EAAE,EAJV;EAKIxH,QAAAA,KAAK,EAAE,EALX;EAMIyH,QAAAA,GAAG,EAAE,CANT;EAOIC,QAAAA,KAAK,EAAE,gBAPX;EAQIxE,QAAAA,KAAK,EAAE,MARX;EASIyE,QAAAA,KAAK,EAAE,EATX;EAUI3E,QAAAA,IAAI,EAAE,KAVV;EAWIF,QAAAA,UAAU,EAAE,EAAA;EAXhB,OAdG,EA2BH;UACIwE,IAAI,EAAE,CAAC,OAAD,CADV;EAEIhB,QAAAA,EAAE,EAAE,0CAFR;EAGIiB,QAAAA,KAAK,EAAE,GAHX;EAIIC,QAAAA,IAAI,EAAE,EAJV;EAKIxH,QAAAA,KAAK,EAAE,EALX;EAMIyH,QAAAA,GAAG,EAAE,EANT;EAOIC,QAAAA,KAAK,EAAE,EAPX;EAQIxE,QAAAA,KAAK,EAAE,KARX;EASIyE,QAAAA,KAAK,EAAE,EATX;EAUI3E,QAAAA,IAAI,EAAE,KAVV;EAWIF,QAAAA,UAAU,EAAE,EAAA;EAXhB,OA3BG,EAwCH;UACIwE,IAAI,EAAE,CAAC,OAAD,CADV;EAEIhB,QAAAA,EAAE,EAAE,0CAFR;EAGIiB,QAAAA,KAAK,EAAE,GAHX;EAIIC,QAAAA,IAAI,EAAE,EAJV;EAKIxH,QAAAA,KAAK,EAAE,EALX;EAMIyH,QAAAA,GAAG,EAAE,CANT;EAOIC,QAAAA,KAAK,EAAE,EAPX;EAQIxE,QAAAA,KAAK,EAAE,eARX;EASIyE,QAAAA,KAAK,EAAE,EATX;EAUI3E,QAAAA,IAAI,EAAE,KAVV;EAWIF,QAAAA,UAAU,EAAE,EAAA;EAXhB,OAxCG,EAqDH;UACIwE,IAAI,EAAE,CAAC,OAAD,CADV;EAEIhB,QAAAA,EAAE,EAAE,0CAFR;EAGIiB,QAAAA,KAAK,EAAE,GAHX;EAIIC,QAAAA,IAAI,EAAE,EAJV;EAKIxH,QAAAA,KAAK,EAAE,CALX;EAMIyH,QAAAA,GAAG,EAAE,CANT;EAOIC,QAAAA,KAAK,EAAE,EAPX;EAQIxE,QAAAA,KAAK,EAAE,sBARX;EASIyE,QAAAA,KAAK,EAAE,CATX;EAUI3E,QAAAA,IAAI,EAAE,KAVV;EAWIF,QAAAA,UAAU,EAAE,EAAA;EAXhB,OArDG,CANP;EAyEAwF,MAAAA,GAAG,EAAE,GAzEL;EA0EAC,MAAAA,IAAI,EAAE,SA1EN;EA2EAf,MAAAA,IAAI,EAAE,EA3EN;EA4EAgB,MAAAA,GAAG,EAAEC,OA5EL;EA6EAC,MAAAA,MAAM,EAAE,KA7ER;EA8EA1I,MAAAA,KAAK,EAAE;EACH2I,QAAAA,gBAAgB,EAAE,EADf;EAEHC,QAAAA,cAAc,EAAE,MAFb;EAGHC,QAAAA,cAAc,EAAE,CAHb;EAIHC,QAAAA,SAAS,EAAE,CAJR;EAKHC,QAAAA,WAAW,EAAE,KALV;EAMHC,QAAAA,cAAc,EAAE,MANb;EAOHC,QAAAA,WAAW,EAAE,CAPV;EAQHC,QAAAA,SAAS,EAAE,CARR;EASHvB,QAAAA,KAAK,EAAE,MAAA;SAvFX;EAyFAwB,MAAAA,IAAI,EAAE,CAzFN;EA0FAC,MAAAA,KAAK,EAAE,YA1FP;EA2FAzB,MAAAA,KAAK,EAAE,MA3FP;EA4FA0B,MAAAA,SAAS,EAAE,KA5FX;EA6FAC,MAAAA,OAAO,EAAE,UAAA;OA7Fb,CAAA;EAgGH,GAlGD,MAkGK;MACDpB,CAAC,GAAGnI,KAAK,CAACO,KAAN,CAAYiJ,MAAZ,CAAmBC,MAAnB,CAA0B,UAAAtC,KAAK,EAAI;EAAE,MAAA,OAAOA,KAAK,CAACjB,GAAN,IAAaA,GAApB,CAAA;EAA0B,KAA/D,CAAiE,CAAA,CAAjE,CAAJ,EAAyE5C,IAAI,GAAG,EAAhF,EAAoFf,IAAI,GAAG,IAAIN,IAAJ,EAA3F,CAAA;EACH,GAAA;;IAKDqB,IAAI,CAAC4E,KAAL,GAAaA,KAAb,CAAA;;IAGA,IAAG,CAACD,QAAJ,EAAa;EAGT,IAAA,IAAIyB,SAAS,GAAG1J,KAAK,CAACO,KAAN,CAAYC,QAAZ,CAAqB,WAArB,CAAkCiJ,CAAAA,MAAlC,CAAyC,UAAAxB,QAAQ,EAAI;EAAE,MAAA,OAAOA,QAAQ,CAAChF,IAAT,IAAiB,SAAjB,IAA+BgF,QAAQ,CAAC0B,IAAT,IAAiB3J,KAAK,CAACO,KAAN,CAAYoJ,IAAZ,CAAiBpD,EAAxE,CAAA;EAA8E,KAArI,CAAhB,CAAA;;MAGA,IAAGmD,SAAS,CAACrK,MAAV,IAAoB,CAAvB,EAA0BqK,SAAS,GAAG1J,KAAK,CAACO,KAAN,CAAYC,QAAZ,CAAqB,WAArB,CAAA,CAAkCiJ,MAAlC,CAAyC,UAAAxB,QAAQ,EAAI;QAAE,OAAOA,QAAQ,CAAChF,IAAT,IAAiB,SAAjB,IAA+BgF,QAAQ,CAAC0B,IAAT,IAAiB,EAAvD,CAAA;EAA6D,KAApH,CAAZ,CAAA;EAG1BrG,IAAAA,IAAI,CAACsG,KAAL,GAAaF,SAAS,CAACrK,MAAV,GAAmB,CAAnB,GAAuBqK,SAAS,CAAC,CAAD,CAAT,CAAazB,QAApC,GAA+C,yCAA5D,CAAA;EAGAA,IAAAA,QAAQ,GAAGyB,SAAS,CAACrK,MAAV,GAAmB,CAAnB,GAAuBqK,SAAS,CAAC,CAAD,CAAhC,GAAsC,EAAjD,CAAA;EACH,GAbD,MAaK;EAEDpG,IAAAA,IAAI,CAACsG,KAAL,GAAa3B,QAAQ,CAACA,QAAtB,CAAA;EACH,GAAA;;IAEDJ,OAAO,CAACC,GAAR,CAAYG,QAAZ,CAAA,CAAA;IAGA,IAAI4B,MAAM,GAAGvG,IAAI,CAACsG,KAAL,CAAWE,OAAX,CAAmB,KAAnB,CAAb,CAAA;IAAwC,IAAIC,IAAI,GAAG,EAAX,CAAA;;EACxC,EAAA,IAAGF,MAAM,IAAE,CAAC,CAAZ,EAAc;EAAEE,IAAAA,IAAI,GAAGjK,QAAQ,CAACwD,IAAI,CAACsG,KAAL,CAAWI,MAAX,CAAkBH,MAAM,GAAC,CAAzB,EAA4B,CAA5B,CAAD,CAAf,CAAA;EAAiDvG,IAAAA,IAAI,CAACsG,KAAL,GAAatG,IAAI,CAACsG,KAAL,CAAWI,MAAX,CAAkB,CAAlB,EAAqBH,MAArB,CAA+BvG,GAAAA,IAAI,CAACsG,KAAL,CAAWI,MAAX,CAAkBH,MAAM,GAAC,CAAzB,EAA4BvG,IAAI,CAACsG,KAAL,CAAWvK,MAAvC,CAA5C,CAAA;EAA6F,GAAA;;EAG9JiE,EAAAA,IAAI,CAACsG,KAAL,GAAatG,IAAI,CAACsG,KAAL,CAAWlG,OAAX,CAAmB,eAAnB,EAAoCyE,CAAC,CAAC5B,EAAtC,CAAb,CAAA;IAGAjD,IAAI,CAACsG,KAAL,GAAatG,IAAI,CAACsG,KAAL,CAAWlG,OAAX,CAAmB,kBAAnB,EAAuCyE,CAAC,CAACkB,KAAF,GAAUlB,CAAC,CAACkB,KAAZ,GAAoB,EAA3D,CAAb,CAAA;EAGA/F,EAAAA,IAAI,CAACsG,KAAL,GAAatG,IAAI,CAACsG,KAAL,CAAWlG,OAAX,CAAmB,gBAAnB,EAAqCnB,IAAI,CAAC0H,cAAL,CAAoB,EAApB,EAAwB;EAAEC,IAAAA,SAAS,EAAE,QAAb;EAAuBC,IAAAA,SAAS,EAAE,OAAA;EAAlC,GAAxB,CAArC,CAAb,CAAA;IAGA7G,IAAI,CAACsG,KAAL,GAAatG,IAAI,CAACsG,KAAL,CAAWlG,OAAX,CAAmB,kBAAnB,EAAuC0G,aAAa,CAACpK,KAAD,EAAQmI,CAAR,EAAW,EAAX,EAAe4B,IAAf,CAApD,CAAb,CAAA;IAGA,IAAMM,OAAO,GAAG/G,IAAI,CAACsG,KAAL,CAAWU,QAAX,CAAoB,8BAApB,CAAhB,CAAA;EACAC,EAAAA,KAAK,CAAClC,IAAN,CAAWgC,OAAX,EAAoB,UAAAG,CAAC,EAAA;MAAA,OAAIA,CAAC,CAAC,CAAD,CAAL,CAAA;EAAA,GAArB,CAA+BzE,CAAAA,OAA/B,CAAuC,UAAA0E,GAAG,EAAI;MAM1C,IAAIC,gBAAgB,GAAGN,aAAa,CAACpK,KAAD,EAAQmI,CAAR,EAAWsC,GAAX,EAAgBV,IAAhB,CAApC,CAAA;EAGA,IAAA,IAAIrG,OAAO,GAAG,gBAAiB+G,GAAAA,GAAjB,GAAqB,IAAnC,CAAA;MACA,IAAIE,EAAE,GAAG,IAAIC,MAAJ,CAAWlH,OAAX,EAAmB,GAAnB,CAAT,CAAA;EACAJ,IAAAA,IAAI,CAACsG,KAAL,GAAatG,IAAI,CAACsG,KAAL,CAAWlG,OAAX,CAAmBiH,EAAnB,EAAuBD,gBAAvB,CAAb,CAAA;;EAGA,IAAA,IAAGA,gBAAgB,CAACrL,MAAjB,GAAwB,CAA3B,EAA6B;EAEzB,MAAA,IAAIwL,KAAK,GAAGvH,IAAI,CAACsG,KAAL,CAAWE,OAAX,CAAmB,gBAAiBW,GAAAA,GAAjB,GAAqB,UAAxC,CAAZ,CAAA;EACA,MAAA,IAAIK,GAAG,GAAGxH,IAAI,CAACsG,KAAL,CAAWE,OAAX,CAAmB,gBAAA,GAAiBW,GAAjB,GAAqB,QAAxC,IAAoD,CAAC,gBAAA,GAAiBA,GAAjB,GAAqB,QAAtB,EAAgCpL,MAA9F,CAAA;QAEAiE,IAAI,CAACsG,KAAL,GAAatG,IAAI,CAACsG,KAAL,CAAWmB,KAAX,CAAiB,CAAjB,EAAoBF,KAApB,CAAA,GAA6BvH,IAAI,CAACsG,KAAL,CAAWmB,KAAX,CAAiBD,GAAjB,CAA1C,CAAA;EAGH,KARD,MAQK;EAEDpH,MAAAA,OAAO,GAAG,kBAAA,GAAmB+G,GAAnB,GAAuB,UAAjC,CAAA;EACAE,MAAAA,EAAE,GAAG,IAAIC,MAAJ,CAAWlH,OAAX,EAAmB,GAAnB,CAAL,CAAA;EACAJ,MAAAA,IAAI,CAACsG,KAAL,GAAatG,IAAI,CAACsG,KAAL,CAAWlG,OAAX,CAAmBiH,EAAnB,EAAuB,EAAvB,CAAb,CAAA;EAEAjH,MAAAA,OAAO,GAAG,kBAAA,GAAmB+G,GAAnB,GAAuB,QAAjC,CAAA;EACAE,MAAAA,EAAE,GAAG,IAAIC,MAAJ,CAAWlH,OAAX,EAAmB,GAAnB,CAAL,CAAA;EACAJ,MAAAA,IAAI,CAACsG,KAAL,GAAatG,IAAI,CAACsG,KAAL,CAAWlG,OAAX,CAAmBiH,EAAnB,EAAuB,EAAvB,CAAb,CAAA;EACH,KAAA;KA/BL,CAAA,CAAA;EAmCA,EAAA,IAAIlD,IAAI,GAAG,CAACU,CAAC,CAACV,IAAH,IAAWU,CAAC,CAACV,IAAF,IAAU,MAArB,GAA8B,EAA9B,GAAmCU,CAAC,CAACV,IAAhD,CAAA;;EACA,EAAA,IAAGA,IAAI,CAACpI,MAAL,GAAY,CAAf,EAAiB;EAEbiE,IAAAA,IAAI,CAACsG,KAAL,GAAatG,IAAI,CAACsG,KAAL,CAAWlG,OAAX,CAAmB,iBAAnB,EAAsC,uCAAA,GAA0C+D,IAA1C,GAAiD,yCAAvF,CAAb,CAAA;EACH,GAAA;;IAGDnE,IAAI,CAACsG,KAAL,GAAatG,IAAI,CAACsG,KAAL,CAAWlG,OAAX,CAAmB,YAAnB,EAAiC3D,WAAW,CAACC,KAAD,EAAQmI,CAAC,CAAClI,KAAF,CAAQ2H,KAAhB,CAA5C,CAAb,CAAA;IACAtE,IAAI,CAACsG,KAAL,GAAatG,IAAI,CAACsG,KAAL,CAAWlG,OAAX,CAAmB,gBAAnB,EAAqC3D,WAAW,CAACC,KAAD,EAAQmI,CAAC,CAAClI,KAAF,CAAQkJ,SAAhB,CAAhD,CAAb,CAAA;IACA7F,IAAI,CAACsG,KAAL,GAAatG,IAAI,CAACsG,KAAL,CAAWlG,OAAX,CAAmB,qBAAnB,EAA0C3D,WAAW,CAACC,KAAD,EAAQmI,CAAC,CAAClI,KAAF,CAAQ4I,cAAhB,CAArD,CAAb,CAAA;IACAvF,IAAI,CAACsG,KAAL,GAAatG,IAAI,CAACsG,KAAL,CAAWlG,OAAX,CAAmB,kBAAnB,EAAuC3D,WAAW,CAACC,KAAD,EAAQmI,CAAC,CAAClI,KAAF,CAAQ+I,WAAhB,CAAlD,CAAb,CAAA;IAEA,IAAIgC,YAAY,GAAI,EAApB,CAAA;IACAA,YAAY,IAAI,QAAQ/L,EAAE,CAAC,UAAD,CAAV,GAAuB,KAAvB,GAA+Bc,WAAW,CAACC,KAAD,EAAQmI,CAAC,CAAClI,KAAF,CAAQ2H,KAAhB,CAA1C,GAAmE,IAAnF,CAAA;EACA,EAAA,IAAGO,CAAC,CAAClI,KAAF,CAAQ4I,cAAR,GAAyB,CAA5B,EAA+BmC,YAAY,IAAI,KAAM/L,GAAAA,EAAE,CAAC,UAAD,CAAR,GAAqB,MAArB,GAA8Bc,WAAW,CAACC,KAAD,EAAQmI,CAAC,CAAClI,KAAF,CAAQ4I,cAAhB,CAAzC,GAA2E,IAA3F,CAAA;EAC/B,EAAA,IAAGV,CAAC,CAAClI,KAAF,CAAQ8I,SAAR,GAAoB,CAAvB,EAA0BiC,YAAY,IAAI,KAAA,GAAMhL,KAAK,CAACO,KAAN,CAAYC,QAAZ,CAAqByK,WAA3B,GAAuC,KAAvC,GAA+ClL,WAAW,CAACC,KAAD,EAAQmI,CAAC,CAAClI,KAAF,CAAQ8I,SAAhB,CAA1D,GAAuF,IAAvG,CAAA;EAC1B,EAAA,IAAGZ,CAAC,CAAClI,KAAF,CAAQkJ,SAAR,GAAoB,CAAvB,EAA0B6B,YAAY,IAAI,KAAA,GAAMhL,KAAK,CAACO,KAAN,CAAYC,QAAZ,CAAqB0K,WAA3B,GAAuC,KAAvC,GAA+CnL,WAAW,CAACC,KAAD,EAAQmI,CAAC,CAAClI,KAAF,CAAQkJ,SAAhB,CAA1D,GAAuF,IAAvG,CAAA;IAC1B,IAAGhB,CAAC,CAAClI,KAAF,CAAQ+I,WAAR,GAAsB,CAAzB,EAA4BgC,YAAY,IAAI,KAAA,GAAM/L,EAAE,CAAC,aAAD,CAAR,GAAwB,KAAxB,GAAgCc,WAAW,CAACC,KAAD,EAAQmI,CAAC,CAAClI,KAAF,CAAQ+I,WAAhB,CAA3D,CAAA;EAE5B1F,EAAAA,IAAI,CAACsG,KAAL,GAAatG,IAAI,CAACsG,KAAL,CAAWlG,OAAX,CAAmB,mBAAnB,EAAwCsH,YAAxC,CAAb,CAAA;IAIA,IAAGlK,QAAQ,CAACC,aAAT,CAAuB,YAAvB,CAAH,EAAyCuC,IAAI,CAACsG,KAAL,GAAatG,IAAI,CAACsG,KAAL,CAAWlG,OAAX,CAAmB,gBAAnB,EAAqC5C,QAAQ,CAACC,aAAT,CAAuB,YAAvB,CAAqCQ,CAAAA,KAA1E,CAAb,CAAA;;IAEzC,IAAG+B,IAAI,CAAC4E,KAAR,EAAc;EAAEL,IAAAA,OAAO,CAACC,GAAR,CAAYxE,IAAI,CAACsG,KAAjB,CAAA,CAAA;EAA0B,GAAA;;EAE1C,EAAA,IAAIuB,QAAQ,GAAGlI,IAAI,IAAI,MAAR,GAAiBgF,QAAQ,CAAC,YAAD,CAAzB,GAA0CA,QAAQ,CAAC,YAAD,CAAjE,CAAA;IAIA3E,IAAI,CAAC,MAAD,CAAJ,GAAetD,KAAK,CAACO,KAAN,CAAYoJ,IAAZ,CAAiBpD,EAAhC,CAAA;EACAjD,EAAAA,IAAI,CAAC,UAAD,CAAJ,GAAmB6H,QAAnB,CAAA;EACA7H,EAAAA,IAAI,CAAC,MAAD,CAAJ,GAAe,SAAf,CAAA;IAGAA,IAAI,CAACsG,KAAL,GAAawB,cAAc,CAAC9H,IAAI,CAACsG,KAAN,EAAaG,IAAb,CAA3B,CAAA;IAKAhG,KAAK,CAAC,sCAAD,EAAyC;EAC1CC,IAAAA,MAAM,EAAE,MADkC;EAE1CC,IAAAA,OAAO,EAAEA,OAFiC;EAG1CC,IAAAA,IAAI,EAAEC,IAAI,CAACC,SAAL,CAAe;EACjBC,MAAAA,KAAK,EAAE;EACHuF,QAAAA,KAAK,EAAE;EACH3G,UAAAA,IAAI,EAAQ,OADT;EAEHK,UAAAA,IAAI,EAAQA,IAFT;EAGHmF,UAAAA,GAAG,EAASC,OAAO,EAAA;EAHhB,SAAA;EADJ,OAAA;OADL,CAAA;EAHoC,GAAzC,CAAL,CAaCnE,IAbD,CAaM,UAAAC,QAAQ,EAAA;MAAA,OAAIA,QAAQ,CAACC,IAAT,EAAJ,CAAA;EAAA,GAbd,CAcCF,CAAAA,IAdD,CAcM,UAAAC,QAAQ,EAAI;MAEd,IAAIA,QAAQ,CAACE,OAAb,EAAqB;QAEjB2G,KAAK,CAAEpM,EAAE,CAAC,kBAAA,GAAmBkJ,CAAC,CAAC5B,EAAtB,CAAJ,CAAL,CAAA;EAEH,KAJD,MAIK;QAEDwB,aAAa,CAACvD,QAAD,CAAb,CAAA;EACH,KAAA;KAvBL,CAAA,CAAA,OAAA,CAAA,CAyBO,UAAAK,KAAK,EAAI;MAEZkD,aAAa,CAAClD,KAAD,CAAb,CAAA;KA3BJ,CAAA,CAAA;EA8BA7E,EAAAA,KAAK,CAACO,KAAN,CAAY+K,YAAZ,GAA2B,IAA3B,CAAA;EAEA,EAAA,OAAO,IAAP,CAAA;EACH,CAlQM,CAAA;EAoQA,IAAMF,cAAc,GAAG,SAAjBA,cAAiB,CAACxB,KAAD,EAAQG,IAAR,EAAiB;EAG3C,EAAA,IAAIwB,IAAI,GAAG3B,KAAK,CAAC4B,KAAN,CAAY,IAAZ,CAAX,CAAA;IACA,IAAIC,MAAM,GAAG,EAAb,CAAA;;EAJ2C,EAAA,IAAA,SAAA,GAAA,0BAAA,CAK5BF,IAL4B,CAAA;EAAA,MAAA,KAAA,CAAA;;EAAA,EAAA,IAAA;MAK3C,KAAoB,SAAA,CAAA,CAAA,EAAA,EAAA,CAAA,CAAA,KAAA,GAAA,SAAA,CAAA,CAAA,EAAA,EAAA,IAAA,GAAA;EAAA,MAAA,IAAZG,IAAY,GAAA,KAAA,CAAA,KAAA,CAAA;QAEhB,IAAIC,QAAQ,GAAG5B,IAAf,CAAA;;EAEA,MAAA,IAAI6B,CAAC,GAAGF,IAAG,CAAC5B,OAAJ,CAAY,KAAZ,CAAR,CAAA;;EACA,MAAA,IAAI+B,CAAC,GAAGH,IAAG,CAAC5B,OAAJ,CAAY,KAAZ,CAAR,CAAA;;EACA,MAAA,IAAIgC,CAAC,GAAGJ,IAAG,CAAC5B,OAAJ,CAAY,KAAZ,CAAR,CAAA;;EACA,MAAA,IAAIiC,CAAC,GAAGL,IAAG,CAAC5B,OAAJ,CAAY,KAAZ,CAAR,CAAA;;QAGA6B,QAAQ,IAAIK,iBAAiB,CAACN,IAAD,CAAjB,GAAyBM,iBAAiB,CAACN,IAAD,CAA1C,GAAkD,CAA9D,CAAA;;EAGA,MAAA,IAAGE,CAAC,IAAE,CAAC,CAAP,EAAS;UAELF,IAAG,GAAGA,IAAG,CAAC1B,MAAJ,CAAW,CAAX,EAAc4B,CAAd,CAAmBF,GAAAA,IAAG,CAAC1B,MAAJ,CAAW4B,CAAC,GAAC,CAAb,EAAgBF,IAAG,CAACrM,MAApB,CAAzB,CAAA;EACH,OAAA;;EAGD,MAAA,IAAGwM,CAAC,IAAE,CAAC,CAAP,EAAS;UAEL,IAAII,MAAM,GAAGN,QAAQ,GAAG,CAACD,IAAG,CAAC1B,MAAJ,CAAW,CAAX,EAAc6B,CAAd,CAAA,GAAmBH,IAAG,CAAC1B,MAAJ,CAAW6B,CAAC,GAAC,CAAb,EAAgBH,IAAG,CAACrM,MAApB,CAApB,EAAiDA,MAAzE,CAAA;;EAGA,QAAA,IAAGyM,CAAC,IAAE,CAAC,CAAP,EAAUG,MAAM,IAAI,CAAV,CAAA;EAAa,QAAA,IAAGF,CAAC,IAAE,CAAC,CAAP,EAAUE,MAAM,IAAI,CAAV,CAAA;UAEjCP,IAAG,GAAGA,IAAG,CAAC1B,MAAJ,CAAW,CAAX,EAAc6B,CAAd,CAAmBK,GAAAA,SAAS,CAACD,MAAD,CAA5B,GAAuCP,IAAG,CAAC1B,MAAJ,CAAW6B,CAAC,GAAC,CAAb,EAAgBH,IAAG,CAACrM,MAApB,CAA7C,CAAA;EACH,OAAA;;EAGD,MAAA,IAAGyM,CAAC,IAAE,CAAC,CAAP,EAAS;UAEL,IAAIG,OAAM,GAAGN,QAAQ,GAAG,CAACD,IAAG,CAAC1B,MAAJ,CAAW,CAAX,EAAc8B,CAAd,CAAA,GAAmBJ,IAAG,CAAC1B,MAAJ,CAAW8B,CAAC,GAAC,CAAb,EAAgBJ,IAAG,CAACrM,MAApB,CAApB,EAAiDA,MAAzE,CAAA;;UACAqM,IAAG,GAAGA,IAAG,CAAC1B,MAAJ,CAAW,CAAX,EAAc8B,CAAd,CAAmBJ,GAAAA,IAAG,CAAC1B,MAAJ,CAAW8B,CAAC,GAAC,CAAb,EAAgBJ,IAAG,CAACrM,MAApB,CAAnB,GAAiD6M,SAAS,CAACD,OAAD,CAAhE,CAAA;EACH,OAAA;;EAGD,MAAA,IAAGF,CAAC,IAAE,CAAC,CAAP,EAAS;UAEL,IAAIE,QAAM,GAAGN,QAAQ,GAAG,CAACD,IAAG,CAAC1B,MAAJ,CAAW,CAAX,EAAc6B,CAAd,CAAA,GAAmBH,IAAG,CAAC1B,MAAJ,CAAW6B,CAAC,GAAC,CAAb,EAAgBH,IAAG,CAACrM,MAApB,CAApB,EAAiDA,MAAzE,CAAA;;UAEAqM,IAAG,GAAGQ,SAAS,CAAC/L,IAAI,CAACgM,KAAL,CAAWF,QAAM,GAAC,CAAlB,CAAD,CAAT,GAAkCP,IAAG,CAAC1B,MAAJ,CAAW,CAAX,EAAc+B,CAAd,CAAlC,GAAqDL,IAAG,CAAC1B,MAAJ,CAAW+B,CAAC,GAAC,CAAb,EAAgBL,IAAG,CAACrM,MAApB,CAArD,GAAmF6M,SAAS,CAAC/L,IAAI,CAACiM,IAAL,CAAUH,QAAM,GAAC,CAAjB,CAAD,CAAlG,CAAA;EACH,OAAA;;QAGD,IAAII,KAAK,GAAG,CAAZ,CAAA;;EAAe,MAAA,kBAAA,CAAIX,IAAJ,CAAS3F,CAAAA,OAAT,CAAiB,UAAAuG,KAAI,EAAI;EAAE,QAAA,IAAIA,KAAI,IAAE,GAAV,EAAeD,KAAK,IAAG,CAAR,CAAA;SAA1C,CAAA,CAAA;;EAA0D,MAAA,IAAGA,KAAK,IAAEV,QAAV,EAAoBD,IAAG,GAAG,EAAN,CAAA;QAE7FD,MAAM,IAAIC,IAAG,GAAC,IAAd,CAAA;EACH,KAAA;EArD0C,GAAA,CAAA,OAAA,GAAA,EAAA;EAAA,IAAA,SAAA,CAAA,CAAA,CAAA,GAAA,CAAA,CAAA;EAAA,GAAA,SAAA;EAAA,IAAA,SAAA,CAAA,CAAA,EAAA,CAAA;EAAA,GAAA;;EAuD3C,EAAA,OAAOD,MAAP,CAAA;EACH,CAxDM,CAAA;EA0DA,IAAMS,SAAS,GAAG,SAAZA,SAAY,CAACJ,CAAD,EAAO;IAE5B,IAAIF,CAAC,GAAG,EAAR,CAAA;;IACA,KAAI,IAAIxE,CAAC,GAAC,CAAV,EAAYA,CAAC,IAAE0E,CAAf,EAAiB1E,CAAC,EAAlB,EAAqB;EAACwE,IAAAA,CAAC,IAAE,GAAH,CAAA;EAAQ,GAAA;;EAC9B,EAAA,OAAOA,CAAP,CAAA;EACH,CALM,CAAA;EAoMA,IAAMF,GAAG,GAAG,SAANA,GAAM,CAACa,GAAD,EAAMC,UAAN,EAAkBC,QAAlB,EAA4B1C,IAA5B,EAAqC;EAEpDA,EAAAA,IAAI,IAAE,CAAN,CAAA;IAEI0B,IAAAA,MAAM,GAAG,EAAb,CAAA;QAA8CiB,IAAI,GAAG,CAArD,CAAA;IAEA,IAAIC,SAAS,GAAG,IAAhB,CAAA;;EAEA,EAAA,KAAI,IAAIvF,CAAC,GAAG,CAAZ,EAAeA,CAAC,GAAGmF,GAAG,CAAClN,MAAvB,EAA+B+H,CAAC,EAAhC,EAAmC;EAE/BqE,IAAAA,MAAM,IAAIc,GAAG,CAACnF,CAAD,CAAb,CAAA;MAEAsF,IAAI,IAAK,IAAIV,iBAAiB,CAACO,GAAG,CAACnF,CAAD,CAAJ,CAA9B,CAAA;;MAGA,IAAGuF,SAAS,IAAID,IAAI,IAAI3C,IAAI,IAAIyC,UAAU,GAAGC,QAAjB,CAA5B,EAAuD;EAAEhB,MAAAA,MAAM,IAAI,OAAV,CAAA;EAAmBiB,MAAAA,IAAI,GAAG,CAAP,CAAA;EAAUC,MAAAA,SAAS,GAAG,KAAZ,CAAA;EAAmB,KAAA;;EAGzG,IAAA,IAAGD,IAAI,IAAI3C,IAAI,GAAG0C,QAAlB,EAA2B;EAAEhB,MAAAA,MAAM,IAAI,OAAV,CAAA;EAAmBiB,MAAAA,IAAI,GAAG,CAAP,CAAA;EAAW,KAAA;EAC9D,GAAA;;EAED,EAAA,OAAOjB,MAAP,CAAA;EACH,CAtBM,CAAA;EAwBA,IAAMO,iBAAiB,GAAG,SAApBA,iBAAoB,CAACY,IAAD,EAAU;IAGvC,IAAIC,QAAQ,GAAG,2CAAf,CAAA;IAEA,IAAIC,SAAS,GAAG,CAAhB,CAAA;IACA,IAAIC,MAAM,GAAG,KAAb,CAAA;EACA,EAAA,IAAI1N,MAAM,GAAGuN,IAAI,CAACvN,MAAlB,CAAA;;IACA,KAAK,IAAI+H,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG/H,MAApB,EAA4B+H,CAAC,EAA7B,EAAiC;EAE/B,IAAA,IAAI4F,OAAO,GAAGJ,IAAI,CAACK,MAAL,CAAY7F,CAAZ,CAAd,CAAA;;EACA,IAAA,IAAIyF,QAAQ,CAACK,IAAT,CAAcF,OAAd,CAAJ,EAA4B;EAI1BF,MAAAA,SAAS,IAAIC,MAAM,GAAG,CAAH,GAAO,CAA1B,CAAA;EACAA,MAAAA,MAAM,GAAG,KAAT,CAAA;EACD,KAAA;EACF,GAAA;;EAED,EAAA,OAAOD,SAAP,CAAA;EACH,CArBM,CAAA;EAuBA,IAAM1C,aAAa,GAAG,SAAhBA,aAAgB,CAACpK,KAAD,EAAQmI,CAAR,EAAWsC,GAAX,EAAgBV,IAAhB,EAAyB;IAElD,IAAIzC,KAAK,GAAG,EAAZ,CAAA;;EAIA,EAAA,KAAI,IAAIF,CAAR,IAAae,CAAC,CAACb,KAAf,EAAqB;EAEjB,IAAA,IAAGa,CAAC,CAACb,KAAF,CAAQF,CAAR,CAAA,CAAWG,IAAX,IAAmB4F,SAAtB,EAAiChF,CAAC,CAACb,KAAF,CAAQF,CAAR,CAAWG,CAAAA,IAAX,GAAkB,EAAlB,CAAA;EAEjC,IAAA,IAAG,CAACY,CAAC,CAACb,KAAF,CAAQF,CAAR,EAAWG,IAAX,CAAgBrG,QAAhB,CAAyBuJ,GAAzB,CAAD,IAAkCA,GAAG,CAACpL,MAAJ,GAAa,CAAlD,EAAqD,SAAA;EAErD,IAAA,IAAIuI,KAAK,GAAG7H,WAAW,CAACC,KAAD,EAAQmI,CAAC,CAACb,KAAF,CAAQF,CAAR,CAAA,CAAWQ,KAAnB,CAAvB,CAAA;MAGAN,KAAK,IAAA,KAAA,CAAA,MAAA,CAAWa,CAAC,CAACb,KAAF,CAAQF,CAAR,CAAA,CAAWM,GAAtB,EAAA,KAAA,CAAA,CAAA,MAAA,CAAiCgE,GAAG,CAAEzM,EAAE,CAACkJ,CAAC,CAACb,KAAF,CAAQF,CAAR,CAAWjE,CAAAA,KAAZ,CAAJ,EAAwB,CAACgF,CAAC,CAACb,KAAF,CAAQF,CAAR,CAAWM,CAAAA,GAAX,GAAe,EAAhB,EAAoBrI,MAApB,GAA6B,CAArD,EAAwD,CAACuI,KAAK,GAAC,EAAP,EAAWvI,MAAnE,EAA2E0K,IAA3E,CAApC,EAA4HnC,KAAAA,CAAAA,CAAAA,MAAAA,CAAAA,KAA5H,EAAL,IAAA,CAAA,CAAA;;MACA,KAAI,IAAI5E,CAAR,IAAamF,CAAC,CAACb,KAAF,CAAQF,CAAR,CAAWrE,CAAAA,UAAxB,EAAmC;QAE/BuE,KAAK,IAAA,MAAA,CAAA,MAAA,CAAYoE,GAAG,CAAEzM,EAAE,CAACkJ,CAAC,CAACb,KAAF,CAAQF,CAAR,CAAWrE,CAAAA,UAAX,CAAsBC,CAAtB,CAAA,CAAyBG,KAA1B,CAAJ,EAAsC,CAAtC,EAAyC,CAAzC,EAA4C4G,IAA5C,CAAf,EAAL,GAAA,CAAA,CAAA;;EACA,MAAA,KAAI,IAAI+B,CAAR,IAAc3D,CAAC,CAACb,KAAF,CAAQF,CAAR,CAAWrE,CAAAA,UAAX,CAAsBC,CAAtB,EAAyBoK,IAAvC,EAAA;EAA6C9F,QAAAA,KAAK,eAASrI,EAAE,CAACkJ,CAAC,CAACb,KAAF,CAAQF,CAAR,CAAA,CAAWrE,UAAX,CAAsBC,CAAtB,EAAyBoK,IAAzB,CAA8BtB,CAA9B,CAAiC3I,CAAAA,KAAlC,CAAX,EAAL,GAAA,CAAA,CAAA;EAA7C,OAAA;;QAEA,IAAGmE,KAAK,CAAC+F,QAAN,CAAe,GAAf,CAAH,EAAwB/F,KAAK,GAAGA,KAAK,CAACgG,SAAN,CAAgB,CAAhB,EAAmBhG,KAAK,CAACjI,MAAN,GAAe,CAAlC,CAAA,GAAuC,IAA/C,CAAA;EACxB,MAAA,IAAG,CAACiI,KAAK,CAAC+F,QAAN,CAAe,IAAf,CAAJ,EAA0B/F,KAAK,GAAGA,KAAK,GAAG,IAAhB,CAAA;EAC7B,KAAA;EACJ,GAAA;;IAED,IAAGA,KAAK,CAAC+F,QAAN,CAAe,IAAf,CAAH,EAAyB/F,KAAK,GAAGA,KAAK,CAACgG,SAAN,CAAgB,CAAhB,EAAmBhG,KAAK,CAACjI,MAAN,GAAe,CAAlC,CAAR,CAAA;EAEzB,EAAA,OAAOiI,KAAP,CAAA;EACH,CA7BM,CAAA;EAqDA,IAAMiG,OAAO,GAAG,SAAVA,OAAU,CAACvN,KAAD,EAAQwN,KAAR,EAAkB;IAGjClK,IAAAA,IAAI,GAAG,EAAX,CAAA;IAGAA,IAAI,CAAC4E,KAAL,GAAa,KAAb,CAAA;;EAGA,EAAA,IAAIwB,SAAS,GAAG1J,KAAK,CAACO,KAAN,CAAYC,QAAZ,CAAqB,WAArB,CAAkCiJ,CAAAA,MAAlC,CAAyC,UAAAxB,QAAQ,EAAI;MAAE,OAAOA,QAAQ,CAAChF,IAAT,IAAiB,IAAjB,KAA0BgF,QAAQ,CAAC0B,IAAT,IAAiB,EAAjB,IAAuB1B,QAAQ,CAAC0B,IAAT,IAAiB3J,KAAK,CAACO,KAAN,CAAYoJ,IAAZ,CAAiBpD,EAAnF,CAAP,CAAA;EAAgG,GAAvJ,CAAhB,CAAA;;EAGAjD,EAAAA,IAAI,CAACsG,KAAL,GAAaF,SAAS,CAACrK,MAAV,GAAmB,CAAnB,GAAuBqK,SAAS,CAAC,CAAD,CAAT,CAAazB,QAApC,GAA+C,oCAA5D,CAAA;IAGA3E,IAAI,CAACsG,KAAL,GAAatG,IAAI,CAACsG,KAAL,CAAWlG,OAAX,CAAmB,cAAnB,EAAmC,SAAU1D,GAAAA,KAAK,CAACO,KAAN,CAAYkN,WAAZ,CAAwBC,IAAlC,GAAyC,cAA5E,CAAb,CAAA;IAGAF,KAAK,GAAGA,KAAK,GAAGA,KAAH,GAAW1M,QAAQ,CAACC,aAAT,CAAuB,YAAvB,CAAA,CAAqCQ,KAA7D,CAAA;EAGA+B,EAAAA,IAAI,CAACsG,KAAL,GAAatG,IAAI,CAACsG,KAAL,CAAWlG,OAAX,CAAmB,gBAAnB,EAAqC8J,KAArC,CAAb,CAAA;IAGA,IAAI3D,MAAM,GAAGvG,IAAI,CAACsG,KAAL,CAAWE,OAAX,CAAmB,KAAnB,CAAb,CAAA;IAAwC,IAAIC,IAAI,GAAG,EAAX,CAAA;;EACxC,EAAA,IAAGF,MAAM,IAAE,CAAC,CAAZ,EAAc;EAAEE,IAAAA,IAAI,GAAGjK,QAAQ,CAACwD,IAAI,CAACsG,KAAL,CAAWI,MAAX,CAAkBH,MAAM,GAAC,CAAzB,EAA4B,CAA5B,CAAD,CAAf,CAAA;EAAiDvG,IAAAA,IAAI,CAACsG,KAAL,GAAatG,IAAI,CAACsG,KAAL,CAAWI,MAAX,CAAkB,CAAlB,EAAqBH,MAArB,CAA+BvG,GAAAA,IAAI,CAACsG,KAAL,CAAWI,MAAX,CAAkBH,MAAM,GAAC,CAAzB,EAA4BvG,IAAI,CAACsG,KAAL,CAAWvK,MAAvC,CAA5C,CAAA;EAA6F,GAAA;;IAG9JiE,IAAI,CAACsG,KAAL,GAAawB,cAAc,CAAC9H,IAAI,CAACsG,KAAN,EAAaG,IAAb,CAA3B,CAAA;EAGAlC,EAAAA,OAAO,CAACC,GAAR,CAAYxE,IAAI,CAACsG,KAAjB,CAAA,CAAA;IAEA,IAAIuB,QAAQ,GAAGzB,SAAS,CAAC,CAAD,CAAT,CAAa,YAAb,CAAf,CAAA;IAEApG,IAAI,CAAC,MAAD,CAAJ,GAAetD,KAAK,CAACO,KAAN,CAAYoJ,IAAZ,CAAiBpD,EAAhC,CAAA;EACAjD,EAAAA,IAAI,CAAC,UAAD,CAAJ,GAAmB6H,QAAnB,CAAA;EACA7H,EAAAA,IAAI,CAAC,MAAD,CAAJ,GAAe,IAAf,CAAA;IAKAS,KAAK,CAAC,sCAAD,EAAyC;EAC1CC,IAAAA,MAAM,EAAE,MADkC;EAE1CC,IAAAA,OAAO,EAAEA,OAFiC;EAG1CC,IAAAA,IAAI,EAAEC,IAAI,CAACC,SAAL,CAAe;EACjBC,MAAAA,KAAK,EAAE;EACHuF,QAAAA,KAAK,EAAE;EACH3G,UAAAA,IAAI,EAAQ,OADT;EAEHK,UAAAA,IAAI,EAAQA,IAFT;EAGHmF,UAAAA,GAAG,EAASC,OAAO,EAAA;EAHhB,SAAA;EADJ,OAAA;OADL,CAAA;EAHoC,GAAzC,CAAL,CAaCnE,IAbD,CAaM,UAAAC,QAAQ,EAAA;MAAA,OAAIA,QAAQ,CAACC,IAAT,EAAJ,CAAA;EAAA,GAbd,CAcCF,CAAAA,IAdD,CAcM,UAAAC,QAAQ,EAAI;MAEd,IAAIA,QAAQ,CAACE,OAAb,EAAqB;EAEjB2G,MAAAA,KAAK,CAAEpM,EAAE,CAAC,UAAD,CAAJ,CAAL,CAAA;EAEH,KAJD,MAIK;QAED8I,aAAa,CAACvD,QAAD,CAAb,CAAA;EACH,KAAA;KAvBL,CAAA,CAAA,OAAA,CAAA,CAyBO,UAAAK,KAAK,EAAI;MAEZkD,aAAa,CAAClD,KAAD,CAAb,CAAA;KA3BJ,CAAA,CAAA;EA6BH,CAvEM,CAAA;EAyEA,IAAM8I,SAAS,GAAG,SAAZA,SAAY,CAAC3N,KAAD,EAAW;EAKhC,EAAA,IAAI0J,SAAS,GAAG1J,KAAK,CAACO,KAAN,CAAYC,QAAZ,CAAqB,WAArB,CAAkCiJ,CAAAA,MAAlC,CAAyC,UAAAxB,QAAQ,EAAI;EAAE,IAAA,OAAOA,QAAQ,CAAC2F,iBAAT,IAA8B,KAA9B,IAAuC3F,QAAQ,CAAChF,IAAT,IAAiB,SAAxD,KAAsEgF,QAAQ,CAAC0B,IAAT,IAAiB,EAAjB,IAAuB1B,QAAQ,CAAC0B,IAAT,IAAiB3J,KAAK,CAACO,KAAN,CAAYoJ,IAAZ,CAAiBpD,EAA/H,CAAP,CAAA;EAA4I,GAAnM,CAAhB,CAAA;;EAEA,EAAA,IAAGmD,SAAS,CAACrK,MAAV,IAAoB,CAAvB,EAA0B,OAAO,KAAP,CAAA;EAE1BwO,EAAAA,aAAa,CAAC7N,KAAD,EAAQ0J,SAAS,CAAC,CAAD,CAAjB,CAAb,CAAA;IAAoC7D,WAAW,CAAC,UAAC7F,KAAD,EAAW;EAAE6N,IAAAA,aAAa,CAAC7N,KAAD,EAAQ0J,SAAS,CAAC,CAAD,CAAjB,CAAb,CAAA;EAAqC,GAAnD,EAAqD,IAArD,EAA2D1J,KAA3D,CAAX,CAAA;EACvC,CAVM,CAAA;EAYA,IAAM6N,aAAa,GAAG,SAAhBA,aAAgB,CAAC7N,KAAD,EAAQiI,QAAR,EAAqB;EAE9C,EAAA,IAAI6F,aAAa,GAAGC,YAAY,CAACC,cAAb,CAA4B,eAA5B,CAA+CD,GAAAA,YAAY,CAACE,OAAb,CAAqB,eAArB,CAA/C,GAAuF,CAA3G,CAAA;IACA,IAAI7G,CAAC,GAAGpH,KAAK,CAACO,KAAN,CAAYiJ,MAAZ,CAAmBnK,MAA3B,CAAA;;IAEA,OAAO+H,CAAC,GAAG,CAAX,EAAa;MAETA,CAAC,EAAA,CAAA;;MAED,IAAGpH,KAAK,CAACO,KAAN,CAAYiJ,MAAZ,CAAmBpC,CAAnB,CAAsBuB,CAAAA,MAAtB,IAAgC,KAAhC,IAAyC7I,QAAQ,CAACE,KAAK,CAACO,KAAN,CAAYiJ,MAAZ,CAAmBpC,CAAnB,CAAA,CAAsBb,EAAvB,CAAR,GAAqCuH,aAAjF,EAA+F;EAE3FC,MAAAA,YAAY,CAACG,OAAb,CAAqB,eAArB,EAAsClO,KAAK,CAACO,KAAN,CAAYiJ,MAAZ,CAAmBpC,CAAnB,EAAsBb,EAA5D,CAAA,CAAA;EAEAyB,MAAAA,YAAY,CAAChI,KAAD,EAAQA,KAAK,CAACO,KAAN,CAAYiJ,MAAZ,CAAmBpC,CAAnB,EAAsBlB,GAA9B,EAAmC,MAAnC,EAA2C+B,QAA3C,CAAZ,CAAA;EAEA,MAAA,OAAO,KAAP,CAAA;EACH,KAAA;EACJ,GAAA;EACJ,CAlBM,CAAA;EAoBA,IAAMkG,gBAAgB,GAAG,SAAnBA,gBAAmB,CAACnO,KAAD,EAAW;EAGvC,EAAA,IAAI0J,SAAS,GAAG1J,KAAK,CAACO,KAAN,CAAYC,QAAZ,CAAqB,WAArB,CAAkCiJ,CAAAA,MAAlC,CAAyC,UAAAxB,QAAQ,EAAI;MAAE,OAAOA,QAAQ,CAAChF,IAAT,IAAiB,IAAjB,KAA0BgF,QAAQ,CAAC0B,IAAT,IAAiB,EAAjB,IAAuB1B,QAAQ,CAAC0B,IAAT,IAAiB3J,KAAK,CAACO,KAAN,CAAYoJ,IAAZ,CAAiBpD,EAAnF,CAAP,CAAA;EAAgG,GAAvJ,CAAhB,CAAA;;IAEA,OAAOmD,SAAS,CAACrK,MAAV,GAAmB,CAAnB,GAAuB,IAAvB,GAA8B,KAArC,CAAA;EACH,CANM;;EC9sBA,IAAM+O,MAAM,GAAG;EAElBpO,EAAAA,KAAK,EAAE,IAFW;EAGlBqO,EAAAA,SAAS,EAAE,IAHO;EAIlB9N,EAAAA,KAAK,EAAE;EAAE8G,IAAAA,WAAW,EAAE,IAAA;KAJJ;EAKlBiH,EAAAA,MAAM,EAAE,SAAA,MAAA,CAACtO,KAAD,EAAQiB,CAAR,EAAc;MAElB,IAAGjB,KAAK,CAACO,KAAN,CAAYC,QAAZ,CAAqB4N,MAArB,IAA+B,GAAlC,EAAuC,OAAA;;MAEnCxC,IAAQ2C,UAAU,GAAGvO,KAAK,CAACO,KAAN,CAAYC,QAAZ,CAAqB+N,UAArB,CAAgCC,IAAhC,EAAA,CAAuChD,KAAvC,CAA6C,IAA7C,EAAzB;;EAEA,IAAA,IAAI1F,IAAI,GAAR,qGAAA,CAAA;;MAEA9F,KAAK,CAACO,KAAN,CAAYiJ,MAAZ,CAAmBzD,OAAnB,CAA2B,UAAAoC,CAAC,EAAI;EAE5B,MAAA,IAAGA,CAAC,CAACkB,KAAL,EAAY,IAAGlB,CAAC,CAACkB,KAAF,CAAQhK,MAAR,GAAe,CAAlB,EAAqB,IAAG,CAACkP,UAAU,CAACrN,QAAX,CAAoBiH,CAAC,CAACkB,KAAtB,CAAJ,EAAkCkF,UAAU,CAACpI,IAAX,CAAgBgC,CAAC,CAACkB,KAAlB,CAAA,CAAA;OAFvE,CAAA,CAAA;;EAOAkF,IAAAA,UAAU,CAACxI,OAAX,CAAmB,UAACW,EAAD,EAAKU,CAAL,EAAW;QAE1BtB,IAAI,IAAIsI,MAAM,CAACK,eAAP,CAAuBzO,KAAvB,EAA8BoH,CAA9B,EAAiCV,EAAjC,EAAqC;EAAE8C,QAAAA,MAAM,EAAExJ,KAAK,CAACO,KAAN,CAAYiJ,MAAtB;EAA8BkF,QAAAA,IAAI,EAAE1O,KAAK,CAACO,KAAN,CAAYmO,IAAAA;EAAhD,OAArC,CAAR,CAAA;OAFJ,CAAA,CAAA;EAMA5I,IAAAA,IAAI,IAAI,QAAR,CAAA;EAEA,IAAA,IAAGhF,QAAQ,CAACC,aAAT,CAAuB,aAAvB,CAAH,EAA0CD,QAAQ,CAACC,aAAT,CAAuB,aAAvB,EAAsC4N,MAAtC,EAAA,CAAA;MAE1C7N,QAAQ,CAACC,aAAT,CAAuB,sBAAvB,EAA+CuF,kBAA/C,CAAkE,WAAlE,EAA+ER,IAA/E,CAAA,CAAA;;MAGA,IAAGsI,MAAM,CAACC,SAAV,EAAoB;QAEhBD,MAAM,CAACC,SAAP,GAAmB,KAAnB,CAAA;EAA0BnP,MAAAA,SAAO,CAAC,WAAD,EAAc,UAAC+B,CAAD,EAAO;EAElDA,QAAAA,CAAC,CAACO,cAAF,EAAA,CAAA;UAEA+L,OAAO,CAACvN,KAAD,EAAQiB,CAAC,CAACuF,aAAF,CAAgBC,OAAhB,CAAwB+G,KAAhC,CAAP,CAAA;EACH,OALgC,CAAP,CAAA;EAM7B,KAAA;KAzCa;IA2ClBoB,WAAW,EAAE,qBAAC5O,KAAD,EAAQgC,CAAR,EAAW6M,IAAX,EAAiBrE,CAAjB,EAAuB;MAEhC,IAAI1E,IAAI,GAAG,EAAX,CAAA;;MACA,QAAO9D,CAAC,CAACf,CAAT;EAEI,MAAA,KAAK,OAAL;EAEI6E,QAAAA,IAAI,GAAoB0E,iBAAAA,CAAAA,MAAAA,CAAAA,CAApB,EAAyDxI,sCAAAA,CAAAA,CAAAA,MAAAA,CAAAA,CAAC,CAAC8M,SAAF,GAAc9M,CAAC,CAAC8M,SAAhB,GAA4B,EAArF,oCAAkH9M,CAAC,CAAC+M,QAAF,GAAa,wBAAb,GAAsC,EAAxJ,EAAA,aAAA,CAAA,CAAA,MAAA,CAAwKvE,CAAxK,EAA2LqE,kBAAAA,CAAAA,CAAAA,MAAAA,CAAAA,IAA3L,EAAsM9O,KAAAA,CAAAA,CAAAA,MAAAA,CAAAA,WAAW,CAACC,KAAD,EAAQ6O,IAAR,CAAjN,EAAJ,QAAA,CAAA,CAAA;EACA,QAAA,OAAO/I,IAAP,CAAA;;EACJ,MAAA,KAAK,MAAL;UAEIA,IAAI,GAAA,iBAAA,CAAA,MAAA,CAAoB0E,CAApB,EAAA,gCAAA,CAAA,CAAA,MAAA,CAAmDxI,CAAC,CAAC8M,SAAF,GAAc9M,CAAC,CAAC8M,SAAhB,GAA4B,EAA/E,oCAA4G9M,CAAC,CAAC+M,QAAF,GAAa,wBAAb,GAAsC,EAAlJ,EAAkKvE,aAAAA,CAAAA,CAAAA,MAAAA,CAAAA,CAAlK,EAAyKqE,KAAAA,CAAAA,CAAAA,MAAAA,CAAAA,IAAzK,EAAJ,QAAA,CAAA,CAAA;EACA,QAAA,OAAO/I,IAAP,CAAA;;EACJ,MAAA,KAAK,UAAL;UAAiB,OAAO,8FAAA,GAA+F0E,CAA/F,GAAiG,WAAjG,GAA6GqE,IAA7G,GAAkH,IAAlH,GAAuHA,IAAvH,GAA4H,aAAnI,CAAA;;EACjB,MAAA,KAAK,OAAL;EAGI/I,QAAAA,IAAI,GAA2F7G,4FAAAA,CAAAA,MAAAA,CAAAA,EAAE,CAAC,SAAD,CAA7F,EAAkKA,2DAAAA,CAAAA,CAAAA,MAAAA,CAAAA,EAAE,CAAC,KAAD,CAApK,EAAoOA,0DAAAA,CAAAA,CAAAA,MAAAA,CAAAA,EAAE,CAAC,OAAD,CAAtO,EAAJ,2BAAA,CAAA,CAAA;;EACA,QAAA,KAAI,IAAIuL,EAAR,IAAaqE,IAAb,EAAkB;EAAE/I,UAAAA,IAAI,IAAIkJ,OAAO,CAACC,oBAAR,CAA6BjP,KAA7B,EAAoCwK,EAApC,EAAuCqE,IAAvC,EAA6C,KAA7C,CAAR,CAAA;EAA8D,SAAA;;EAGlF/I,QAAAA,IAAI,IAG+E7G,2OAAAA,CAAAA,MAAAA,CAAAA,EAAE,CAAC,UAAD,CAHjF,EAAJ,ioDAAA,CAAA,CAAA;EAwBA6G,QAAAA,IAAI,IAAJ,qDAAA,CAAA;EAEA,QAAA,OAAOA,IAAP,CAAA;;EACJ,MAAA;EAEI,QAAA,IAAG0E,CAAC,IAAI,KAAR,EAAeqE,IAAI,GAAGA,IAAI,CAAC7E,MAAL,CAAY,CAAZ,EAAe,CAAf,CAAP,CAAA;UAEflE,IAAI,GAAA,iBAAA,CAAA,MAAA,CAAoB0E,CAApB,EAAA,gCAAA,CAAA,CAAA,MAAA,CAAmDxI,CAAC,CAAC8M,SAAF,GAAc9M,CAAC,CAAC8M,SAAhB,GAA4B,EAA/E,oCAA4G9M,CAAC,CAAC+M,QAAF,GAAa,wBAAb,GAAsC,EAAlJ,EAAkKvE,aAAAA,CAAAA,CAAAA,MAAAA,CAAAA,CAAlK,EAAyKqE,KAAAA,CAAAA,CAAAA,MAAAA,CAAAA,IAAzK,EAAJ,QAAA,CAAA,CAAA;EACA,QAAA,OAAO/I,IAAP,CAAA;EAlDR,KAAA;KA9Cc;IAoGpB2I,eAAe,EAAE,yBAACzO,KAAD,EAAQoH,CAAR,EAAWV,EAAX,EAAelC,QAAf,EAA4B;MAE3C,IAAI0K,EAAE,GAAG,CAAT,CAAA;MACA,IAAI/H,KAAK,GAAG,EAAZ,CAAA;MACA,IAAIgI,OAAO,GAAG,CAAd,CAAA;MAEA3K,QAAQ,CAACgF,MAAT,CAAgBzD,OAAhB,CAAwB,UAACoC,CAAD,EAAIX,KAAJ,EAAc;EAAE,MAAA,IAAGW,CAAC,CAACkB,KAAF,IAAW3C,EAAE,GAAC,EAAd,IAAoByB,CAAC,CAAC5B,EAAF,GAAO4I,OAA9B,EAAsC;EAAED,QAAAA,EAAE,GAAG1H,KAAL,CAAA;EAAYL,QAAAA,KAAK,GAAGgB,CAAR,CAAA;UAAWgH,OAAO,GAAGhH,CAAC,CAAC5B,EAAZ,CAAA;EAAiB,OAAA;OAAxH,CAAA,CAAA;EAEAY,IAAAA,KAAK,GAAGA,KAAK,GAAGA,KAAH,GAAW,EAAxB,CAAA;EACAA,IAAAA,KAAK,CAAC,IAAD,CAAL,GAAcA,KAAK,CAACZ,EAAN,GAAWY,KAAK,CAACZ,EAAjB,GAAsB,EAApC,CAAA;EACAY,IAAAA,KAAK,CAAC,KAAD,CAAL,GAAeA,KAAK,CAACjB,GAAN,GAAYiB,KAAK,CAACjB,GAAlB,GAAwB,EAAvC,CAAA;EACAiB,IAAAA,KAAK,CAAC,SAAD,CAAL,GAAmBA,KAAK,CAACiB,OAAN,GAAgBjB,KAAK,CAACiB,OAAtB,GAAgC,EAAnD,CAAA;MAEA,IAAIgH,OAAO,GAAG,EAAd,CAAA;;MACA,IAAIC,UAAU,GAAGlI,KAAK,CAACjB,GAAN,GAAYiB,KAAK,CAACjB,GAAlB,GAAwB,EAAzC;UAA6CoJ,QAAQ,GAAGD,UAAxD,CAAA;;MAEA,QAAOlI,KAAK,CAAC,QAAD,CAAZ;EAEI,MAAA,KAAK,KAAL;EAAYiI,QAAAA,OAAO,GAAG,sBAAV,CAAA;EAAmC,QAAA,MAAA;;EAC/C,MAAA,KAAK,MAAL;EAAaA,QAAAA,OAAO,GAAG,uBAAV,CAAA;EAAmC,QAAA,MAAA;;EAChD,MAAA,KAAK,YAAL;EAAmBA,QAAAA,OAAO,GAAG,uBAAV,CAAA;EAAmC,QAAA,MAAA;;EACtD,MAAA,KAAK,WAAL;EAAkBA,QAAAA,OAAO,GAAG,yBAAV,CAAA;EAAqCE,QAAAA,QAAQ,GAAG,EAAX,CAAA;EAAe,QAAA,MAAA;;EACtE,MAAA,KAAK,QAAL;EAAeF,QAAAA,OAAO,GAAG,sBAAV,CAAA;EAAkCE,QAAAA,QAAQ,GAAG,EAAX,CAAA;EAAe,QAAA,MAAA;;EAChE,MAAA,KAAK,UAAL;EAAiBF,QAAAA,OAAO,GAAG,sBAAV,CAAA;EAAkCE,QAAAA,QAAQ,GAAG,EAAX,CAAA;EAAe,QAAA,MAAA;;EAClE,MAAA;EAASF,QAAAA,OAAO,GAAG,yBAAV,CAAA;EAAqCE,QAAAA,QAAQ,GAAG,EAAX,CAAA;EAAe,QAAA,MAAA;EARjE,KAAA;;MAWA,OAEwBF,uDAAAA,CAAAA,MAAAA,CAAAA,OAFxB,uGAGiDC,UAAU,IAAIlI,KAAK,CAAC,QAAD,CAAL,IAAmB,WAAjC,GAA+C,YAA/C,GAA8D,EAH/G,EAGiIkI,eAAAA,CAAAA,CAAAA,MAAAA,CAAAA,UAHjI,6BAG8J3I,EAH9J,EAAA,KAAA,CAAA,CAAA,MAAA,CAGuK2I,UAAU,GAAG,cAAiBH,GAAAA,EAAjB,GAAsB,GAAzB,GAA+B,EAHhN,EAGyN/H,KAAAA,CAAAA,CAAAA,MAAAA,CAAAA,KAAK,CAACZ,EAAN,GAAWrD,MAAM,CAAC,iBAAD,EAAoBiE,KAAK,CAACZ,EAA1B,CAAjB,GAAiD,QAH1Q,+JAIoI+I,QAJpI,EAAA,kBAAA,CAAA,CAAA,MAAA,CAI+J5I,EAJ/J,EAAA,KAAA,CAAA,CAAA,MAAA,CAIwK4I,QAAQ,GAAG,iBAAiBJ,EAAjB,GAAsB,GAAzB,GAA+B,EAJ/M,2DAKsCjQ,EAAE,CAAC,WAAD,EAAcyH,EAAd,CALxC,EAQeS,qHAAAA,CAAAA,CAAAA,MAAAA,CAAAA,KAAK,CAAC,SAAD,CAAL,GAAmBvF,gBAAgB,CAAC3C,EAAD,EAAKuF,QAAQ,CAACkK,IAAT,CAAc5M,IAAnB,EAAyBqF,KAAK,CAAC,SAAD,CAA9B,CAAnC,GAAgF,QAR/F,EASwInH,sJAAAA,CAAAA,CAAAA,MAAAA,CAAAA,KAAK,CAACO,KAAN,CAAYC,QAAZ,CAAqB+O,QAArB,GAAgC,EAAhC,GAAqC,QAT7K,EAAA,yCAAA,CAAA,CAAA,MAAA,CAS6N7I,EAT7N,EAAA,0zBAAA,CAAA,CAAA;EAmBD,GAAA;EAlJmB,CAAf;;ECDA,IAAMsI,SAAO,GAAG;EAEnBhP,EAAAA,KAAK,EAAE,IAFY;EAGnBO,EAAAA,KAAK,EAAE;EAAE8G,IAAAA,WAAW,EAAE,IAAA;KAHH;EAInBmI,EAAAA,WAAW,EAAE,SAAA,WAAA,CAACxP,KAAD,EAAQiB,CAAR,EAAc;EAEvBjB,IAAAA,KAAK,CAACO,KAAN,CAAYkP,OAAZ,GAAsB,KAAtB,CAAA;MACAzP,KAAK,CAAC0P,KAAN,GAAc5O,QAAQ,CAACC,aAAT,CAAuB,cAAvB,CAAd,CAAA;MACAf,KAAK,CAAC2P,SAAN,GAAkB,IAAIC,SAAS,CAACC,KAAd,CAAoB7P,KAAK,CAAC0P,KAA1B,CAAlB,CAAA;MACA1P,KAAK,CAAC8P,SAAN,GAAkB,IAAlB,CAAA;EACA9P,IAAAA,KAAK,CAAC+P,OAAN,GAAgB,CAAC,CAAjB,CAAA;MACA,IAAI3I,CAAC,GAAGnG,CAAC,CAACuF,aAAF,CAAgBC,OAAhB,CAAwBe,KAAhC,CAAA;MAGAwI,OAAO,CAACC,SAAR,CAAkB;EAAEC,MAAAA,MAAM,EAAE,QAAA;EAAV,KAAlB,EAAwC,QAAxC,EAAkDzQ,MAAM,CAACC,QAAP,CAAgByQ,QAAhB,GAA2B1Q,MAAM,CAACC,QAAP,CAAgBC,MAA3C,GAAoD,UAAtG,CAAA,CAAA;;MAEAK,KAAK,CAAC0P,KAAN,CAAY1O,gBAAZ,CAA6B,eAA7B,EAA8C,UAAUC,CAAV,EAAa;EAEvD,MAAA,IAAIxB,MAAM,CAACC,QAAP,CAAgB0Q,IAAhB,CAAqBtG,OAArB,CAA6B,UAA7B,CAAA,IAA4C,CAAC,CAAjD,EAAoD,OAAA;QAEpDkG,OAAO,CAACC,SAAR,CAAkB;EAAEC,QAAAA,MAAM,EAAE,QAAA;EAAV,OAAlB,EAAwC,QAAxC,EAAkDzQ,MAAM,CAACC,QAAP,CAAgByQ,QAAhB,GAA2B1Q,MAAM,CAACC,QAAP,CAAgBC,MAA7F,CAAA,CAAA;OAJJ,CAAA,CAAA;;EAQA,IAAA,IAAI,OAAQyH,CAAR,KAAe,WAAnB,EAAgC;EAE5BpH,MAAAA,KAAK,CAACO,KAAN,CAAY8G,WAAZ,GAA0B;EACtBnB,QAAAA,GAAG,EAAE,KADiB;EAEtBkC,QAAAA,OAAO,EAAE,UAFa;EAGtBC,QAAAA,IAAI,EAAE,SAHgB;EAItB9B,QAAAA,EAAE,EAAE,EAJkB;EAKtB+B,QAAAA,GAAG,EAAE,EALiB;EAMtBhB,QAAAA,KAAK,EAAE,EANe;EAOtBiB,QAAAA,GAAG,EAAE,GAPiB;EAQtBC,QAAAA,IAAI,EAAE,SARgB;EAStBf,QAAAA,IAAI,EAAE,EATgB;EAUtBgB,QAAAA,GAAG,EAAEC,OAViB;EAWtBC,QAAAA,MAAM,EAAE,KAXc;EAYtB1I,QAAAA,KAAK,EAAE;YAAE,kBAAoB,EAAA,CAAA;WAZP;EAatBmJ,QAAAA,IAAI,EAAE,CAbgB;EActBC,QAAAA,KAAK,EAAEpI,CAAC,CAACuF,aAAF,CAAgBC,OAAhB,CAAwB4C,KAAxB,GAAgCpI,CAAC,CAACuF,aAAF,CAAgBC,OAAhB,CAAwB4C,KAAxD,GAAgE,GAdjD;EAetBzB,QAAAA,KAAK,EAAE,CAfe;EAgBtB2B,QAAAA,OAAO,EAAE,UAAA;SAhBb,CAAA;;EAoBA,MAAA,IAAGvJ,KAAK,CAACO,KAAN,CAAY8G,WAAZ,CAAwBnB,GAAxB,IAA+B,KAA/B,IAAwClG,KAAK,CAACO,KAAN,CAAYC,QAAZ,CAAqB6P,YAArB,IAAqC,GAAhF,EAAoF;EAEhF,QAAA,IAAIvJ,QAAQ,GAAG9G,KAAK,CAACO,KAAN,CAAYC,QAAZ,CAAqB8P,iBAArB,CAAuC9B,IAAvC,EAAA,CAA8ChD,KAA9C,CAAoD,IAApD,CAAf,CAAA;;UAEA3E,eAAe,CAAC7G,KAAD,EAAQ8G,QAAR,EAAkBkI,SAAO,CAACuB,aAA1B,CAAf,CAAA;EAEH,OAND,MAMK;UAEDvB,SAAO,CAACuB,aAAR,CAAsBvQ,KAAtB,CAAA,CAAA;EACH,OAAA;EAEJ,KAjCD,MAiCO;EAEHA,MAAAA,KAAK,CAACO,KAAN,CAAY8G,WAAZ,GAA0BrH,KAAK,CAACO,KAAN,CAAYiJ,MAAZ,CAAmBpC,CAAnB,CAA1B,CAAA;QAEA4H,SAAO,CAACuB,aAAR,CAAsBvQ,KAAtB,CAAA,CAAA;EACH,KAAA;;EAQDd,IAAAA,SAAO,CAAC,cAAD,EAAiB,UAAC+B,CAAD,EAAO;EAE3BA,MAAAA,CAAC,CAACO,cAAF,EAAA,CAAA;QAEAxB,KAAK,CAACO,KAAN,CAAY+K,YAAZ,GAA2BrK,CAAC,CAACuF,aAAF,CAAgBC,OAAhB,CAAwBF,EAAnD,CAAA;QAEAK,aAAa,CAAC5G,KAAK,CAAC0P,KAAN,CAAY3O,aAAZ,CAA0B,cAA1B,CAAD,CAAb,CAAA;EACH,KAPM,CAAP,CAAA;;EAUAf,IAAAA,KAAK,CAACwQ,SAAN,CAAgBC,mBAAhB,GAAsC,UAACxP,CAAD,EAAO;EAEzCA,MAAAA,CAAC,CAACO,cAAF,EAAA,CAAA;;QAEAxB,KAAK,CAAC0Q,WAAN,CAAkBtJ,CAAlB,EAAqBpH,KAAK,CAACO,KAAN,CAAY8G,WAAZ,CAAwBnB,GAA7C,CAAA,CAAA;OAJJ,CAAA;;EAOAhH,IAAAA,SAAO,CAAC,gBAAD,EAAmB,UAAC+B,CAAD,EAAO;EAE7BA,MAAAA,CAAC,CAACO,cAAF,EAAA,CAAA;EAEAwN,MAAAA,SAAO,CAAChP,KAAR,CAAcO,KAAd,CAAoBkP,OAApB,GAA8B,IAA9B,CAAA;EAEA,MAAA,IAAIkB,GAAG,GAAG7P,QAAQ,CAACC,aAAT,CAAuB,qBAAvB,CAAV,CAAA;EACA4P,MAAAA,GAAG,CAACC,SAAJ,GAAgB5Q,KAAK,CAACO,KAAN,CAAYsQ,QAAZ,CAAqB5P,CAAC,CAACuF,aAAF,CAAgBC,OAAhB,CAAwBO,GAA7C,EAAkD4F,IAAlE,CAAA;QACA+D,GAAG,CAAClK,OAAJ,CAAYlF,KAAZ,GAAoBN,CAAC,CAACuF,aAAF,CAAgBC,OAAhB,CAAwBO,GAA5C,CAAA;QACA,IAAIoG,IAAI,GAAG,EAAX,CAAA;EAGA0D,MAAAA,MAAM,CAACC,IAAP,CAAY/Q,KAAK,CAACO,KAAN,CAAYsQ,QAAxB,CAAkC9K,CAAAA,OAAlC,CAA0C,UAACiB,GAAD,EAAS;EAC/CoG,QAAAA,IAAI,GAAGpN,KAAK,CAACO,KAAN,CAAYsQ,QAAZ,CAAqB7J,GAArB,CAAgCwE,CAAAA,OAAAA,CAAAA,CAAAA,KAAhC,CAAsC,GAAtC,CAAP,CAAA;EACA4B,QAAAA,IAAI,CAACrH,OAAL,CAAa,UAACiB,GAAD,EAAS;EAClB2J,UAAAA,GAAG,CAAC7B,SAAJ,CAAcH,MAAd,CAAqB3H,GAArB,CAAA,CAAA;WADJ,CAAA,CAAA;SAFJ,CAAA,CAAA;EAQAoG,MAAAA,IAAI,GAAGpN,KAAK,CAACO,KAAN,CAAYsQ,QAAZ,CAAqB5P,CAAC,CAACuF,aAAF,CAAgBC,OAAhB,CAAwBO,GAA7C,WAAwDwE,KAAxD,CAA8D,GAA9D,CAAP,CAAA;EACA4B,MAAAA,IAAI,CAACrH,OAAL,CAAa,UAACiB,GAAD,EAAS;EAElB2J,QAAAA,GAAG,CAAC7B,SAAJ,CAAckC,GAAd,CAAkBhK,GAAlB,CAAA,CAAA;SAFJ,CAAA,CAAA;EAIH,KAzBM,CAAP,CAAA;KAvFe;IAkHnBuJ,aAAa,EAAE,SAACvQ,aAAAA,CAAAA,KAAD,EAAW;EAAA,IAAA,IAAA,OAAA,CAAA;;MAEtBgP,SAAO,CAACzO,KAAR,CAAc8G,WAAd,GAA4BrH,KAAK,CAACO,KAAN,CAAY8G,WAAxC,CAAA;MAGA,IAAIC,KAAK,GAAG,EAAZ,CAAA;EAGAwJ,IAAAA,MAAM,CAACC,IAAP,CAAY/Q,KAAK,CAACO,KAAN,CAAYsQ,QAAxB,CAAA,CAAkC9K,OAAlC,CAA0C,UAACiB,GAAD,EAAMQ,KAAN,EAAgB;EAAEF,MAAAA,KAAK,IAAmDN,iDAAAA,CAAAA,MAAAA,CAAAA,GAAnD,EAAoEhH,gBAAAA,CAAAA,CAAAA,MAAAA,CAAAA,KAAK,CAACO,KAAN,CAAYsQ,QAAZ,CAAqB7J,GAArB,CAA0B4F,CAAAA,IAA9F,EAAL,WAAA,CAAA,CAAA;OAA5D,CAAA,CAAA;MACA,IAAIqE,YAAY,GAGejR,2KAAAA,CAAAA,MAAAA,CAAAA,KAAK,CAACO,KAAN,CAAYsQ,QAAZ,CAAqB7Q,KAAK,CAACO,KAAN,CAAY8G,WAAZ,CAAwB,QAAxB,CAArB,CAAA,CAAA,OAAA,CAHf,EAGyJrH,kFAAAA,CAAAA,CAAAA,MAAAA,CAAAA,KAAK,CAACO,KAAN,CAAY8G,WAAZ,CAAwB,QAAxB,CAHzJ,gJAIFrH,KAAK,CAACO,KAAN,CAAYsQ,QAAZ,CAAqB7Q,KAAK,CAACO,KAAN,CAAY8G,WAAZ,CAAwB,QAAxB,CAArB,CAAwDuF,CAAAA,IAJtD,EAOFtF,mIAAAA,CAAAA,CAAAA,MAAAA,CAAAA,KAPE,EAU0D0H,qIAAAA,CAAAA,CAAAA,MAAAA,CAAAA,SAAO,CAACzO,KAAR,CAAc8G,WAAd,CAA0BnB,GAVpF,EAAhB,qsBAAA,CAAA,CAAA;;MAqBAlG,KAAK,CAAC0P,KAAN,CAAY3O,aAAZ,CAA0B,eAA1B,CAAA,CAA2C+N,SAA3C,CAAqDkC,GAArD,CAAyD,kBAAzD,CAAA,CAAA;;EACAhR,IAAAA,KAAK,CAAC0P,KAAN,CAAY3O,aAAZ,CAA0B,4BAA1B,CAAwD6P,CAAAA,SAAxD,GAAoExP,KAAK,CAACpB,KAAK,CAACO,KAAN,CAAY8G,WAAZ,CAAwB,MAAxB,CAAD,CAAL,GAAyCrH,KAAK,CAACO,KAAN,CAAY8G,WAAZ,CAAwB,MAAxB,CAAzC,GAA2E,GAAA,GAAMrH,KAAK,CAACO,KAAN,CAAY8G,WAAZ,CAAwB,MAAxB,CAArJ,CAAA;MACArH,KAAK,CAAC0P,KAAN,CAAY3O,aAAZ,CAA0B,4BAA1B,CAAA,CAAwD6P,SAAxD,GAAoE5Q,KAAK,CAACO,KAAN,CAAY8G,WAAZ,CAAwBnB,GAAxB,IAA+B,KAA/B,GAAuCjH,EAAE,CAAC,QAAD,CAAzC,GAAsDA,EAAE,CAAC,QAAD,CAA5H,CAAA;MACAe,KAAK,CAAC0P,KAAN,CAAY3O,aAAZ,CAA0B,cAA1B,CAAA,CAA0C0F,OAA1C,CAAkDyK,OAAlD,GAA4D,KAA5D,CAAA;EACAlR,IAAAA,KAAK,CAAC0P,KAAN,CAAY3O,aAAZ,CAA0B,8BAA1B,CAA0D6P,CAAAA,SAA1D,GAAsE3R,EAAE,CAAC,OAAD,CAAxE,CAAA;MAEA,IAAI6G,IAAI,GAAGmL,YAAX,CAAA;EAEA,IAAA,IAAIlK,MAAM,IAAA,OAAA,GAAA;EAAKR,MAAAA,EAAE,EAAE;EAAEuF,QAAAA,CAAC,EAAE7M,EAAE,CAAC,IAAD,CAAP;EAAe6P,QAAAA,SAAS,EAAE,YAAA;SAAnC;EAAmDzG,MAAAA,IAAI,EAAE;EAAEyD,QAAAA,CAAC,EAAE7M,EAAE,CAAC,MAAD,CAAP;EAAiBgC,QAAAA,CAAC,EAAE,MAApB;EAA4B8N,QAAAA,QAAQ,EAAE,IAAtC;EAA4CD,QAAAA,SAAS,EAAE,YAAA;SAAhH;EAAgIzF,MAAAA,KAAK,EAAE;EAAEyC,QAAAA,CAAC,EAAE7M,EAAE,CAAC,OAAD,CAAP;EAAkBgC,QAAAA,CAAC,EAAE,MAArB;EAA6B8N,QAAAA,QAAQ,EAAE,IAAvC;EAA6CD,QAAAA,SAAS,EAAE,YAAA;SAA/L;EAA+MxH,MAAAA,KAAK,EAAE;EAAEwE,QAAAA,CAAC,EAAE,EAAL;EAAS7K,QAAAA,CAAC,EAAE,OAAA;SAAlO;EAA6OkQ,MAAAA,KAAK,EAAE;EAAErF,QAAAA,CAAC,EAAE7M,EAAE,CAAC,MAAD,CAAP;EAAiBgC,QAAAA,CAAC,EAAE,MAAA;SAAxQ;EAAkRmQ,MAAAA,KAAK,EAAE;EAAEtF,QAAAA,CAAC,EAAE7M,EAAE,CAAC,SAAD,CAAP;EAAoBgC,QAAAA,CAAC,EAAE,MAAA;SAAhT;EAA0ToQ,MAAAA,IAAI,EAAE;EAAEvF,QAAAA,CAAC,EAAE7M,EAAE,CAAC,MAAD,CAAP;EAAiBgC,QAAAA,CAAC,EAAE,UAAA;SAApV;EAAkWqQ,MAAAA,MAAM,EAAE;EAAExF,QAAAA,CAAC,EAAE7M,EAAE,CAAC,QAAD,CAAP;EAAmBgC,QAAAA,CAAC,EAAE,MAAA;SAAhY;EAA0YsQ,MAAAA,KAAK,EAAE;EAAEzF,QAAAA,CAAC,EAAE7M,EAAE,CAAC,OAAD,CAAP;EAAkBgC,QAAAA,CAAC,EAAE,MAAA;SAAta;EAAgbuQ,MAAAA,QAAQ,EAAE;EAAE1F,QAAAA,CAAC,EAAE7M,EAAE,CAAC,SAAD,CAAP;EAAoBgC,QAAAA,CAAC,EAAE,MAAA;SAAjd;EAA2dwQ,MAAAA,KAAK,EAAE;EAAE3F,QAAAA,CAAC,EAAE7M,EAAE,CAAC,MAAD,CAAP;EAAiBgC,QAAAA,CAAC,EAAE,MAAA;SAAtf;EAAggByQ,MAAAA,KAAK,EAAE;EAAE5F,QAAAA,CAAC,EAAE7M,EAAE,CAAC,WAAD,CAAP;EAAsBgC,QAAAA,CAAC,EAAE,UAAA;SAAhiB;EAA8iB0Q,MAAAA,KAAK,EAAE;EAAE7F,QAAAA,CAAC,EAAE7M,EAAE,CAAC,WAAD,CAAP;EAAsBgC,QAAAA,CAAC,EAAE,UAAA;SAA9kB;EAA4lB2Q,MAAAA,IAAI,EAAE;EAAE9F,QAAAA,CAAC,EAAE7M,EAAE,CAAC,MAAD,CAAP;EAAiBgC,QAAAA,CAAC,EAAE,MAAA;SAAtnB;EAAgoBV,MAAAA,KAAK,EAAE;EAAEuL,QAAAA,CAAC,EAAE7M,EAAE,CAAC,OAAD,CAAP;EAAkBgC,QAAAA,CAAC,EAAE,MAAA;SAA5pB;EAAsqB4Q,MAAAA,EAAE,EAAE;EAAE/F,QAAAA,CAAC,EAAE7M,EAAE,CAAC,UAAD,CAAP;EAAqBgC,QAAAA,CAAC,EAAE,MAAA;SAAlsB;EAA4sB6Q,MAAAA,EAAE,EAAE;EAAEhG,QAAAA,CAAC,EAAE7M,EAAE,CAAC,WAAD,CAAP;EAAsBgC,QAAAA,CAAC,EAAE,MAAA;SAAzuB;EAAmvB8Q,MAAAA,EAAE,EAAE;EAAEjG,QAAAA,CAAC,EAAE7M,EAAE,CAAC,MAAD,CAAP;EAAiBgC,QAAAA,CAAC,EAAE,MAAA;SAA3wB;EAAqxB+Q,MAAAA,EAAE,EAAE;EAAElG,QAAAA,CAAC,EAAE7M,EAAE,CAAC,OAAD,CAAP;EAAkBgC,QAAAA,CAAC,EAAE,MAAA;SAA9yB;EAAwzBgR,MAAAA,EAAE,EAAE;EAAEnG,QAAAA,CAAC,EAAE7M,EAAE,CAAC,UAAD,CAAP;EAAqBgC,QAAAA,CAAC,EAAE,MAAA;EAAxB,OAAA;OAAyC,EAAA,eAAA,CAAA,OAAA,EAAA,OAAA,EAAA;EAAE6K,MAAAA,CAAC,EAAE7M,EAAE,CAAC,OAAD,CAAP;EAAkBgC,MAAAA,CAAC,EAAE,MAAA;EAArB,KAAr2B,CAAy4B,EAAA,eAAA,CAAA,OAAA,EAAA,KAAA,EAAA;EAAE6K,MAAAA,CAAC,EAAE7M,EAAE,CAAC,KAAD,CAAP;EAAgBgC,MAAAA,CAAC,EAAE,MAAA;EAAnB,KAAz4B,CAA06B,EAAA,eAAA,CAAA,OAAA,EAAA,IAAA,EAAA;EAAE6K,MAAAA,CAAC,EAAE7M,EAAE,CAAC,MAAD,CAAP;EAAiBgC,MAAAA,CAAC,EAAE,MAAA;EAApB,KAA16B,CAA48B,EAAA,eAAA,CAAA,OAAA,EAAA,IAAA,EAAA;EAAE6K,MAAAA,CAAC,EAAE7M,EAAE,CAAC,MAAD,CAAP;EAAiBgC,MAAAA,CAAC,EAAE,MAAA;EAApB,KAA58B,CAA8+B,EAAA,eAAA,CAAA,OAAA,EAAA,IAAA,EAAA;EAAE6K,MAAAA,CAAC,EAAE7M,EAAE,CAAC,OAAD,CAAP;EAAkBgC,MAAAA,CAAC,EAAE,MAAA;EAArB,KAA9+B,CAAihC,EAAA,eAAA,CAAA,OAAA,EAAA,IAAA,EAAA;EAAE6K,MAAAA,CAAC,EAAE7M,EAAE,CAAC,MAAD,CAAP;EAAiBgC,MAAAA,CAAC,EAAE,MAAA;EAApB,KAAjhC,CAAmjC,EAAA,eAAA,CAAA,OAAA,EAAA,IAAA,EAAA;EAAE6K,MAAAA,CAAC,EAAE7M,EAAE,CAAC,WAAD,CAAP;EAAsBgC,MAAAA,CAAC,EAAE,MAAA;EAAzB,KAAnjC,CAA0lC,EAAA,eAAA,CAAA,OAAA,EAAA,IAAA,EAAA;EAAE6K,MAAAA,CAAC,EAAE7M,EAAE,CAAC,cAAD,CAAP;EAAyBgC,MAAAA,CAAC,EAAE,MAAA;EAA5B,KAA1lC,CAAsoC,EAAA,eAAA,CAAA,OAAA,EAAA,MAAA,EAAA;EAAE6K,MAAAA,CAAC,EAAE7M,EAAE,CAAC,MAAD,CAAP;EAAiBgC,MAAAA,CAAC,EAAE,UAAA;EAApB,KAAtoC,CAA4qC,EAAA,eAAA,CAAA,OAAA,EAAA,IAAA,EAAA;EAAE6K,MAAAA,CAAC,EAAE7M,EAAE,CAAC,QAAD,CAAP;EAAmBgC,MAAAA,CAAC,EAAE,MAAA;EAAtB,KAA5qC,CAAqtC,EAAA,eAAA,CAAA,OAAA,EAAA,SAAA,EAAA;EAAE6K,MAAAA,CAAC,EAAE7M,EAAE,CAAC,SAAD,CAAP;EAAoBgC,MAAAA,CAAC,EAAE,MAAA;EAAvB,KAArtC,CAA2vC,EAAA,eAAA,CAAA,OAAA,EAAA,KAAA,EAAA;EAAE6K,MAAAA,CAAC,EAAE7M,EAAE,CAAC,QAAD,CAAP;EAAmBgC,MAAAA,CAAC,EAAE,MAAA;EAAtB,KAA3vC,CAAkyC,EAAA,eAAA,CAAA,OAAA,EAAA,OAAA,EAAA;EAAE6K,MAAAA,CAAC,EAAE7M,EAAE,CAAC,OAAD,CAAP;EAAkBgC,MAAAA,CAAC,EAAE,MAAA;EAArB,KAAlyC,CAA60C,EAAA,eAAA,CAAA,OAAA,EAAA,YAAA,EAAA;EAAE6K,MAAAA,CAAC,EAAE7M,EAAE,CAAC,YAAD,CAAP;EAAuBgC,MAAAA,CAAC,EAAE,MAAA;EAA1B,KAA70C,CAAV,EAAA,OAAA,CAAA,CAAA;;EAGA,IAAA,KAAK,IAAIuJ,CAAT,IAAczD,MAAd,EAAsB;QAElB,IAAI/G,KAAK,CAACO,KAAN,CAAY8G,WAAZ,CAAwBmD,CAAxB,CAA+B2C,KAAAA,SAAnC,EAA8C,SAAA;QAE9C,IAAI/N,GAAG,GAAGY,KAAK,CAACO,KAAN,CAAY8G,WAAZ,CAAwBmD,CAAxB,CAAV,CAAA;EACA,MAAA,IAAItD,KAAK,GAAGH,MAAM,CAACyD,CAAD,CAAN,CAAUsB,CAAtB,CAAA;EAEAhG,MAAAA,IAAI,IACmC0E,sDAAAA,CAAAA,MAAAA,CAAAA,CADnC,EACwCA,GAAAA,CAAAA,CAAAA,MAAAA,CAAAA,CAAC,IAAI,KAAL,IAAcA,CAAC,IAAI,MAAnB,GAA4B,WAA5B,GAA0C,EADlF,EAEKtD,4BAAAA,CAAAA,CAAAA,MAAAA,CAAAA,KAFL,EAEiB8H,MAAAA,CAAAA,CAAAA,MAAAA,CAAAA,SAAO,CAACJ,WAAR,CAAoB5O,KAApB,EAA2B+G,MAAM,CAACyD,CAAD,CAAjC,EAAsCpL,GAAtC,EAA2CoL,CAA3C,CAFjB,EAAJ,sBAAA,CAAA,CAAA;EAIH,KAAA;;EAGD0H,IAAAA,UAAU,CAAC,YAAM;EAAElD,MAAAA,SAAO,CAACmD,aAAR,EAAA,CAAA;OAAT,EAAqC,GAArC,CAAV,CAAA;EAEArM,IAAAA,IAAI,IAAI,EAAR,CAAA;EACA9F,IAAAA,KAAK,CAAC0P,KAAN,CAAY3O,aAAZ,CAA0B,aAA1B,CAAyC6P,CAAAA,SAAzC,GAAqD,+BAAA,GAAkC9K,IAAlC,GAAyC,QAA9F,CAAA;;MAEA9F,KAAK,CAAC2P,SAAN,CAAgByC,IAAhB,EAAA,CAAA;;EAGApD,IAAAA,SAAO,CAACqD,uBAAR,EAAA,CAAA;MAGArD,SAAO,CAACsD,gBAAR,CAAyBtS,KAAzB,CAAA,CAAA;;EAGAA,IAAAA,KAAK,CAAC0P,KAAN,CAAY3O,aAAZ,CAA0B,YAA1B,CAAwCC,CAAAA,gBAAxC,CAAyD,MAAzD,EAAiE,UAACC,CAAD,EAAO;EAAEiR,MAAAA,UAAU,CAAC,YAAM;UAAEpR,QAAQ,CAACC,aAAT,CAAuB,SAAvB,EAAkC0F,OAAlC,CAA0C8L,MAA1C,GAAmD,KAAnD,CAAA;SAAT,EAAsE,GAAtE,CAAV,CAAA;OAA1E,CAAA,CAAA;;MAGAvD,SAAO,CAACwD,YAAR,CAAqBxS,KAArB,CAAA,CAAA;EAGA,IAAA,IAAIA,KAAK,CAACO,KAAN,CAAY8G,WAAZ,CAAwBnB,GAAxB,IAA+B,KAAnC,EAA0C8I,SAAO,CAACmD,aAAR,EAAA,CAAA;EAG1C,IAAA,IAAInS,KAAK,CAACO,KAAN,CAAY8G,WAAZ,CAAwBnB,GAAxB,IAA+B,KAAnC,EAA0CgM,UAAU,CAAC,YAAM;EAAEpR,MAAAA,QAAQ,CAACC,aAAT,CAAuB,YAAvB,EAAqC0R,KAArC,EAAA,CAAA;OAAT,EAA0D,GAA1D,CAAV,CAAA;KAhM3B;IAkMnBC,QAAQ,EAAE,SAAC1S,QAAAA,CAAAA,KAAD,EAAW;MAEjBgP,SAAO,CAAChP,KAAR,GAAgBA,KAAhB,CAAA;EACAd,IAAAA,SAAO,CAAC,YAAD,EAAe,UAAC+B,CAAD,EAAO;EAAE+N,MAAAA,SAAO,CAACQ,WAAR,CAAoBxP,KAApB,EAA2BiB,CAA3B,CAAA,CAAA;EAAgC,KAAxD,CAAP,CAAA;KArMe;IAuMnB0R,SAAS,EAAE,SAAC3S,SAAAA,CAAAA,KAAD,EAAW;MAElBgP,SAAO,CAAChP,KAAR,GAAgBA,KAAhB,CAAA;EACAd,IAAAA,SAAO,CAAC,aAAD,EAAgB,UAAC+B,CAAD,EAAO;EAAE+N,MAAAA,SAAO,CAACQ,WAAR,CAAoBxP,KAApB,EAA2BiB,CAA3B,CAAA,CAAA;EAAgC,KAAzD,CAAP,CAAA;KA1Me;IA4MnB2N,WAAW,EAAE,qBAAC5O,KAAD,EAAQgC,CAAR,EAAW6M,IAAX,EAAiBrE,CAAjB,EAAuB;MAEhC,IAAI1E,IAAI,GAAG,EAAX,CAAA;;MACA,QAAQ9D,CAAC,CAACf,CAAV;EAII,MAAA,KAAK,OAAL;EAEI6E,QAAAA,IAAI,GAAoB0E,iBAAAA,CAAAA,MAAAA,CAAAA,CAApB,EAAwDxI,sCAAAA,CAAAA,CAAAA,MAAAA,CAAAA,CAAC,CAAC8M,SAAF,GAAc9M,CAAC,CAAC8M,SAAhB,GAA4B,EAApF,oCAA+G9M,CAAC,CAAC+M,QAAF,GAAa,wBAAb,GAAwC,EAAvJ,EAAA,aAAA,CAAA,CAAA,MAAA,CAAsKvE,CAAtK,EAAwLqE,kBAAAA,CAAAA,CAAAA,MAAAA,CAAAA,IAAxL,EAAiM9O,KAAAA,CAAAA,CAAAA,MAAAA,CAAAA,WAAW,CAACC,KAAD,EAAQ6O,IAAR,CAA5M,EAAJ,QAAA,CAAA,CAAA;EACA,QAAA,OAAO/I,IAAP,CAAA;;EACJ,MAAA,KAAK,MAAL;UAEIA,IAAI,GAAA,iBAAA,CAAA,MAAA,CAAoB0E,CAApB,EAAA,gCAAA,CAAA,CAAA,MAAA,CAAkDxI,CAAC,CAAC8M,SAAF,GAAc9M,CAAC,CAAC8M,SAAhB,GAA4B,EAA9E,wCAA6G9M,CAAC,CAAC+M,QAAF,GAAa,wBAAb,GAAwC,EAArJ,EAAoKvE,aAAAA,CAAAA,CAAAA,MAAAA,CAAAA,CAApK,EAAkMqE,+BAAAA,CAAAA,CAAAA,MAAAA,CAAAA,IAAlM,EAAJ,QAAA,CAAA,CAAA;EACA,QAAA,OAAO/I,IAAP,CAAA;;EACJ,MAAA,KAAK,UAAL;UAAiB,OAAO,8FAAA,GAAiG0E,CAAjG,GAAqG,WAArG,GAAmHqE,IAAnH,GAA0H,IAA1H,GAAiIA,IAAjI,GAAwI,aAA/I,CAAA;;EACjB,MAAA,KAAK,OAAL;EAGI/I,QAAAA,IAAI,GAA0F7G,4FAAAA,CAAAA,MAAAA,CAAAA,EAAE,CAAC,SAAD,CAA5F,EAA+JA,2DAAAA,CAAAA,CAAAA,MAAAA,CAAAA,EAAE,CAAC,KAAD,CAAjK,EAA+NA,0DAAAA,CAAAA,CAAAA,MAAAA,CAAAA,EAAE,CAAC,OAAD,CAAjO,EAAJ,2BAAA,CAAA,CAAA;;EACA,QAAA,KAAK,IAAIuL,EAAT,IAAcqE,IAAd,EAAoB;EAAE/I,UAAAA,IAAI,IAAIkJ,SAAO,CAACC,oBAAR,CAA6BjP,KAA7B,EAAoCwK,EAApC,EAAuCqE,IAAvC,EAA6C,KAA7C,CAAR,CAAA;EAA8D,SAAA;;EAGpF/I,QAAAA,IAAI,IAG8E7G,2OAAAA,CAAAA,MAAAA,CAAAA,EAAE,CAAC,UAAD,CAHhF,EAAJ,kmEAAA,CAAA,CAAA;EA6BA6G,QAAAA,IAAI,IAAJ,qDAAA,CAAA;EAEA,QAAA,OAAOA,IAAP,CAAA;;EACJ,MAAA;EAEI,QAAA,IAAI0E,CAAC,IAAI,KAAT,EAAgBqE,IAAI,GAAGA,IAAI,CAAC7E,MAAL,CAAY,CAAZ,EAAe,CAAf,CAAP,CAAA;UAEhBlE,IAAI,GAAA,iBAAA,CAAA,MAAA,CAAoB0E,CAApB,EAAA,gCAAA,CAAA,CAAA,MAAA,CAAkDxI,CAAC,CAAC8M,SAAF,GAAc9M,CAAC,CAAC8M,SAAhB,GAA4B,EAA9E,oCAAyG9M,CAAC,CAAC+M,QAAF,GAAa,wBAAb,GAAwC,EAAjJ,EAAgKvE,aAAAA,CAAAA,CAAAA,MAAAA,CAAAA,CAAhK,EAAsKqE,KAAAA,CAAAA,CAAAA,MAAAA,CAAAA,IAAtK,EAAJ,QAAA,CAAA,CAAA;EACA,QAAA,OAAO/I,IAAP,CAAA;EAzDR,KAAA;KA/Me;IA2QnB8M,WAAW,EAAE,SAAC/D,WAAAA,CAAAA,IAAD,EAAU;MAEnB,IAAIgE,OAAO,svBAOkF5T,EAAE,CAAC,UAAD,CAPpF,EAAA,mHAAA,CAAA,CAAA,MAAA,CAQ+EA,EAAE,CAAC,eAAD,CARjF,EAS0EA,8GAAAA,CAAAA,CAAAA,MAAAA,CAAAA,EAAE,CAAC,cAAD,CAT5E,uIAUwFA,EAAE,CAAC,QAAD,CAV1F,EAAX,oDAAA,CAAA,CAAA;EAeA,IAAA,OAAO4T,OAAP,CAAA;KA5Re;EA8RnB5D,EAAAA,oBAAoB,EAAE,SAACjP,oBAAAA,CAAAA,KAAD,EAAQwK,CAAR,EAAWqE,IAAX,EAAmD;MAAA,IAAlCiE,KAAkC,uEAA1B,KAA0B,CAAA;MAAA,IAAnBD,OAAmB,uEAAT,IAAS,CAAA;;MAIrE,IAAI7S,KAAK,CAACoI,OAAN,IAAiByG,IAAI,CAACrE,CAAD,CAAJ,CAAQpC,OAA7B,EAAsC;QAAEpI,KAAK,CAAC+P,OAAN,IAAiB,CAAjB,CAAA;EAAqB,KAAA;;MAE7D/P,KAAK,CAACoI,OAAN,GAAgByG,IAAI,CAACrE,CAAD,CAAJ,CAAQpC,OAAxB,CAAA;MACAyG,IAAI,CAACrE,CAAD,CAAJ,CAAQjD,IAAR,GAAesH,IAAI,CAACrE,CAAD,CAAJ,CAAQjD,IAAR,GAAesH,IAAI,CAACrE,CAAD,CAAJ,CAAQjD,IAAvB,GAA8B,EAA7C,CAAA;MAGA,IAAIwL,IAAI,GAAG,EAAX;UAAetH,MAAM,GAAG,EAAxB,CAAA;;MACA,KAAK,IAAIzI,CAAT,IAAc6L,IAAI,CAACrE,CAAD,CAAJ,CAAQzH,UAAtB,EAAkC;QAG9B,IAAIqK,IAAI,GAAG,EAAX,CAAA;;EAAe,MAAA,KAAK,IAAItB,CAAT,IAAc+C,IAAI,CAACrE,CAAD,CAAJ,CAAQzH,UAAR,CAAmBC,CAAnB,CAAA,CAAsBoK,IAApC,EAAA;EAA0CA,QAAAA,IAAI,IAAIlK,MAAM,CAAC2L,IAAI,CAACrE,CAAD,CAAJ,CAAQzH,UAAR,CAAmBC,CAAnB,CAAA,CAAsBoK,IAAtB,CAA2BtB,CAA3B,EAA8B3I,KAA/B,CAAN,GAA8C,GAAtD,CAAA;EAA1C,OAAA;;QACf4P,IAAI,IAAI,0BAA0B7P,MAAM,CAAC2L,IAAI,CAACrE,CAAD,CAAJ,CAAQzH,UAAR,CAAmBC,CAAnB,CAAA,CAAsBG,KAAvB,CAAhC,GAAgE,aAAhE,GAAgFiK,IAAhF,GAAuF,gBAA/F,CAAA;QAGA,IAAIyB,IAAI,CAACrE,CAAD,CAAJ,CAAQzH,UAAR,CAAmBC,CAAnB,CAAA,CAAsByE,IAAtB,KAA+B0F,SAA/B,IAA4C0B,IAAI,CAACrE,CAAD,CAAJ,CAAQzH,UAAR,CAAmBC,CAAnB,CAAA,CAAsByE,IAAtB,CAA2BpI,MAA3B,GAAoC,CAApF,EAAuF0T,IAAI,IAAI,aAAa9T,EAAE,CAAC,MAAD,CAAf,GAA0B,OAA1B,GAAoC4P,IAAI,CAACrE,CAAD,CAAJ,CAAQzH,UAAR,CAAmBC,CAAnB,CAAA,CAAsByE,IAA1D,GAAiE,SAAzE,CAAA;EAC1F,KAAA;;MAED,IAAIuL,aAAa,GAAG,EAApB,CAAA;EACA,IAAA,IAAGnE,IAAI,CAACrE,CAAD,CAAJ,CAAQ5B,gBAAX,EAA6BoK,aAAa,GAAG,KAAA,GAAQnE,IAAI,CAACrE,CAAD,CAAJ,CAAQ5B,gBAAhB,GAAmC,IAAnD,CAAA;MAC7B,IAAGiG,IAAI,CAACrE,CAAD,CAAJ,CAAQ1B,cAAX,EAA2BkK,aAAa,GAAG,KAAQjT,GAAAA,WAAW,CAACC,KAAD,EAAQ6O,IAAI,CAACrE,CAAD,CAAJ,CAAQ1B,cAAhB,CAAnB,GAAqD,GAArE,CAAA;EAG3B,IAAA,IAAG,CAAC+F,IAAI,CAACrE,CAAD,CAAJ,CAAQyI,SAAZ,EAAuBpE,IAAI,CAACrE,CAAD,CAAJ,CAAQyI,SAAR,GAAoB,EAApB,CAAA;MACvBpE,IAAI,CAACrE,CAAD,CAAJ,CAAQyI,SAAR,CAAkBlN,OAAlB,CAA0B,UAAAmN,GAAG,EAAI;EAE9B,MAAA,IAAGA,GAAG,CAACjQ,IAAJ,IAAY,OAAf,EAAwB4L,IAAI,CAACrE,CAAD,CAAJ,CAAQ2I,aAAR,GAAwB,OAAxB,CAAA;OAF3B,CAAA,CAAA;EAKA1H,IAAAA,MAAM,IAAI,2CAA8CzL,GAAAA,KAAK,CAAC+P,OAApD,GAA8D,kBAA9D,GAAmFlB,IAAI,CAACrE,CAAD,CAAJ,CAAQpC,OAA3F,GAAqG,YAArG,GAAoHoC,CAApH,GAAwH,aAAxH,GAAwIqE,IAAI,CAACrE,CAAD,CAAJ,CAAQjE,EAAhJ,GAAqJ,eAArJ,GAAuK/C,QAAM,CAACW,IAAI,CAACC,SAAL,CAAeyK,IAAI,CAACrE,CAAD,CAAJ,CAAQzH,UAAvB,CAAD,CAA7K,GAAoN,eAApN,GAAsOS,QAAM,CAACW,IAAI,CAACC,SAAL,CAAeyK,IAAI,CAACrE,CAAD,CAAJ,CAAQjD,IAAvB,CAAD,CAA5O,GAA6Q,oBAA7Q,GAAoS/D,QAAM,CAACW,IAAI,CAACC,SAAL,CAAeyK,IAAI,CAACrE,CAAD,CAAJ,CAAQyI,SAAvB,CAAD,CAA1S,GAAgV,IAA1V,CAAA;MACAxH,MAAM,IAAI,qEAAqEoD,IAAI,CAACrE,CAAD,CAAJ,CAAQrH,KAA7E,GAAqF,gBAArF,IAAyG0L,IAAI,CAACrE,CAAD,CAAJ,CAAQ7C,KAAR,GAAgBkH,IAAI,CAACrE,CAAD,CAAJ,CAAQ7C,KAAxB,GAAgC,EAAzI,CAA+I,GAAA,IAA/I,GAAsJzE,MAAM,CAAC2L,IAAI,CAACrE,CAAD,CAAJ,CAAQrH,KAAT,CAA5J,GAA8K,8CAA9K,IAAgO,CAAC0L,IAAI,CAACrE,CAAD,CAAJ,CAAQ/C,IAAR,CAAapI,MAAb,IAAuB,CAAvB,IAA4BwP,IAAI,CAACrE,CAAD,CAAJ,CAAQ/C,IAAR,IAAgB,MAA7C,KAAwD,CAACqL,KAAzD,GAAiE,QAAjE,GAA4E,EAA5S,CAAA,GAAkT,uCAAlT,GAA4VjE,IAAI,CAACrE,CAAD,CAAJ,CAAQ/C,IAApW,GAA2W,IAA3W,GAAkXoH,IAAI,CAACrE,CAAD,CAAJ,CAAQ/C,IAA1X,GAAiY,gGAAjY,GAAoesL,IAApe,GAA2e,4EAA3e,GAA0jBlE,IAAI,CAACrE,CAAD,CAAJ,CAAQ9C,GAAlkB,GAAwkB,IAAxkB,GAA+kBmH,IAAI,CAACrE,CAAD,CAAJ,CAAQ9C,GAAvlB,GAA6lB,6EAA7lB,GAA6qBmH,IAAI,CAACrE,CAAD,CAAJ,CAAQvK,KAArrB,GAA6rB,gBAA7rB,GAAgtB4O,IAAI,CAACrE,CAAD,CAAJ,CAAQ5C,KAAxtB,GAAguB,wBAAhuB,IAA4vBiH,IAAI,CAACrE,CAAD,CAAJ,CAAQ2I,aAAR,GAAwBtE,IAAI,CAACrE,CAAD,CAAJ,CAAQ2I,aAAhC,GAAgD,EAA5yB,CAAA,GAAkzB,2BAAlzB,IAAi1BtE,IAAI,CAACrE,CAAD,CAAJ,CAAQ5B,gBAAR,GAA2BiG,IAAI,CAACrE,CAAD,CAAJ,CAAQ5B,gBAAnC,GAAsD,EAAv4B,CAAA,GAA64B,yBAA74B,IAA06BiG,IAAI,CAACrE,CAAD,CAAJ,CAAQ1B,cAAR,GAAyB+F,IAAI,CAACrE,CAAD,CAAJ,CAAQ1B,cAAjC,GAAkD,EAA59B,CAAk+B,GAAA,IAAl+B,GAAy+B/I,WAAW,CAACC,KAAD,EAAQ6O,IAAI,CAACrE,CAAD,CAAJ,CAAQ5C,KAAhB,CAAp/B,GAA6gCoL,aAA7gC,GAA6hC,mBAA7hC,IAAojCH,OAAO,GAAG,EAAH,GAAQ,QAAnkC,CAAA,GAA+kC,IAA/kC,GAAslC7D,SAAO,CAAC4D,WAAR,CAAoB/D,IAAI,CAACrE,CAAD,CAAxB,CAAtlC,GAAqnC,YAA/nC,CAAA;EACAiB,IAAAA,MAAM,IAAI,OAAV,CAAA;EAEA,IAAA,OAAOA,MAAP,CAAA;KAlUe;IAoUnB6G,gBAAgB,EAAE,SAACtS,gBAAAA,CAAAA,KAAD,EAAW;EAEzBoT,IAAAA,OAAO,CAAC,YAAD,EAAe,UAACnS,CAAD,EAAO;QAGzB,IAAI+F,GAAG,GAAG/F,CAAC,CAACoS,OAAF,IAAapS,CAAC,CAACqS,QAAzB,CAAA;;EACA,MAAA,IAAItM,GAAG,IAAI,EAAP,IAAaA,GAAG,IAAI,EAAxB,EAA4B;EAAE,QAAA,OAAA;EAAS,OAAA;;EAEvC,MAAA,IAAI4E,CAAC,GAAG3K,CAAC,CAACuF,aAAF,CAAgBjF,KAAxB,CAAA;EAEA,MAAA,IAAIqK,CAAC,CAACvM,MAAF,IAAY,CAAhB,EAAmByB,QAAQ,CAACC,aAAT,CAAuB,aAAvB,CAAA,CAAsCwS,QAAtC,CAA+C;UAC9DC,GAAG,EAAG1S,QAAQ,CAACC,aAAT,CAAuB,YAAvB,CAAA,CAAqC0S,qBAArC,EAA6DD,CAAAA,GAA7D,GAAmE1S,QAAQ,CAACC,aAAT,CAAuB,kBAAvB,EAA2C0S,qBAA3C,EAAA,CAAmED,GAAvI,GAA8I,EADrF;EAE9DE,QAAAA,QAAQ,EAAE,QAAA;SAFK,CAAA,CAAA;;EAMnB,MAAA,IAAI9H,CAAC,CAACvM,MAAF,IAAY,CAAZ,IAAiB4B,CAAC,CAACuF,aAAF,KAAoB1F,QAAQ,CAAC6S,aAAlD,EAAiE;UAAE7S,QAAQ,CAACC,aAAT,CAAuB,SAAvB,EAAkC0F,OAAlC,CAA0C8L,MAA1C,GAAmD,KAAnD,CAAA;EAA0D,QAAA,OAAA;EAAS,OAAA;;QAGtIxO,KAAK,CAAC,8BAAD,EAAiC;EAClCC,QAAAA,MAAM,EAAE,MAD0B;EAElCC,QAAAA,OAAO,EAAEA,OAFyB;EAGlCC,QAAAA,IAAI,EAAEC,IAAI,CAACC,SAAL,CAAe;EACjBC,UAAAA,KAAK,EAAE;EACHyC,YAAAA,QAAQ,EAAE;EACN7D,cAAAA,IAAI,EAAE,MADA;EAEN+D,cAAAA,GAAG,EAAE,mBAFC;EAGND,cAAAA,MAAM,EAAE,CAAC,KAAD,EAAQ,IAAR,EAAc,KAAd,EAAqB,QAArB,EAA+B,MAA/B,EAAuC,YAAvC,EAAqD,OAArD,EAA8D,WAA9D,EAA2E,OAA3E,CAHF;EAIN6M,cAAAA,KAAK,EAAE5T,KAAK,CAACO,KAAN,CAAYsT,KAJb;EAMNC,cAAAA,IAAI,EAAE,CACF;EACI7Q,gBAAAA,IAAI,EAAE,QADV;EAEIiE,gBAAAA,KAAK,EAAE,QAFX;EAGI6M,gBAAAA,QAAQ,EAAE,GAHd;EAIIxS,gBAAAA,KAAK,EAAE,GAAA;EAJX,eADE,CANA;gBAcNyS,MAAM,EAAEpI,CAAC,CAACvM,MAAF,GAAW,CAAX,GAAe,CAAf,GAAmBC,aAAa,KAAKU,KAAK,CAACO,KAAN,CAAYsT,KAA9B,GAAsC7T,KAAK,CAACO,KAAN,CAAYsT,KAdvE;EAeNlU,cAAAA,MAAM,EAAE;EACJuH,gBAAAA,KAAK,EAAE,OADH;EAEJ0E,gBAAAA,CAAC,EAAEA,CAAAA;iBAjBD;EAmBN3E,cAAAA,MAAM,EAAE;EACJC,gBAAAA,KAAK,EAAE,OADH;EAEJC,gBAAAA,KAAK,EAAE,MAAA;EAFH,eAAA;EAnBF,aAAA;EADP,WAAA;WADL,CAAA;EAH4B,OAAjC,CAAL,CAgCK5C,IAhCL,CAgCU,UAAAC,QAAQ,EAAA;UAAA,OAAIA,QAAQ,CAACC,IAAT,EAAJ,CAAA;EAAA,OAhClB,CAiCKF,CAAAA,IAjCL,CAiCU,UAAAC,QAAQ,EAAI;UAGdyP,UAAU,EAAA,CAAA;;UAIV,IAAIzP,QAAQ,CAACE,OAAb,EAAsB;EAElB1E,UAAAA,KAAK,CAACO,KAAN,CAAY2T,mBAAZ,GAAkC1P,QAAQ,CAACsC,QAA3C,CAAA;EAEA,UAAA,IAAI+L,OAAO,GAAX,EAAA,CAAA;YACArO,QAAQ,CAACsC,QAAT,CAAkBf,OAAlB,CAA0B,UAAClD,OAAD,EAAU2E,KAAV,EAAoB;EAG1CqL,YAAAA,OAAO,IAA6ChQ,2CAAAA,CAAAA,MAAAA,CAAAA,OAAO,CAACqD,GAArD,6BAAyErD,OAAO,CAACM,KAAjF,EAAA,kBAAA,CAAA,CAAA,MAAA,CAAuGqE,KAAvG,EAAA,qDAAA,CAAA,CAAA,MAAA,CAA6J3E,OAAO,CAACM,KAArK,EAAP,OAAA,CAAA,CAAA;aAHJ,CAAA,CAAA;EAKArC,UAAAA,QAAQ,CAACC,aAAT,CAAuB,SAAvB,CAAkC6P,CAAAA,SAAlC,GAA8CiC,OAA9C,CAAA;YACA/R,QAAQ,CAACC,aAAT,CAAuB,SAAvB,EAAkC0F,OAAlC,CAA0C8L,MAA1C,GAAmD,IAAnD,CAAA;EAGArT,UAAAA,SAAO,CAAC,cAAD,EAAiB,UAAC+B,CAAD,EAAO;cAE3B,IAAIuG,KAAK,GAAGvG,CAAC,CAACuF,aAAF,CAAgBC,OAAhB,CAAwBe,KAApC,CAAA;cAEAK,OAAO,CAACC,GAAR,CAAY9H,KAAK,CAACO,KAAN,CAAY2T,mBAAZ,CAAgC1M,KAAhC,CAAZ,CAAA,CAAA;cAGA1G,QAAQ,CAACC,aAAT,CAAuB,YAAvB,EAAqC0F,OAArC,CAA6Ce,KAA7C,GAAqDA,KAArD,CAAA;EACA1G,YAAAA,QAAQ,CAACC,aAAT,CAAuB,YAAvB,CAAA,CAAqC0F,OAArC,CAA6CF,EAA7C,GAAkDvG,KAAK,CAACO,KAAN,CAAY2T,mBAAZ,CAAgC1M,KAAhC,EAAuCtB,GAAzF,CAAA;cACApF,QAAQ,CAACC,aAAT,CAAuB,YAAvB,EAAqC0F,OAArC,CAA6Cc,IAA7C,GAAoDpD,IAAI,CAACC,SAAL,CAAepE,KAAK,CAACO,KAAN,CAAY2T,mBAAZ,CAAgC1M,KAAhC,CAAuCD,CAAAA,IAAtD,CAApD,CAAA;EACAzG,YAAAA,QAAQ,CAACC,aAAT,CAAuB,YAAvB,EAAqCQ,KAArC,GAA6CvB,KAAK,CAACO,KAAN,CAAY2T,mBAAZ,CAAgC1M,KAAhC,EAAuCrE,KAApF,CAAA;cACArC,QAAQ,CAACC,aAAT,CAAuB,YAAvB,EAAqC0F,OAArC,CAA6CwM,SAA7C,GAAyD9O,IAAI,CAACC,SAAL,CAAepE,KAAK,CAACO,KAAN,CAAY2T,mBAAZ,CAAgC1M,KAAhC,CAAuCyL,CAAAA,SAAtD,CAAzD,CAAA;EACAnS,YAAAA,QAAQ,CAACC,aAAT,CAAuB,WAAvB,CAAoCQ,CAAAA,KAApC,GAA4C,CAA5C,CAAA;EACAT,YAAAA,QAAQ,CAACC,aAAT,CAAuB,WAAvB,CAAA,CAAoC0F,OAApC,CAA4CxG,KAA5C,GAAoDD,KAAK,CAACO,KAAN,CAAY2T,mBAAZ,CAAgC1M,KAAhC,EAAuCvH,KAA3F,CAAA;EACAa,YAAAA,QAAQ,CAACC,aAAT,CAAuB,UAAvB,EAAmCQ,KAAnC,GAA2CvB,KAAK,CAACO,KAAN,CAAY2T,mBAAZ,CAAgC1M,KAAhC,EAAuCvH,KAAlF,CAAA;EACAa,YAAAA,QAAQ,CAACC,aAAT,CAAuB,UAAvB,CAAA,CAAmC0F,OAAnC,CAA2CxG,KAA3C,GAAmDD,KAAK,CAACO,KAAN,CAAY2T,mBAAZ,CAAgC1M,KAAhC,EAAuCvH,KAA1F,CAAA;cACAa,QAAQ,CAACC,aAAT,CAAuB,SAAvB,EAAkC0F,OAAlC,CAA0C8L,MAA1C,GAAmD,KAAnD,CAAA;cACAzR,QAAQ,CAACC,aAAT,CAAuB,gBAAvB,EAAyC+N,SAAzC,CAAmDkC,GAAnD,CAAuD,QAAvD,CAAA,CAAA;cAEA,IAAIhR,KAAK,CAACO,KAAN,CAAY2T,mBAAZ,CAAgC1M,KAAhC,CAAA,CAAuCyL,SAA3C,EAAsD,IAAIjT,KAAK,CAACO,KAAN,CAAY2T,mBAAZ,CAAgC1M,KAAhC,CAAA,CAAuCyL,SAAvC,CAAiD5T,MAAjD,GAA0D,CAA9D,EAAiE;gBAEnH,IAAI8U,gBAAgB,GAAG,6BAAvB,CAAA;;EACAnU,cAAAA,KAAK,CAACO,KAAN,CAAY2T,mBAAZ,CAAgC1M,KAAhC,CAAuCyL,CAAAA,SAAvC,CAAiDlN,OAAjD,CAAyD,UAAAqO,QAAQ,EAAI;kBACjE,IAAIA,QAAQ,CAACC,YAAT,IAAyB,OAAzB,IAAoCD,QAAQ,CAACnR,IAAT,IAAiB,SAAzD,EAAoE;EAEhEkR,kBAAAA,gBAAgB,IAAI,qCAAA,GAAwCC,QAAQ,CAACE,OAAjD,GAA2D,KAA3D,GAAmEF,QAAQ,CAACE,OAA5E,GAAsF,YAA1G,CAAA;oBACAxT,QAAQ,CAACC,aAAT,CAAuB,gBAAvB,EAAyC+N,SAAzC,CAAmDH,MAAnD,CAA0D,QAA1D,CAAA,CAAA;EACH,iBAAA;;kBACD,IAAIyF,QAAQ,CAACC,YAAT,IAAyB,OAAzB,IAAoCD,QAAQ,CAACnR,IAAT,IAAiB,OAAzD,EAAkE;EAE9DkR,kBAAAA,gBAAgB,IAAI,mCAAsCC,GAAAA,QAAQ,CAAC7S,KAA/C,GAAuD,KAAvD,GAA+DxB,WAAW,CAACiP,SAAO,CAAChP,KAAT,EAAgBoU,QAAQ,CAAC7S,KAAzB,CAA1E,GAA4G,WAAhI,CAAA;oBACAT,QAAQ,CAACC,aAAT,CAAuB,gBAAvB,EAAyC+N,SAAzC,CAAmDH,MAAnD,CAA0D,QAA1D,CAAA,CAAA;EACH,iBAAA;;EACD,gBAAA,IAAIyF,QAAQ,CAACnR,IAAT,IAAiB,OAArB,EAA8B,CAG7B;iBAdL,CAAA,CAAA;;EAiBAnC,cAAAA,QAAQ,CAACC,aAAT,CAAuB,gBAAvB,CAAyC6P,CAAAA,SAAzC,GAAqDuD,gBAArD,CAAA;EAEAI,cAAAA,QAAQ,CAAC,gBAAD,EAAmB,UAAAtT,CAAC,EAAI;EAE5BiR,gBAAAA,UAAU,CAAC,YAAM;oBAAEsC,aAAa,EAAA,CAAA;mBAAtB,EAA6B,GAA7B,CAAV,CAAA;EACH,eAHO,CAAR,CAAA;EAIH,aAAA;;EAED,YAAA,IAAIA,aAAa,GAAG,SAAhBA,aAAgB,GAAM;gBAEtB,IAAIrB,aAAa,GAAGrS,QAAQ,CAACC,aAAT,CAAuB,gBAAvB,EAAyC8R,OAAzC,CAAiD/R,QAAQ,CAACC,aAAT,CAAuB,gBAAvB,CAAA,CAAyC0T,aAA1F,CAAyGhO,CAAAA,OAAzG,CAAiHxD,IAArI,CAAA;gBACA,IAAI2E,KAAK,GAAGvH,UAAU,CAACS,QAAQ,CAACC,aAAT,CAAuB,WAAvB,CAAA,CAAoCQ,KAArC,CAAV,GAAwDlB,UAAU,CAACS,QAAQ,CAACC,aAAT,CAAuB,WAAvB,CAAoC0F,CAAAA,OAApC,CAA4CxG,KAA7C,CAA9E,CAAA;;EACA,cAAA,IAAImB,KAAK,CAACwG,KAAD,CAAT,EAAkB;EACdA,gBAAAA,KAAK,GAAG,EAAR,CAAA;EACH,eAFD,MAEO;kBAEH,IAAIuL,aAAa,IAAI,SAArB,EAAgC;EAC5BvL,kBAAAA,KAAK,GAAGA,KAAK,GAAIA,KAAK,GAAG9H,QAAQ,CAACgB,QAAQ,CAACC,aAAT,CAAuB,gBAAvB,CAAA,CAAyCQ,KAA1C,CAAhB,GAAmE,GAApF,CAAA;EACH,iBAAA;;kBAED,IAAI4R,aAAa,IAAI,OAArB,EAA8B;EAC1BvL,kBAAAA,KAAK,GAAGA,KAAK,GAAGvH,UAAU,CAACS,QAAQ,CAACC,aAAT,CAAuB,gBAAvB,CAAyCQ,CAAAA,KAA1C,CAA1B,CAAA;EACH,iBAAA;EACJ,eAAA;;EACDT,cAAAA,QAAQ,CAACC,aAAT,CAAuB,UAAvB,CAAmCQ,CAAAA,KAAnC,GAA2CqG,KAA3C,CAAA;eAhBJ,CAAA;;cAoBA9G,QAAQ,CAACC,aAAT,CAAuB,WAAvB,CAAA,CAAoCC,gBAApC,CAAqD,UAArD,EAAiE,UAACC,CAAD,EAAO;EAGpE,cAAA,IAAIA,CAAC,CAACE,KAAF,IAAW,CAAX,IAAgBC,KAAK,CAACC,MAAM,CAACC,YAAP,CAAoBL,CAAC,CAACE,KAAtB,CAAD,CAAzB,EAAyD;EAErDF,gBAAAA,CAAC,CAACO,cAAF,EAAA,CAAA;EACA,gBAAA,OAAO,KAAP,CAAA;EACH,eAAA;eAPL,CAAA,CAAA;cAWAV,QAAQ,CAACC,aAAT,CAAuB,WAAvB,CAAA,CAAoCC,gBAApC,CAAqD,SAArD,EAAgE,UAACC,CAAD,EAAO;EAGnEiR,cAAAA,UAAU,CAAC,YAAM;kBAAEsC,aAAa,EAAA,CAAA;iBAAtB,EAA6B,GAA7B,CAAV,CAAA;eAHJ,CAAA,CAAA;cAQA1T,QAAQ,CAACC,aAAT,CAAuB,UAAvB,CAAA,CAAmCC,gBAAnC,CAAoD,UAApD,EAAgE,UAACC,CAAD,EAAO;gBAGnE,IAAIA,CAAC,CAACE,KAAF,IAAW,CAAX,IAAgBF,CAAC,CAACE,KAAF,IAAW,EAA3B,IAAiCC,KAAK,CAACC,MAAM,CAACC,YAAP,CAAoBL,CAAC,CAACE,KAAtB,CAAD,CAA1C,EAA0E;EAEtEF,gBAAAA,CAAC,CAACO,cAAF,EAAA,CAAA;EACA,gBAAA,OAAO,KAAP,CAAA;EACH,eAAA;eAPL,CAAA,CAAA;EAWAV,YAAAA,QAAQ,CAACC,aAAT,CAAuB,WAAvB,EAAoC0R,KAApC,EAAA,CAAA;EACA3R,YAAAA,QAAQ,CAACC,aAAT,CAAuB,WAAvB,EAAoC2T,MAApC,EAAA,CAAA;EAIA5T,YAAAA,QAAQ,CAACC,aAAT,CAAuB,kBAAvB,CAA2C6P,CAAAA,SAA3C,GAAuDhO,eAAe,CAAC5C,KAAD,EAAQA,KAAK,CAACO,KAAN,CAAY2T,mBAAZ,CAAgC1M,KAAhC,CAAR,CAAtE,CAAA;EAEH,WAxGM,CAAP,CAAA;EA0GH,SAxHD,MAwHO;YAEHO,aAAa,CAACvD,QAAD,CAAb,CAAA;EACH,SAAA;SAnKT,CAAA,CAAA,OAAA,CAAA,CAqKW,UAAAK,KAAK,EAAI;UAAEgD,OAAO,CAACC,GAAR,CAAYjD,KAAZ,CAAA,CAAA;UAAoBkD,aAAa,CAAClD,KAAD,CAAb,CAAA;SArK1C,CAAA,CAAA;EAuKH,KAxLM,CAAP,CAAA;KAtUe;IAggBnBwN,uBAAuB,EAAE,SAACpR,uBAAAA,CAAAA,CAAD,EAAO;EAG5B/B,IAAAA,SAAO,CAAC,iBAAD,EAAoB,UAAC+B,CAAD,EAAO;EAE9BA,MAAAA,CAAC,CAACO,cAAF,EAAA,CAAA;EAEA,MAAA,IAAImT,MAAM,GAAG1T,CAAC,CAACuF,aAAF,CAAgBoO,aAAhB,CAA8BA,aAA9B,CAA4CA,aAA5C,CAA0DA,aAA1D,CAAwEA,aAAxE,CAAsF7T,aAAtF,CAAoG,YAApG,CAAb,CAAA;EAEA4T,MAAAA,MAAM,CAAC7F,SAAP,CAAiBH,MAAjB,CAAwB,QAAxB,CAAA,CAAA;EACAgG,MAAAA,MAAM,CAAClC,KAAP,EAAA,CAAA;EAEAzD,MAAAA,SAAO,CAAChP,KAAR,CAAcO,KAAd,CAAoBkP,OAApB,GAA8B,IAA9B,CAAA;EACH,KAVM,CAAP,CAAA;EAaAvQ,IAAAA,SAAO,CAAC,cAAD,EAAiB,UAAC+B,CAAD,EAAO;EAE3BA,MAAAA,CAAC,CAACO,cAAF,EAAA,CAAA;EAEAP,MAAAA,CAAC,CAACuF,aAAF,CAAgBoO,aAAhB,CAA8BA,aAA9B,CAA4CA,aAA5C,CAA0DA,aAA1D,CAAwEA,aAAxE,CAAsFjG,MAAtF,EAAA,CAAA;EAGAK,MAAAA,SAAO,CAACmD,aAAR,EAAA,CAAA;EAEAnD,MAAAA,SAAO,CAAChP,KAAR,CAAcO,KAAd,CAAoBkP,OAApB,GAA8B,IAA9B,CAAA;EACH,KAVM,CAAP,CAAA;KAhhBe;EA4hBnB0C,EAAAA,aAAa,EAAE,SAAM,aAAA,GAAA;EAEjB,IAAA,IAAIrM,IAAI,GAAR,EAAA;UAAe+O,gBAAgB,GAAG,CAAlC,CAAA;;EAFiB,IAAA,IAAA,SAAA,GAAA,0BAAA,CAKC/T,QAAQ,CAACY,gBAAT,CAA0B,aAA1B,CALD,CAAA;EAAA,QAAA,KAAA,CAAA;;EAAA,IAAA,IAAA;QAKjB,KAA2D,SAAA,CAAA,CAAA,EAAA,EAAA,CAAA,CAAA,KAAA,GAAA,SAAA,CAAA,CAAA,EAAA,EAAA,IAAA,GAAA;EAAA,QAAA,IAAlDzB,MAAkD,GAAA,KAAA,CAAA,KAAA,CAAA;UAAE4U,gBAAgB,IAAI3U,UAAU,CAACD,MAAK,CAACwG,OAAN,CAAclF,KAAf,CAA9B,CAAA;EAAsD,OAAA;EALlG,KAAA,CAAA,OAAA,GAAA,EAAA;EAAA,MAAA,SAAA,CAAA,CAAA,CAAA,GAAA,CAAA,CAAA;EAAA,KAAA,SAAA;EAAA,MAAA,SAAA,CAAA,CAAA,EAAA,CAAA;EAAA,KAAA;EAQjB,IAAA,IAAItB,KAAK,GAAG;EAAE+I,MAAAA,WAAW,EAAE,CAAf;EAAkBpB,MAAAA,KAAK,EAAE1H,UAAU,CAAC2U,gBAAD,CAAnC;EAAuDjM,MAAAA,gBAAgB,EAAE9H,QAAQ,CAACC,aAAT,CAAuB,uBAAvB,CAAkDjB,GAAAA,QAAQ,CAACgB,QAAQ,CAACC,aAAT,CAAuB,uBAAvB,CAAgDQ,CAAAA,KAAjD,CAA1D,GAAoHyN,SAAO,CAACzO,KAAR,CAAc8G,WAAd,CAA0B,OAA1B,CAAmC,CAAA,kBAAnC,IAAyD2H,SAAO,CAACzO,KAAR,CAAc8G,WAAd,CAA0B,OAA1B,EAAmC,kBAAnC,CAAzD,GAAkH,CAA/S;EAAkTyB,MAAAA,cAAc,EAAEhI,QAAQ,CAACC,aAAT,CAAuB,qBAAvB,CAAgDV,GAAAA,UAAU,CAACS,QAAQ,CAACC,aAAT,CAAuB,qBAAvB,CAA8CQ,CAAAA,KAA/C,CAA1D,GAAkHyN,SAAO,CAACzO,KAAR,CAAc8G,WAAd,CAA0B,OAA1B,CAAmC,CAAA,gBAAnC,IAAuD2H,SAAO,CAACzO,KAAR,CAAc8G,WAAd,CAA0B,OAA1B,EAAmC,gBAAnC,CAAvD,GAA8G,CAAliB;EAAqiBwB,MAAAA,cAAc,EAAE,CAArjB;EAAwjBE,MAAAA,SAAS,EAAE,CAAnkB;EAAskBI,MAAAA,SAAS,EAAE,CAAjlB;EAAolBD,MAAAA,WAAW,EAAE,CAAA;OAA7mB,CAAA;EAGA,IAAA,IAAI4L,kBAAkB,GAET5R,+GAAAA,CAAAA,MAAAA,CAAAA,MAAM,CAAC,UAAD,CAFG,EAEyEnD,mEAAAA,CAAAA,CAAAA,MAAAA,CAAAA,WAAW,CAACiP,SAAO,CAAChP,KAAT,EAAgBC,KAAK,CAAC2H,KAAtB,CAFpF,EAAtB,6BAAA,CAAA,CAAA;EAKA9B,IAAAA,IAAI,IAAIgP,kBAAR,CAAA;;MAKA,IAAI9F,SAAO,CAAChP,KAAR,CAAcO,KAAd,CAAoBC,QAApB,CAA6BuU,qBAA7B,IAAsD,GAA1D,EAA+D;QAE3D,IAAIlC,OAAO,GAAG,EAAd,CAAA;;QACA7D,SAAO,CAAChP,KAAR,CAAcO,KAAd,CAAoBC,QAApB,CAA6BwU,eAA7B,CAA6CxG,IAA7C,GAAoDhD,KAApD,CAA0D,IAA1D,CAAgEzF,CAAAA,OAAhE,CAAwE,UAACW,EAAD,EAAKU,CAAL,EAAW;UAE/EyL,OAAO,IAAA,kBAAA,CAAA,MAAA,CAAsBnM,EAAtB,EAA6BsI,KAAAA,CAAAA,CAAAA,MAAAA,CAAAA,SAAO,CAACzO,KAAR,CAAc8G,WAAd,CAA0BpH,KAA1B,CAAgC,gBAAhC,CAAA,IAAqDyG,EAArD,GAA0D,UAA1D,GAAuE,EAApG,EAAA,IAAA,CAAA,CAAA,MAAA,CAA2GA,EAA3G,EAAP,WAAA,CAAA,CAAA;SAFJ,CAAA,CAAA;;QAKA,IAAIuO,uBAAuB,mIAEdhW,EAAE,CAAC,SAAD,CAFY,EAAA,sPAAA,CAAA,CAAA,MAAA,CAKT4T,OALS,EAA3B,yFAAA,CAAA,CAAA;EAUA/M,MAAAA,IAAI,IAAImP,uBAAR,CAAA;EACH,KAAA;;EAED,IAAA,IAAInU,QAAQ,CAACC,aAAT,CAAuB,uBAAvB,CAAJ,EAAqD;EAAED,MAAAA,QAAQ,CAACC,aAAT,CAAuB,uBAAvB,CAAgDmU,CAAAA,SAAhD,GAA4DJ,kBAA5D,CAAA;EAAiF,KAAA;;EAGxIhP,IAAAA,IAAI,IAGUzF,sWAAAA,CAAAA,MAAAA,CAAAA,UAAU,CAACJ,KAAK,CAAC6I,cAAP,CAAV,GAAmC,CAAnC,GAAuC7J,EAAE,CAAC,mBAAD,CAAzC,GAAiEA,EAAE,CAAC,eAAD,CAH7E,EAAA,oOAAA,CAAA,CAAA,MAAA,CAMwEA,EAAE,CAAC,eAAD,CAN1E,EAOsEA,mGAAAA,CAAAA,CAAAA,MAAAA,CAAAA,EAAE,CAAC,mBAAD,CAPxE,EAWgIoB,gSAAAA,CAAAA,CAAAA,MAAAA,CAAAA,UAAU,CAACJ,KAAK,CAAC6I,cAAP,CAAV,GAAmC,CAAnC,GAAuC,QAAvC,GAAkD,EAXlL,EAAA,aAAA,CAAA,CAAA,MAAA,CAWgM7I,KAAK,CAAC2I,gBAXtM,EAY0EvI,0HAAAA,CAAAA,CAAAA,MAAAA,CAAAA,UAAU,CAACJ,KAAK,CAAC6I,cAAP,CAAV,GAAmC,CAAnC,GAAuC,EAAvC,GAA4C,QAZtH,EAAA,mDAAA,CAAA,CAAA,MAAA,CAYgL7I,KAAK,CAAC6I,cAZtL,EAAJ,4EAAA,CAAA,CAAA;;MAkBA,IAAIhJ,QAAQ,CAACG,KAAK,CAAC2I,gBAAP,CAAR,GAAmC,CAAvC,EAA0C;QAQtC3I,KAAK,CAAC4I,cAAN,GAAuB,CAAvB,CAAA;;EARsC,MAAA,IAAA,UAAA,GAAA,0BAAA,CASf/H,QAAQ,CAACY,gBAAT,CAA0B,aAA1B,CATe,CAAA;EAAA,UAAA,MAAA,CAAA;;EAAA,MAAA,IAAA;UAStC,KAAgE,UAAA,CAAA,CAAA,EAAA,EAAA,CAAA,CAAA,MAAA,GAAA,UAAA,CAAA,CAAA,EAAA,EAAA,IAAA,GAAA;EAAA,UAAA,IAAvDyT,UAAuD,GAAA,MAAA,CAAA,KAAA,CAAA;EAE5D,UAAA,IAAGA,UAAU,CAAC1O,OAAX,CAAmB0M,aAAnB,IAAoC,OAAvC,EAAgDlT,KAAK,CAAC4I,cAAN,IAAwB3I,UAAU,CAAEJ,QAAQ,CAACG,KAAK,CAAC2I,gBAAP,CAAT,GAAqC1I,UAAU,CAACiV,UAAU,CAAC1O,OAAX,CAAmBlF,KAApB,CAAhD,CAAV,GAAwF,GAAhH,CAAA;EACnD,SAAA;EAZqC,OAAA,CAAA,OAAA,GAAA,EAAA;EAAA,QAAA,UAAA,CAAA,CAAA,CAAA,GAAA,CAAA,CAAA;EAAA,OAAA,SAAA;EAAA,QAAA,UAAA,CAAA,CAAA,EAAA,CAAA;EAAA,OAAA;;QActCsT,gBAAgB,IAAI5U,KAAK,CAAC4I,cAA1B,CAAA;EACH,KAAA;;MAGD,IAAIxI,UAAU,CAACJ,KAAK,CAAC6I,cAAP,CAAV,GAAmC,CAAvC,EAA0C;QAEtC,IAAIzI,UAAU,CAACJ,KAAK,CAAC6I,cAAP,CAAV,GAAmC,CAAvC,EAA0C;UAEtC+L,gBAAgB,IAAI5U,KAAK,CAAC6I,cAA1B,CAAA;EACH,OAAA;EACJ,KAAA;;MAGD,IAAIkG,SAAO,CAAChP,KAAR,CAAcO,KAAd,CAAoBC,QAApB,CAA6B4U,QAA7B,IAAyC,GAA7C,EAAkD;EAG9CnV,MAAAA,KAAK,CAAC8I,SAAN,GAAkB7I,UAAU,CAAE8O,SAAO,CAAChP,KAAR,CAAcO,KAAd,CAAoBC,QAApB,CAA6B6U,WAA9B,GAA6CR,gBAA9C,CAAV,GAA4E,GAA9F,CAAA;EACA5U,MAAAA,KAAK,CAACoV,WAAN,GAAoBnV,UAAU,CAAC8O,SAAO,CAAChP,KAAR,CAAcO,KAAd,CAAoBC,QAApB,CAA6B6U,WAA9B,CAA9B,CAAA;QAEA,IAAIC,aAAa,GAEJrW,mGAAAA,CAAAA,MAAAA,CAAAA,EAAE,CAAC+P,SAAO,CAAChP,KAAR,CAAcO,KAAd,CAAoBC,QAApB,CAA6ByK,WAA9B,CAFE,EAAA,mEAAA,CAAA,CAAA,MAAA,CAEwGlL,WAAW,CAACiP,SAAO,CAAChP,KAAT,EAAgBC,KAAK,CAAC8I,SAAtB,CAFnH,EAAjB,iCAAA,CAAA,CAAA;EAKAjD,MAAAA,IAAI,IAAIwP,aAAR,CAAA;;EAEA,MAAA,IAAIxU,QAAQ,CAACC,aAAT,CAAuB,kBAAvB,CAAJ,EAAgD;EAAED,QAAAA,QAAQ,CAACC,aAAT,CAAuB,kBAAvB,CAA2CmU,CAAAA,SAA3C,GAAuDI,aAAvD,CAAA;EAAuE,OAAA;;QAIzHT,gBAAgB,IAAI5U,KAAK,CAAC8I,SAA1B,CAAA;EACH,KAAA;;MAGD,IAAIiG,SAAO,CAAChP,KAAR,CAAcO,KAAd,CAAoBC,QAApB,CAA6B+U,QAA7B,IAAyC,GAA7C,EAAkD;QAG9CtV,KAAK,CAACkJ,SAAN,GAAkBjJ,UAAU,CAAG2U,gBAAD,GAAqBxU,UAAU,CAAC2O,SAAO,CAAChP,KAAR,CAAcO,KAAd,CAAoBC,QAApB,CAA6B0I,WAA9B,CAAhC,GAA8E,GAA/E,CAA5B,CAAA;EACAjJ,MAAAA,KAAK,CAACiJ,WAAN,GAAoBhJ,UAAU,CAAC8O,SAAO,CAAChP,KAAR,CAAcO,KAAd,CAAoBC,QAApB,CAA6B0I,WAA9B,CAA9B,CAAA;QACA,IAAIsM,aAAa,8GAEJxG,SAAO,CAAChP,KAAR,CAAcO,KAAd,CAAoBC,QAApB,CAA6B0K,WAFzB,8EAEoGnL,WAAW,CAACiP,SAAO,CAAChP,KAAT,EAAgBC,KAAK,CAACkJ,SAAtB,CAF/G,EAAjB,iCAAA,CAAA,CAAA;EAKArD,MAAAA,IAAI,IAAI0P,aAAR,CAAA;;EAEA,MAAA,IAAI1U,QAAQ,CAACC,aAAT,CAAuB,kBAAvB,CAAJ,EAAgD;EAAED,QAAAA,QAAQ,CAACC,aAAT,CAAuB,kBAAvB,CAA2CmU,CAAAA,SAA3C,GAAuDM,aAAvD,CAAA;EAAuE,OAAA;;QAEzHX,gBAAgB,IAAI5U,KAAK,CAACkJ,SAA1B,CAAA;EACH,KAAA;;EAGDlJ,IAAAA,KAAK,CAAC+I,WAAN,GAAoB9I,UAAU,CAAC2U,gBAAD,CAA9B,CAAA;EACA,IAAA,IAAIY,oBAAoB,GAEXvS,sGAAAA,CAAAA,MAAAA,CAAAA,MAAM,CAAC,aAAD,CAFK,EAE0EnD,mEAAAA,CAAAA,CAAAA,MAAAA,CAAAA,WAAW,CAACiP,SAAO,CAAChP,KAAT,EAAgBC,KAAK,CAAC+I,WAAtB,CAFrF,EAAxB,6BAAA,CAAA,CAAA;EAKAlD,IAAAA,IAAI,IAAI2P,oBAAR,CAAA;;EAEA,IAAA,IAAI3U,QAAQ,CAACC,aAAT,CAAuB,yBAAvB,CAAJ,EAAuD;EAAED,MAAAA,QAAQ,CAACC,aAAT,CAAuB,yBAAvB,CAAkDmU,CAAAA,SAAlD,GAA8DO,oBAA9D,CAAA;EAAqF,KAAA;;EAG9I,IAAA,IAAI3U,QAAQ,CAACC,aAAT,CAAuB,cAAvB,CAAJ,EAA4C;EAExCD,MAAAA,QAAQ,CAACC,aAAT,CAAuB,cAAvB,CAAA,CAAuC0F,OAAvC,CAA+CxG,KAA/C,GAAuDyV,kBAAkB,CAACvR,IAAI,CAACC,SAAL,CAAenE,KAAf,CAAD,CAAzE,CAAA;EACH,KAHD,MAGO;EAGHa,MAAAA,QAAQ,CAACC,aAAT,CAAuB,kBAAvB,CAA2CuF,CAAAA,kBAA3C,CAA8D,WAA9D,EAAA,uFAAA,CAAA,MAAA,CAA8JoP,kBAAkB,CAACvR,IAAI,CAACC,SAAL,CAAenE,KAAf,CAAD,CAAhL,gBAA4M6F,IAA5M,EAAA,QAAA,CAAA,CAAA,CAAA;EAEA5G,MAAAA,SAAO,CAAC,4BAAD,EAA+B,UAAC+B,CAAD,EAAO;EAEzCA,QAAAA,CAAC,CAACO,cAAF,EAAA,CAAA;EAEAV,QAAAA,QAAQ,CAACC,aAAT,CAAuB,gBAAvB,EAAyC0F,OAAzC,CAAiDxD,IAAjD,GAAwDhC,CAAC,CAACuF,aAAF,CAAgBC,OAAhB,CAAwBxD,IAAhF,CAAA;UAEA4E,OAAO,CAACC,GAAR,CAAY7G,CAAC,CAACuF,aAAF,CAAgBC,OAAhB,CAAwBxD,IAApC,CAAA,CAAA;;EAEA,QAAA,QAAQhC,CAAC,CAACuF,aAAF,CAAgBC,OAAhB,CAAwBxD,IAAhC;EAEI,UAAA,KAAK,OAAL;cAEInC,QAAQ,CAACC,aAAT,CAAuB,gBAAvB,CAAA,CAAyC6P,SAAzC,GAAqD1N,MAAM,CAAC,mBAAD,CAA3D,CAAA;cACApC,QAAQ,CAACC,aAAT,CAAuB,qBAAvB,EAA8C4U,KAA9C,CAAoDC,QAApD,GAA+D,OAA/D,CAAA;cACA9U,QAAQ,CAACC,aAAT,CAAuB,qBAAvB,EAA8C+N,SAA9C,CAAwDH,MAAxD,CAA+D,QAA/D,CAAA,CAAA;cACA7N,QAAQ,CAACC,aAAT,CAAuB,uBAAvB,EAAgD+N,SAAhD,CAA0DkC,GAA1D,CAA8D,QAA9D,CAAA,CAAA;EACAlQ,YAAAA,QAAQ,CAACC,aAAT,CAAuB,uBAAvB,CAAgDQ,CAAAA,KAAhD,GAAwD,CAAxD,CAAA;EACA,YAAA,MAAA;;EACJ,UAAA,KAAK,SAAL;cAEIT,QAAQ,CAACC,aAAT,CAAuB,gBAAvB,CAAA,CAAyC6P,SAAzC,GAAqD1N,MAAM,CAAC,eAAD,CAA3D,CAAA;cACApC,QAAQ,CAACC,aAAT,CAAuB,uBAAvB,EAAgD4U,KAAhD,CAAsDC,QAAtD,GAAiE,MAAjE,CAAA;cACA9U,QAAQ,CAACC,aAAT,CAAuB,qBAAvB,EAA8C+N,SAA9C,CAAwDkC,GAAxD,CAA4D,QAA5D,CAAA,CAAA;cACAlQ,QAAQ,CAACC,aAAT,CAAuB,uBAAvB,EAAgD+N,SAAhD,CAA0DH,MAA1D,CAAiE,QAAjE,CAAA,CAAA;EACA7N,YAAAA,QAAQ,CAACC,aAAT,CAAuB,qBAAvB,CAA8CQ,CAAAA,KAA9C,GAAsD,CAAtD,CAAA;EACA,YAAA,MAAA;EAjBR,SAAA;;EAoBAyN,QAAAA,SAAO,CAAChP,KAAR,CAAcO,KAAd,CAAoBkP,OAApB,GAA8B,IAA9B,CAAA;EAEAT,QAAAA,SAAO,CAACmD,aAAR,EAAA,CAAA;EACH,OA/BM,CAAP,CAAA;EAkCAxR,MAAAA,WAAW,CAAC,uBAAD,EAA0B,CAAC,CAAD,CAA1B,CAAX,CAAA;EACAyS,MAAAA,OAAO,CAAC,uBAAD,EAA0B,UAACnS,CAAD,EAAO;UAEpC,IAAInB,QAAQ,CAACmB,CAAC,CAACuF,aAAF,CAAgBjF,KAAjB,CAAR,GAAkC,GAAlC,IAAyCzB,QAAQ,CAACmB,CAAC,CAACuF,aAAF,CAAgBjF,KAAjB,CAAR,GAAkC,CAA/E,EAAkF;EAG9EN,UAAAA,CAAC,CAACuF,aAAF,CAAgBqP,iBAAhB,CAAkC,qBAAlC,CAAA,CAAA;EACH,SAJD,MAIO;EAEH5U,UAAAA,CAAC,CAACuF,aAAF,CAAgBqP,iBAAhB,CAAkC,EAAlC,CAAA,CAAA;EACH,SAAA;;UAID5U,CAAC,CAACuF,aAAF,CAAgBoO,aAAhB,CAA8B9F,SAA9B,CAAwCkC,GAAxC,CAA4C,eAA5C,CAAA,CAAA;EAEA/P,QAAAA,CAAC,CAACuF,aAAF,CAAgBmP,KAAhB,CAAsBC,QAAtB,GAAiC,MAAjC,CAAA;EAEA5G,QAAAA,SAAO,CAACmD,aAAR,EAAA,CAAA;EACH,OAlBM,CAAP,CAAA;QAqBAxR,WAAW,CAAC,qBAAD,EAAwB,CAAC,CAAD,EAAI,EAAJ,CAAxB,CAAX,CAAA;EACAyS,MAAAA,OAAO,CAAC,qBAAD,EAAwB,UAACnS,CAAD,EAAO;UAElC,IAAInB,QAAQ,CAACmB,CAAC,CAACuF,aAAF,CAAgBjF,KAAjB,CAAR,GAAkC,CAAlC,IAAuCzB,QAAQ,CAACmB,CAAC,CAACuF,aAAF,CAAgBjF,KAAjB,CAAR,GAAkCtB,KAAK,CAAC2H,KAAnF,EAA0F;EAGtF3G,UAAAA,CAAC,CAACuF,aAAF,CAAgBqP,iBAAhB,CAAkC,sBAAlC,CAAA,CAAA;EACH,SAJD,MAIO;EAEH5U,UAAAA,CAAC,CAACuF,aAAF,CAAgBqP,iBAAhB,CAAkC,EAAlC,CAAA,CAAA;EACH,SAAA;;UAID5U,CAAC,CAACuF,aAAF,CAAgBoO,aAAhB,CAA8B9F,SAA9B,CAAwCkC,GAAxC,CAA4C,eAA5C,CAAA,CAAA;EAEA/P,QAAAA,CAAC,CAACuF,aAAF,CAAgBmP,KAAhB,CAAsBC,QAAtB,GAAiC,OAAjC,CAAA;EAEA5G,QAAAA,SAAO,CAAChP,KAAR,CAAcO,KAAd,CAAoBkP,OAApB,GAA8B,IAA9B,CAAA;EAEAT,QAAAA,SAAO,CAACmD,aAAR,EAAA,CAAA;EACH,OApBM,CAAP,CAAA;EAqBH,KAAA;KA9vBc;IAkzBnBK,YAAY,EAAE,SAACxS,YAAAA,CAAAA,KAAD,EAAW;EAErBd,IAAAA,SAAO,CAAC,WAAD,EAAc,UAAC+B,CAAD,EAAO;QAExB,IAAIuJ,CAAC,GAAG,CAAR;YAAWsL,OAAO,GAAG,EAArB;YAAyBjH,IAAI,GAAG,EAAhC,CAAA;QAGAA,IAAI,CAACtI,EAAL,GAAUzF,QAAQ,CAACC,aAAT,CAAuB,YAAvB,CAAA,CAAqC0F,OAArC,CAA6CF,EAAvD,CAAA;EACAsI,MAAAA,IAAI,CAACtH,IAAL,GAAYpD,IAAI,CAAC4R,KAAL,CAAWjV,QAAQ,CAACC,aAAT,CAAuB,YAAvB,CAAA,CAAqC0F,OAArC,CAA6Cc,IAAxD,CAAZ,CAAA;QACAsH,IAAI,CAAC1L,KAAL,GAAarC,QAAQ,CAACC,aAAT,CAAuB,YAAvB,CAAA,CAAqCQ,KAAlD,CAAA;EACAsN,MAAAA,IAAI,CAACjH,KAAL,GAAavH,UAAU,CAACS,QAAQ,CAACC,aAAT,CAAuB,UAAvB,CAAmCQ,CAAAA,KAApC,CAAvB,CAAA;EACAsN,MAAAA,IAAI,CAAC5O,KAAL,GAAaH,QAAQ,CAACgB,QAAQ,CAACC,aAAT,CAAuB,UAAvB,CAAA,CAAmC0F,OAAnC,CAA2CxG,KAA5C,CAArB,CAAA;EACA4O,MAAAA,IAAI,CAACoE,SAAL,GAAiB9O,IAAI,CAAC4R,KAAL,CAAWjV,QAAQ,CAACC,aAAT,CAAuB,YAAvB,CAAA,CAAqC0F,OAArC,CAA6CwM,SAAxD,CAAjB,CAAA;EACApE,MAAAA,IAAI,CAACnH,GAAL,GAAW5H,QAAQ,CAACgB,QAAQ,CAACC,aAAT,CAAuB,WAAvB,CAAoCQ,CAAAA,KAArC,CAAnB,CAAA;QACAsN,IAAI,CAACpH,IAAL,GAAY,EAAZ,CAAA;QACAoH,IAAI,CAACzG,OAAL,GAAe4G,SAAO,CAACzO,KAAR,CAAc8G,WAAd,CAA0BkC,OAAzC,CAAA;QACAsF,IAAI,CAAC9L,UAAL,GAAkB,EAAlB,CAAA;QAGA,IAAIoQ,aAAa,GAAGrS,QAAQ,CAACC,aAAT,CAAuB,gBAAvB,EAAyC8R,OAAzC,CAAiD/R,QAAQ,CAACC,aAAT,CAAuB,gBAAvB,CAAA,CAAyC0T,aAA1F,CAAyGhO,CAAAA,OAAzG,CAAiHxD,IAArI,CAAA;;QAEA,IAAIkQ,aAAa,IAAI,SAArB,EAAgC;UAAEtE,IAAI,CAACjG,gBAAL,GAAwB9H,QAAQ,CAACC,aAAT,CAAuB,gBAAvB,CAAA,CAAyCQ,KAAjE,CAAA;EAAyE,OAAA;;QAC3G,IAAI4R,aAAa,IAAI,OAArB,EAA8B;UAAEtE,IAAI,CAAC/F,cAAL,GAAsBhI,QAAQ,CAACC,aAAT,CAAuB,gBAAvB,CAAA,CAAyCQ,KAA/D,CAAA;EAAuE,OAAA;;QAGvG,IAAIyU,KAAK,GAAG,CAAZ,CAAA;EACA,MAAA,IAAI5I,IAAI,GAAGtM,QAAQ,CAACY,gBAAT,CAA0B,wBAA1B,CAAX,CAAA;;EAxBwB,MAAA,IAAA,UAAA,GAAA,0BAAA,CAyBN0L,IAzBM,CAAA;EAAA,UAAA,MAAA,CAAA;;EAAA,MAAA,IAAA;UAyBxB,KAAwB,UAAA,CAAA,CAAA,EAAA,EAAA,CAAA,CAAA,MAAA,GAAA,UAAA,CAAA,CAAA,EAAA,EAAA,IAAA,GAAA;EAAA,UAAA,IAAb6I,GAAa,GAAA,MAAA,CAAA,KAAA,CAAA;YAEpB,IAAIjT,CAAC,GAAGgT,KAAR,CAAA;;YACA,IAAIC,GAAG,CAAC1S,OAAR,EAAiB;EAEb,YAAA,IAAI,CAACsL,IAAI,CAAC9L,UAAL,CAAgBC,CAAhB,CAAL,EAAyB6L,IAAI,CAAC9L,UAAL,CAAgBC,CAAhB,IAAqB,EAArB,CAAA;EAEzB,YAAA,IAAI,CAAC6L,IAAI,CAAC9L,UAAL,CAAgBC,CAAhB,CAAmBoK,CAAAA,IAAxB,EAA8ByB,IAAI,CAAC9L,UAAL,CAAgBC,CAAhB,CAAmBoK,CAAAA,IAAnB,GAA0B,EAA1B,CAAA;cAE9B,IAAI,CAACyB,IAAI,CAAC9L,UAAL,CAAgBC,CAAhB,CAAA,CAAmBG,KAAxB,EAA+B0L,IAAI,CAAC9L,UAAL,CAAgBC,CAAhB,CAAmBG,CAAAA,KAAnB,GAA2B8S,GAAG,CAACxP,OAAJ,CAAYyP,MAAvC,CAAA;EAG/BrH,YAAAA,IAAI,CAAC9L,UAAL,CAAgBC,CAAhB,CAAmBoK,CAAAA,IAAnB,CAAwB,GAAA,GAAM6I,GAAG,CAACxP,OAAJ,CAAYe,KAA1C,CAAmD,GAAA;EAAErE,cAAAA,KAAK,EAAE8S,GAAG,CAACxP,OAAJ,CAAYtD,KAArB;EAA4BlD,cAAAA,KAAK,EAAEI,UAAU,CAAC4V,GAAG,CAACxP,OAAJ,CAAYxG,KAAb,CAAA;eAAhG,CAAA;EAEA4O,YAAAA,IAAI,CAACjH,KAAL,IAAciH,IAAI,CAACnH,GAAL,GAAWrH,UAAU,CAAC4V,GAAG,CAACxP,OAAJ,CAAYxG,KAAb,CAAnC,CAAA;EAEA+V,YAAAA,KAAK,IAAI,CAAT,CAAA;EACH,WAAA;EACJ,SAAA;EA3CuB,OAAA,CAAA,OAAA,GAAA,EAAA;EAAA,QAAA,UAAA,CAAA,CAAA,CAAA,GAAA,CAAA,CAAA;EAAA,OAAA,SAAA;EAAA,QAAA,UAAA,CAAA,CAAA,EAAA,CAAA;EAAA,OAAA;;EA6CxB,MAAA,IAAInH,IAAI,CAAC1L,KAAL,CAAW9D,MAAX,GAAoB,CAAxB,EAA2B;EAAE8W,QAAAA,KAAK,CAAClX,EAAE,CAAC,wBAAD,CAAH,CAAL,CAAA;EAAqC,QAAA,OAAA;EAAS,OAAA;;QAE3E6W,OAAO,CAAC3P,IAAR,CAAa0I,IAAb,CAAA,CAAA;EAEA,MAAA,IAAIuH,OAAO,GAAGpH,SAAO,CAACC,oBAAR,CAA6BjP,KAA7B,EAAoCwK,CAApC,EAAuCsL,OAAvC,EAAgD,IAAhD,CAAd,CAAA;QAEAhV,QAAQ,CAACC,aAAT,CAAuB,eAAvB,EAAwCuF,kBAAxC,CAA2D,aAA3D,EAA0E8P,OAA1E,CAAA,CAAA;EAEApH,MAAAA,SAAO,CAACqD,uBAAR,EAAA,CAAA;EAGArD,MAAAA,SAAO,CAACmD,aAAR,EAAA,CAAA;EAGArR,MAAAA,QAAQ,CAACC,aAAT,CAAuB,YAAvB,CAAqCQ,CAAAA,KAArC,GAA6C,EAA7C,CAAA;EACAT,MAAAA,QAAQ,CAACC,aAAT,CAAuB,UAAvB,CAAmCQ,CAAAA,KAAnC,GAA2C,EAA3C,CAAA;EACAT,MAAAA,QAAQ,CAACC,aAAT,CAAuB,WAAvB,CAAoCQ,CAAAA,KAApC,GAA4C,EAA5C,CAAA;EACAT,MAAAA,QAAQ,CAACC,aAAT,CAAuB,gBAAvB,CAAyCQ,CAAAA,KAAzC,GAAiD,EAAjD,CAAA;EACAT,MAAAA,QAAQ,CAACC,aAAT,CAAuB,kBAAvB,CAA2C6P,CAAAA,SAA3C,GAAuD,EAAvD,CAAA;EAGAsB,MAAAA,UAAU,CAAC,YAAM;EAAEpR,QAAAA,QAAQ,CAACC,aAAT,CAAuB,YAAvB,EAAqC0R,KAArC,EAAA,CAAA;SAAT,EAA0D,GAA1D,CAAV,CAAA;EAEAzD,MAAAA,SAAO,CAAChP,KAAR,CAAcO,KAAd,CAAoBkP,OAApB,GAA8B,IAA9B,CAAA;EACH,KArEM,CAAP,CAAA;EAsEH,GAAA;EA13BkB,CAAhB;;ECDA,IAAM4G,WAAW,GAAG,SAAdA,WAAc,GAAM;EAE7B,EAAA,OAAA,sSAAA,CAAA,MAAA,CAIqGnT,MAAM,CAAC,WAAD,CAJ3G,EAAA,2cAAA,CAAA,CAAA,MAAA,CAWmBA,MAAM,CAAC,KAAD,CAXzB,EAAA,+LAAA,CAAA,CAAA,MAAA,CAc2EA,MAAM,CAAC,KAAD,CAdjF,EAAA,kGAAA,CAAA,CAAA,MAAA,CAe8EA,MAAM,CAAC,KAAD,CAfpF,EAAA,mGAAA,CAAA,CAAA,MAAA,CAgB+EA,MAAM,CAAC,MAAD,CAhBrF,EAAA,yGAAA,CAAA,CAAA,MAAA,CAiBqFA,MAAM,CAAC,YAAD,CAjB3F,EAAA,wGAAA,CAAA,CAAA,MAAA,CAkBoFA,MAAM,CAAC,WAAD,CAlB1F,EAmBmFA,uGAAAA,CAAAA,CAAAA,MAAAA,CAAAA,MAAM,CAAC,UAAD,CAnBzF,EAoBiFA,qGAAAA,CAAAA,CAAAA,MAAAA,CAAAA,MAAM,CAAC,QAAD,CApBvF,EAqBmFA,uGAAAA,CAAAA,CAAAA,MAAAA,CAAAA,MAAM,CAAC,UAAD,CArBzF,EA0BuHA,yTAAAA,CAAAA,CAAAA,MAAAA,CAAAA,MAAM,CAAC,cAAD,CA1B7H,EAkC8KjE,mfAAAA,CAAAA,CAAAA,MAAAA,CAAAA,EAAE,CAAC,WAAD,CAlChL,EA8D8CiE,2jDAAAA,CAAAA,CAAAA,MAAAA,CAAAA,MAAM,CAAC,MAAD,CA9DpD,EA+D0DA,6EAAAA,CAAAA,CAAAA,MAAAA,CAAAA,MAAM,CAAC,QAAD,CA/DhE,EAgE2BA,qCAAAA,CAAAA,CAAAA,MAAAA,CAAAA,MAAM,CAAC,UAAD,CAhEjC,iFAiE0DA,MAAM,CAAC,MAAD,CAjEhE,EAAA,woCAAA,CAAA,CAAA;EAmGH,CArGM;;ECOP,IAAMlD,KAAK,GAAG;EAEVO,EAAAA,KAAK,EAAE;EACH8N,IAAAA,SAAS,EAAE,IADR;EAEHoB,IAAAA,OAAO,EAAE,KAFN;EAGHE,IAAAA,SAAS,EAAE,IAHR;EAIHG,IAAAA,SAAS,EAAE,KAJR;EAKH1K,IAAAA,SAAS,EAAE;EAAEK,MAAAA,OAAO,EAAE,KAAX;EAAkB6Q,MAAAA,GAAG,EAAE,IAAvB;EAA6BrQ,MAAAA,IAAI,EAAE,EAAnC;EAAuCX,MAAAA,CAAC,EAAE,CAA1C;EAA6CiR,MAAAA,SAAS,EAAE,CAAxD;EAA2DhR,MAAAA,KAAK,EAAE,IAAlE;EAAwEG,MAAAA,KAAK,EAAE,IAAI8Q,KAAJ,CAAU,uCAAV,CAAA;OALvF;EAMHC,IAAAA,QAAQ,EAAE,EANP;EAOHC,IAAAA,SAAS,EAAE,IAPR;EAQHpL,IAAAA,YAAY,EAAE,IARX;EASH3B,IAAAA,IAAI,EAAE,EATH;EAUHH,IAAAA,MAAM,EAAE,EAVL;EAWHhJ,IAAAA,QAAQ,EAAE,EAXP;EAYHiN,IAAAA,WAAW,EAAE,EAZV;EAaHpG,IAAAA,WAAW,EAAE,EAbV;EAcH/C,IAAAA,OAAO,EAAE;EAAEqS,MAAAA,aAAa,EAAE,EAAjB;EAAqBC,MAAAA,iBAAiB,EAAE,CAAA;OAd9C;EAeHC,IAAAA,cAAc,EAAE,IAfb;EAgBHC,IAAAA,YAAY,EAAE,IAhBX;EAiBHjG,IAAAA,QAAQ,EAAE,EAjBP;EAkBH+C,IAAAA,KAAK,EAAE,GAlBJ;EAmBHmD,IAAAA,UAAU,EAAE,EAnBT;EAoBH7C,IAAAA,mBAAmB,EAAE,EAAA;KAtBf;EAwBV8C,EAAAA,IAAI,EAAE,SAAM,IAAA,GAAA;EAGRhX,IAAAA,KAAK,CAACqG,OAAN,EAAA,CAAA;;EAGA,IAAA,IAAIvC,EAAE,GAAG,SAALA,EAAK,CAACU,QAAD,EAAc;EAEnB,MAAA,IAAGxE,KAAK,CAACO,KAAN,CAAY8N,SAAf,EAAyB;UAErBrO,KAAK,CAACO,KAAN,CAAY+D,OAAZ,CAAoBqS,aAApB,GAAoCnS,QAAQ,CAACmS,aAA7C,CAAA;UACA3W,KAAK,CAACO,KAAN,CAAY+D,OAAZ,CAAoBsS,iBAApB,GAAwCpS,QAAQ,CAACoS,iBAAjD,CAAA;EACH,OAAA;;QAGD,IAAGpS,QAAQ,CAACoS,iBAAT,IAA8B5W,KAAK,CAACO,KAAN,CAAY+D,OAAZ,CAAoBsS,iBAArD,EAAuE;EAEnExR,QAAAA,SAAS,CAACpF,KAAD,EAAQ,CAAR,CAAT,CAAA;;EAEAA,QAAAA,KAAK,CAACqG,OAAN,EAAA,CAAA;;UAEArG,KAAK,CAACO,KAAN,CAAY+D,OAAZ,CAAoBqS,aAApB,GAAoCnS,QAAQ,CAACmS,aAA7C,CAAA;UACA3W,KAAK,CAACO,KAAN,CAAY+D,OAAZ,CAAoBsS,iBAApB,GAAwCpS,QAAQ,CAACoS,iBAAjD,CAAA;EACH,OAAA;OAjBL,CAAA;;EAyBA5W,IAAAA,KAAK,CAACO,KAAN,CAAYuW,YAAZ,GAA2BjR,WAAW,CAAC,YAAM;QAAEjC,gBAAgB,CAAC5D,KAAD,EAAQ,CAAC,UAAD,EAAa,eAAb,CAAR,EAAuC8D,EAAvC,CAAhB,CAAA;OAAT,EAAwE,IAAxE,CAAtC,CAAA;KAvDM;EAyDVuC,EAAAA,OAAO,EAAE,SAAM,OAAA,GAAA;EAGX,IAAA,IAAIrG,KAAK,CAACO,KAAN,CAAY8N,SAAhB,EAA2B4I,UAAU,EAAA,CAAA;;EASrC,IAAA,IAAGjX,KAAK,CAACO,KAAN,CAAY+K,YAAf,EAA4B;QAAEtD,YAAY,CAAChI,KAAD,EAAQA,KAAK,CAACO,KAAN,CAAY+K,YAApB,EAAkC,MAAlC,CAAZ,CAAA;EAAwD,KAAA;;EAGtF,IAAA,IAAIM,CAAC,GAAG9K,QAAQ,CAACC,aAAT,CAAuB,eAAvB,CAAA,GAA0CD,QAAQ,CAACC,aAAT,CAAuB,eAAvB,CAAwCQ,CAAAA,KAAlF,GAA0F,EAAlG,CAAA;EAGA,IAAA,IAAIuS,IAAI,GAAGhT,QAAQ,CAACC,aAAT,CAAuB,eAAvB,CAA0CD,GAAAA,QAAQ,CAACC,aAAT,CAAuB,eAAvB,CAAA,CAAwC0F,OAAxC,CAAgDlF,KAA1F,GAAiG,EAA5G,CAAA;;EAGA,IAAA,IAAGT,QAAQ,CAACC,aAAT,CAAuB,iBAAvB,CAAH,EAA6C;EAAE,MAAA,OAAA;EAAS,KAAA;;MAGxDgD,KAAK,CAAC,8BAAD,EAAiC;EAClCC,MAAAA,MAAM,EAAE,MAD0B;EAElCC,MAAAA,OAAO,EAAEA,OAFyB;EAGlCC,MAAAA,IAAI,EAAEC,IAAI,CAACC,SAAL,CAAe;EACjBC,QAAAA,KAAK,EAAE;EACHsF,UAAAA,IAAI,EAAE;EACF1G,YAAAA,IAAI,EAAQ,cADV;EAEF8D,YAAAA,MAAM,EAAM,CAAC,QAAD,EAAW,IAAX,CAFV;cAGFmQ,KAAK,EAAOC,SAAS,CAAC,cAAD,CAAA;aAJtB;EAMHC,UAAAA,MAAM,EAAE;EACJnU,YAAAA,IAAI,EAAQ,QADR;cAEJY,MAAM,EAAO,CAAC,WAAD,CAFT;EAGJmD,YAAAA,GAAG,EAAU,WAAA;aATd;EAWHwC,UAAAA,MAAM,EAAE;EACJvG,YAAAA,IAAI,EAAQ,MADR;EAEJ+D,YAAAA,GAAG,EAAS,iBAFR;EAGJD,YAAAA,MAAM,EAAM,GAHR;cAIJ+M,IAAI,EAAQA,IAAI,IAAI,EAAR,GAAa,cAAcA,IAAd,GAAoB,IAAjC,GAAwC,EAJhD;EAKJF,YAAAA,KAAK,EAAO5T,KAAK,CAACO,KAAN,CAAYqT,KALpB;EAMJjU,YAAAA,MAAM,EAAM;EACRuH,cAAAA,KAAK,EAAE,MADC;EAER0E,cAAAA,CAAC,EAAEA,CAAAA;eARH;EAUJ3E,YAAAA,MAAM,EAAM;EACRC,cAAAA,KAAK,EAAE,SADC;EAERC,cAAAA,KAAK,EAAE,MAAA;EAFC,aAAA;aArBb;EA+BH3G,UAAAA,QAAQ,EAAE;EACNyC,YAAAA,IAAI,EAAQ,KADN;EAEN+D,YAAAA,GAAG,EAAS,oBAFN;EAGND,YAAAA,MAAM,EAAM,CAAC,UAAD,EAAa,eAAb,EAA8B,mBAA9B,EAAmD,UAAnD,EAA+D,kBAA/D,EAAmF,aAAnF,EAAkG,aAAlG,EAAiH,UAAjH,EAA6H,aAA7H,EAA4I,aAA5I,EAA2J,iBAA3J,EAA8K,uBAA9K,EAAuM,QAAvM,EAAiN,YAAjN,EAA+N,cAA/N,EAA+O,mBAA/O,EAAoQ,WAApQ,CAAA;EAHN,WAAA;EA/BP,SAAA;SADL,CAAA;EAH4B,KAAjC,CAAL,CA2CCxC,IA3CD,CA2CM,UAAAC,QAAQ,EAAA;QAAA,OAAIA,QAAQ,CAACC,IAAT,EAAJ,CAAA;EAAA,KA3Cd,CA4CCF,CAAAA,IA5CD,CA4CM,UAAAC,QAAQ,EAAI;QAGdyP,UAAU,EAAA,CAAA;;QAEV,IAAGzP,QAAQ,CAACE,OAAZ,EAAoB;UAGhB2S,UAAU,CAAC7S,QAAD,CAAV,CAAA;;EAGAxE,QAAAA,KAAK,CAACsX,iBAAN,EAAA,CAAA;;UAGAtX,KAAK,CAACuX,UAAN,CAAiB/S,QAAjB,CAAA,CAAA;;EAGAxE,QAAAA,KAAK,CAACwX,aAAN,EAAA,CAAA;;EAGAxX,QAAAA,KAAK,CAACyX,UAAN,EAAA,CAAA;;EAGAzX,QAAAA,KAAK,CAACO,KAAN,CAAY8N,SAAZ,GAAwB,KAAxB,CAAA;EAEH,OApBD,MAoBK;UAEDtG,aAAa,CAACvD,QAAD,CAAb,CAAA;EACH,OAAA;OAxEL,CAAA,CAAA,OAAA,CAAA,CA0EO,UAAAK,KAAK,EAAI;QAAEkD,aAAa,CAAClD,KAAD,CAAb,CAAA;OA1ElB,CAAA,CAAA;KAjFM;IA6JV6S,QAAQ,EAAE,SAAClT,QAAAA,CAAAA,QAAD,EAAc;MAEpB,IAAGA,QAAQ,CAACmF,IAAZ,EAAiB;QAEb,IAAGnF,QAAQ,CAACmF,IAAT,CAAcjF,OAAd,IAAyB,IAA5B,EAAiC,CAGhC;EACJ,KAAA;KArKK;EAuKV4S,EAAAA,iBAAiB,EAAE,SAAM,iBAAA,GAAA;EAErB,IAAA,IAAG,CAACtX,KAAK,CAACO,KAAN,CAAY8N,SAAhB,EAA2B,OAAA;MAG3BvN,QAAQ,CAACC,aAAT,CAAuB,WAAvB,EAAoC6P,SAApC,GAAgDyF,WAAW,EAA3D,CAAA;KA5KM;IA8KVkB,UAAU,EAAE,SAAC/S,UAAAA,CAAAA,QAAD,EAAc;EAEtB,IAAA,IAAGxE,KAAK,CAACO,KAAN,CAAY8N,SAAf,EAAyB;EAGrBsJ,MAAAA,eAAe,CACX,CACI;EAAEC,QAAAA,IAAI,EAAEA,IAAI,CAAC,gCAAD,CAAZ;UAAgDhL,IAAI,EAAE1J,MAAM,CAAC,WAAD,CAAA;EAA5D,OADJ,EAEI;EAAE0U,QAAAA,IAAI,EAAEA,IAAI,CAAC,GAAD,CAAZ;UAAmBhL,IAAI,EAAE1J,MAAM,CAAC,YAAD,CAAA;EAA/B,OAFJ,EAGI;UAAE0J,IAAI,EAAE1J,MAAM,CAAC,QAAD,CAAA;EAAd,OAHJ,CADW,CAAf,CAAA;EASAlD,MAAAA,KAAK,CAACO,KAAN,CAAYsQ,QAAZ,GAAuB;UACnB,KAAO,EAAA;EACHjE,UAAAA,IAAI,EAAE1J,MAAM,CAAC,KAAD,CADT;YAEH,OAAO,EAAA,gCAAA;WAHQ;UAKnB,MAAQ,EAAA;EACJ0J,UAAAA,IAAI,EAAE1J,MAAM,CAAC,MAAD,CADR;YAEJ,OAAO,EAAA,sBAAA;WAPQ;UASnB,YAAc,EAAA;EACV0J,UAAAA,IAAI,EAAE1J,MAAM,CAAC,YAAD,CADF;YAEV,OAAO,EAAA,sBAAA;WAXQ;UAanB,WAAa,EAAA;EACT0J,UAAAA,IAAI,EAAE1J,MAAM,CAAC,WAAD,CADH;YAET,OAAO,EAAA,sBAAA;WAfQ;UAiBnB,UAAY,EAAA;EACR0J,UAAAA,IAAI,EAAE1J,MAAM,CAAC,UAAD,CADJ;YAER,OAAO,EAAA,wBAAA;WAnBQ;UAqBnB,QAAU,EAAA;EACN0J,UAAAA,IAAI,EAAE1J,MAAM,CAAC,QAAD,CADN;YAEN,OAAO,EAAA,qBAAA;WAvBQ;UAyBnB,UAAY,EAAA;EACR0J,UAAAA,IAAI,EAAE1J,MAAM,CAAC,UAAD,CADJ;YAER,OAAO,EAAA,qBAAA;EAFC,SAAA;SAzBhB,CAAA;EA8BH,KAAA;;EAGDlD,IAAAA,KAAK,CAACO,KAAN,CAAYoJ,IAAZ,GAAmBnF,QAAQ,CAACmF,IAA5B,CAAA;EACA3J,IAAAA,KAAK,CAACO,KAAN,CAAYiJ,MAAZ,GAAqBhF,QAAQ,CAACgF,MAA9B,CAAA;EACAxJ,IAAAA,KAAK,CAACO,KAAN,CAAYmO,IAAZ,GAAmBlK,QAAQ,CAACkK,IAA5B,CAAA;EAKA1O,IAAAA,KAAK,CAACO,KAAN,CAAYC,QAAZ,GAAuBgE,QAAQ,CAAChE,QAAhC,CAAA;;MAGA,IAAI,CAACR,KAAK,CAACO,KAAN,CAAYC,QAAZ,CAAqB,WAArB,CAAL,EAAuC;EAAER,MAAAA,KAAK,CAACO,KAAN,CAAYC,QAAZ,CAAqB,WAArB,IAAoC,EAApC,CAAA;EAAyC,KAAA;;MAGlFR,KAAK,CAACO,KAAN,CAAYC,QAAZ,CAAqB+O,QAArB,GAAgCpB,gBAAgB,CAACnO,KAAD,CAAhD,CAAA;;EACA,IAAA,IAAIA,KAAK,CAACO,KAAN,CAAYC,QAAZ,CAAqB+O,QAAzB,EAAkC;QAAEzO,QAAQ,CAACC,aAAT,CAAuB,eAAvB,EAAwC+N,SAAxC,CAAkDH,MAAlD,CAAyD,QAAzD,CAAA,CAAA;EAAqE,KAAA;;EAGzG,IAAA,IAAInK,QAAQ,CAACgF,MAAT,CAAgBnK,MAAhB,IAA0B,CAA9B,EAAgC;QAE5ByB,QAAQ,CAACC,aAAT,CAAuB,cAAvB,CAAA,CAAuC6P,SAAvC,GAA2E1N,wBAAAA,CAAAA,MAAAA,CAAAA,MAAM,CAAC,uBAAD,CAAjF,EAAA,YAAA,CAAA,CAAA;EACA,MAAA,OAAA;EACH,KAAA;;MAGD,IAAI2U,YAAY,GAAG,EAAnB,CAAA;EACA7X,IAAAA,KAAK,CAACO,KAAN,CAAYuX,aAAZ,GAA4B,EAA5B,CAAA;MAEA,IAAI1K,IAAI,GAAG,EAAX;UAAe2K,OAAO,GAAG,EAAzB,CAAA;;EACA,IAAA,KAAK,IAAI3Q,CAAT,IAAc5C,QAAQ,CAACgF,MAAvB,EAA8B;QAM1BqO,YAAY,CAAC1R,IAAb,CAAkB3B,QAAQ,CAACgF,MAAT,CAAgBpC,CAAhB,CAAA,CAAmBlB,GAArC,CAAA,CAAA;EAEA,MAAA,IAAG,OAAO1B,QAAQ,CAACgF,MAAT,CAAgBpC,CAAhB,EAAmBuB,MAA1B,KAAsC,WAAzC,EAAsDnE,QAAQ,CAACgF,MAAT,CAAgBpC,CAAhB,CAAmBuB,CAAAA,MAAnB,GAA4B,KAA5B,CAAA;EAEtD,MAAA,IAAGnE,QAAQ,CAACgF,MAAT,CAAgBpC,CAAhB,CAAA,CAAmBuB,MAAnB,IAA6B,KAAhC,EAAuCoP,OAAO,IAAIvT,QAAQ,CAACgF,MAAT,CAAgBpC,CAAhB,EAAmBb,EAA9B,CAAA;EAEvC,MAAA,IAAIyR,OAAO,GAAG;UAAC,OAAQ,EAAA,6WAAA;SAAvB,CAAA;QACA,IAAIC,MAAM,GAAKjY,KAAK,CAACO,KAAN,CAAYkW,QAAZ,CAAqBvV,QAArB,CAA8BsD,QAAQ,CAACgF,MAAT,CAAgBpC,CAAhB,CAAA,CAAmBlB,GAAjD,CAAA,IAAyDlG,KAAK,CAACO,KAAN,CAAY8N,SAAtE,GAAiF,EAAjF,GAAoF,KAAlG,CAAA;EACAjB,MAAAA,IAAI,wCACU6K,MADV,EAAA,gEAAA,CAAA,CAAA,MAAA,CAEyCzT,QAAQ,CAACgF,MAAT,CAAgBpC,CAAhB,CAAmBlB,CAAAA,GAF5D,6BAEkFkB,CAFlF,EAAA,8EAAA,CAAA,CAAA,MAAA,CAIkB5C,QAAQ,CAACgF,MAAT,CAAgBpC,CAAhB,CAAmBb,CAAAA,EAJrC,kBAIkD/B,QAAQ,CAACgF,MAAT,CAAgBpC,CAAhB,CAAmBiB,CAAAA,IAJrE,EAKwC7D,2DAAAA,CAAAA,CAAAA,MAAAA,CAAAA,QAAQ,CAACgF,MAAT,CAAgBpC,CAAhB,CAAmBK,CAAAA,IAAnB,GAA0BjD,QAAQ,CAACgF,MAAT,CAAgBpC,CAAhB,CAAmBK,CAAAA,IAA7C,GAAoD,EAL5F,uFAMiDzH,KAAK,CAACkY,SAAN,CAAgB1T,QAAQ,CAACgF,MAAT,CAAgBpC,CAAhB,CAAA,CAAmBuB,MAAnC,CANjD,EAAA,qCAAA,CAAA,CAAA,MAAA,CAMiI/G,gBAAgB,CAAC3C,EAAD,EAAKuF,QAAQ,CAACkK,IAAT,CAAc5M,IAAnB,EAAyB0C,QAAQ,CAACgF,MAAT,CAAgBpC,CAAhB,EAAmBgB,OAA5C,CANjJ,qKAUuBpI,KAAK,CAACkY,SAAN,CAAgB1T,QAAQ,CAACgF,MAAT,CAAgBpC,CAAhB,EAAmBuB,MAAnC,CAVvB,EAaiC5I,oGAAAA,CAAAA,CAAAA,MAAAA,CAAAA,WAAW,CAACC,KAAD,EAAQwE,QAAQ,CAACgF,MAAT,CAAgBpC,CAAhB,CAAA,CAAmBQ,KAA3B,CAb5C,gJAgBiChG,gBAAgB,CAAC3C,EAAD,EAAKuF,QAAQ,CAACkK,IAAT,CAAc5M,IAAnB,EAAyB0C,QAAQ,CAACgF,MAAT,CAAgBpC,CAAhB,EAAmBgB,OAA5C,CAhBjD,EAmBwB5D,2GAAAA,CAAAA,CAAAA,MAAAA,CAAAA,QAAQ,CAACgF,MAAT,CAAgBpC,CAAhB,CAAA,CAAmBlB,GAnB3C,EAmBiEkB,kBAAAA,CAAAA,CAAAA,MAAAA,CAAAA,CAnBjE,EAuB+CsO,svBAAAA,CAAAA,CAAAA,MAAAA,CAAAA,kBAAkB,CAACvR,IAAI,CAACC,SAAL,CAAe4T,OAAf,CAAD,CAvBjE,EAAA,eAAA,CAAA,CAAA,MAAA,CAuB0GxT,QAAQ,CAACgF,MAAT,CAAgBpC,CAAhB,CAAmBlB,CAAAA,GAvB7H,6BAuBmJkB,CAvBnJ,EAAA,qvBAAA,CAAA,CAAA,MAAA,CA4BwB5C,QAAQ,CAACgF,MAAT,CAAgBpC,CAAhB,EAAmBlB,GA5B3C,EAAA,kBAAA,CAAA,CAAA,MAAA,CA4BiEkB,CA5BjE,EAAJ,+tBAAA,CAAA,CAAA;EAkCH,KAAA;;EAOD,IAAA,IAAGpH,KAAK,CAACO,KAAN,CAAY6E,SAAZ,CAAsBkR,GAAtB,IAA6BtW,KAAK,CAACO,KAAN,CAAY6E,SAAZ,CAAsBkR,GAAtB,IAA2ByB,OAAxD,IAAmE/X,KAAK,CAACO,KAAN,CAAY6E,SAAZ,CAAsBkR,GAAtB,CAA0BjX,MAA1B,GAAmC0Y,OAAO,CAAC1Y,MAAjH,EAAwH;EAAE+F,MAAAA,SAAS,CAACpF,KAAD,EAAQ,CAAR,CAAT,CAAA;EAAsB,KAAA;;EAEhJA,IAAAA,KAAK,CAACO,KAAN,CAAY6E,SAAZ,CAAsBkR,GAAtB,GAA4ByB,OAA5B,CAAA;EAEA/X,IAAAA,KAAK,CAACO,KAAN,CAAYkW,QAAZ,GAAuBoB,YAAvB,CAAA;EAGA/W,IAAAA,QAAQ,CAACC,aAAT,CAAuB,cAAvB,CAAuC6P,CAAAA,SAAvC,GAAmDxD,IAAnD,CAAA;KAvTM;IA0TV8K,SAAS,EAAE,SAACvP,SAAAA,CAAAA,MAAD,EAAY;EAEnB,IAAA,OAAA,qBAAA,CAAA,MAAA,CAA6B3I,KAAK,CAACO,KAAN,CAAYsQ,QAAZ,CAAqBlI,MAArB,CAAA,CAAA,OAAA,CAA7B,EAAsE3I,KAAAA,CAAAA,CAAAA,MAAAA,CAAAA,KAAK,CAACO,KAAN,CAAYsQ,QAAZ,CAAqBlI,MAArB,EAA6BiE,IAAnG,EAAA,QAAA,CAAA,CAAA;KA5TM;EA8TV4K,EAAAA,aAAa,EAAE,SAAM,aAAA,GAAA;MAGjBpJ,MAAM,CAACE,MAAP,CAActO,KAAd,CAAA,CAAA;MAGAgP,SAAO,CAAC2D,SAAR,CAAkB3S,KAAlB,CAAA,CAAA;MAGAd,SAAO,CAAC,eAAD,EAAkBc,KAAK,CAACwQ,SAAN,CAAgB2H,WAAlC,CAAP,CAAA;MAOAjZ,SAAO,CAAC,gBAAD,EAAmBc,KAAK,CAACwQ,SAAN,CAAgB4H,YAAnC,CAAP,CAAA;EAGA,IAAA,IAAG,CAACpY,KAAK,CAACO,KAAN,CAAY8N,SAAhB,EAA2B,OAAA;MAG3BV,SAAS,CAAC3N,KAAD,CAAT,CAAA;MAGAgP,SAAO,CAAC0D,QAAR,CAAiB1S,KAAjB,CAAA,CAAA;MAGAd,SAAO,CAAC,qBAAD,EAAwBc,KAAK,CAACwQ,SAAN,CAAgB6H,eAAxC,CAAP,CAAA;MAGAjF,OAAO,CAAC,eAAD,EAAkBpT,KAAK,CAACwQ,SAAN,CAAgB8H,YAAlC,CAAP,CAAA;EAGAxX,IAAAA,QAAQ,CAACoD,IAAT,CAAclD,gBAAd,CAA+B,YAA/B,EAA6C,YAAU;EAAEhB,MAAAA,KAAK,CAACO,KAAN,CAAY6E,SAAZ,CAAsBK,OAAtB,GAAgC,IAAhC,CAAA;EAAwC,KAAjG,EAAmG,KAAnG,CAAA,CAAA;EACA3E,IAAAA,QAAQ,CAACoD,IAAT,CAAclD,gBAAd,CAA+B,WAA/B,EAA4C,YAAU;EAAEhB,MAAAA,KAAK,CAACO,KAAN,CAAY6E,SAAZ,CAAsBK,OAAtB,GAAgC,IAAhC,CAAA;EAAwC,KAAhG,EAAkG,KAAlG,CAAA,CAAA;EAGAhG,IAAAA,MAAM,CAACuB,gBAAP,CAAwB,YAAxB,EAAsC,UAASC,CAAT,EAAY;QAI9C,IAAGjB,KAAK,CAAC2P,SAAT,EAAmB;EAAE1O,QAAAA,CAAC,CAACO,cAAF,EAAA,CAAA;UAAoBxB,KAAK,CAAC8P,SAAN,GAAkB,KAAlB,CAAA;;UAAyB9P,KAAK,CAAC2P,SAAN,CAAgB4I,IAAhB,EAAA,CAAA;;EAAwB,QAAA,OAAO,KAAP,CAAA;EAAe,OAAA;OAJ7G,CAAA,CAAA;KApWM;EA2WV/H,EAAAA,SAAS,EAAE;EAEPkC,IAAAA,QAAQ,EAAE,SAAA,QAAA,CAACzR,CAAD,EAAO,EAFV;MAMPmX,YAAY,EAAE,SAACnX,YAAAA,CAAAA,CAAD,EAAO;EAEjBA,MAAAA,CAAC,CAACO,cAAF,EAAA,CAAA;EAIA,MAAA,IAAIgX,EAAE,GAAG1X,QAAQ,CAACC,aAAT,CAAuB,eAAvB,CAAT,CAAA;;QACA,IAAGE,CAAC,CAACuF,aAAF,CAAgBC,OAAhB,CAAwBO,GAAxB,IAA+B,EAAlC,EAAqC;EACjCwR,QAAAA,EAAE,CAAC5H,SAAH,GAAe1N,MAAM,CAAC,KAAD,CAArB,CAAA;EACAsV,QAAAA,EAAE,CAAC/R,OAAH,CAAWlF,KAAX,GAAmB,EAAnB,CAAA;EACH,OAHD,MAGK;EACDiX,QAAAA,EAAE,CAAC5H,SAAH,GAAe5Q,KAAK,CAACO,KAAN,CAAYsQ,QAAZ,CAAqB5P,CAAC,CAACuF,aAAF,CAAgBC,OAAhB,CAAwBO,GAA7C,EAAkD4F,IAAjE,CAAA;UACA4L,EAAE,CAAC/R,OAAH,CAAWlF,KAAX,GAAmBN,CAAC,CAACuF,aAAF,CAAgBC,OAAhB,CAAwBO,GAA3C,CAAA;EACH,OAAA;;QAED,IAAIoG,IAAI,GAAG,EAAX,CAAA;EAGA0D,MAAAA,MAAM,CAACC,IAAP,CAAY/Q,KAAK,CAACO,KAAN,CAAYsQ,QAAxB,CAAkC9K,CAAAA,OAAlC,CAA0C,UAACiB,GAAD,EAAS;EAC/CoG,QAAAA,IAAI,GAAGpN,KAAK,CAACO,KAAN,CAAYsQ,QAAZ,CAAqB7J,GAArB,CAAgCwE,CAAAA,OAAAA,CAAAA,CAAAA,KAAhC,CAAsC,GAAtC,CAAP,CAAA;EACA4B,QAAAA,IAAI,CAACrH,OAAL,CAAa,UAACiB,GAAD,EAAS;EAClBwR,UAAAA,EAAE,CAAC1J,SAAH,CAAaH,MAAb,CAAoB3H,GAApB,CAAA,CAAA;WADJ,CAAA,CAAA;EAGAwR,QAAAA,EAAE,CAAC1J,SAAH,CAAaH,MAAb,CAAoB,uBAApB,CAAA,CAAA;SALJ,CAAA,CAAA;;QASA,IAAG1N,CAAC,CAACuF,aAAF,CAAgBC,OAAhB,CAAwBO,GAAxB,IAA6B,EAAhC,EAAmC;EAE/BwR,QAAAA,EAAE,CAAC1J,SAAH,CAAakC,GAAb,CAAiB,uBAAjB,CAAA,CAAA;EACH,OAHD,MAGK;EACD5D,QAAAA,IAAI,GAAGpN,KAAK,CAACO,KAAN,CAAYsQ,QAAZ,CAAqB5P,CAAC,CAACuF,aAAF,CAAgBC,OAAhB,CAAwBO,GAA7C,WAAwDwE,KAAxD,CAA8D,GAA9D,CAAP,CAAA;EACA4B,QAAAA,IAAI,CAACrH,OAAL,CAAa,UAACiB,GAAD,EAAS;EAClBwR,UAAAA,EAAE,CAAC1J,SAAH,CAAakC,GAAb,CAAiBhK,GAAjB,CAAA,CAAA;WADJ,CAAA,CAAA;EAGH,OAAA;;EAGDhH,MAAAA,KAAK,CAACqG,OAAN,EAAA,CAAA;OA5CG;MA8CP8R,WAAW,EAAE,SAAClX,WAAAA,CAAAA,CAAD,EAAO;EAEhBA,MAAAA,CAAC,CAACO,cAAF,EAAA,CAAA;QAEA,IAAIuK,CAAC,GAAG0M,OAAO,CAAExZ,EAAE,CAAC,+BAAD,CAAJ,CAAf,CAAA;QAEA,IAAG,CAAC8M,CAAJ,EAAO,OAAA;QAGPhI,KAAK,CAAC,wCAAD,EAA2C;EAC5CC,QAAAA,MAAM,EAAE,MADoC;EAE5CC,QAAAA,OAAO,EAAEA,OAFmC;EAG5CC,QAAAA,IAAI,EAAEC,IAAI,CAACC,SAAL,CAAe;EACjBC,UAAAA,KAAK,EAAE;EACHxB,YAAAA,OAAO,EAAE;EACLI,cAAAA,IAAI,EAAQ,cADP;EAELsD,cAAAA,EAAE,EAAUtF,CAAC,CAACuF,aAAF,CAAgBC,OAAhB,CAAwBF,EAF/B;EAGLkC,cAAAA,GAAG,EAASC,OAAO,EAAA;EAHd,aAAA;EADN,WAAA;WADL,CAAA;EAHsC,OAA3C,CAAL,CAaCnE,IAbD,CAaM,UAAAC,QAAQ,EAAA;UAAA,OAAIA,QAAQ,CAACC,IAAT,EAAJ,CAAA;EAAA,OAbd,CAcCF,CAAAA,IAdD,CAcM,UAAAC,QAAQ,EAAI;UAEd,IAAIA,QAAQ,CAACE,OAAb,EAAqB;EAIjB1E,UAAAA,KAAK,CAACqG,OAAN,EAAA,CAAA;EAEH,SAND,MAMK;YAGD0B,aAAa,CAACvD,QAAD,CAAb,CAAA;EACH,SAAA;SA1BL,CAAA,CAAA,OAAA,CAAA,CA4BO,UAAAK,KAAK,EAAI;UACZkD,aAAa,CAAClD,KAAD,CAAb,CAAA;SA7BJ,CAAA,CAAA;OAvDG;MAuFPyT,YAAY,EAAE,SAACrX,YAAAA,CAAAA,CAAD,EAAO;EAEjBA,MAAAA,CAAC,CAACO,cAAF,EAAA,CAAA;;EAEAxB,MAAAA,KAAK,CAACqG,OAAN,EAAA,CAAA;OA3FG;MA8FPgS,eAAe,EAAE,SAACpX,eAAAA,CAAAA,CAAD,EAAO;EAEpBjB,MAAAA,KAAK,CAACwQ,SAAN,CAAgBC,mBAAhB,CAAoCxP,CAApC,CAAA,CAAA;OAhGG;EAmGPwP,IAAAA,mBAAmB,EAAE,IAAA;KA9cf;EAgdVC,EAAAA,WAAW,EAAE,SAAA,WAAA,CAACtJ,CAAD,EAAIb,EAAJ,EAAW;EAGpB,IAAA,IAAG,CAACvG,KAAK,CAACO,KAAN,CAAYkP,OAAb,IAAwBzP,KAAK,CAACO,KAAN,CAAY+K,YAAvC,EAAoD;QAAEtD,YAAY,CAAChI,KAAD,EAAQA,KAAK,CAACO,KAAN,CAAY+K,YAApB,EAAkC,MAAlC,CAAZ,CAAA;;QAAuDtL,KAAK,CAAC2P,SAAN,CAAgB4I,IAAhB,EAAA,CAAA;;EAAwB,MAAA,OAAA;EAAS,KAAA;;EAE9I,IAAA,IAAI7I,KAAK,GAAG5O,QAAQ,CAACC,aAAT,CAAuB,QAAvB,CAAZ,CAAA;MACA,IAAG2O,KAAK,CAAC3O,aAAN,CAAoB,cAApB,CAAoC0F,CAAAA,OAApC,CAA4CyK,OAA5C,KAAwD,MAA3D,EAAmE,OAAA;MACnExB,KAAK,CAAC3O,aAAN,CAAoB,cAApB,EAAoC0F,OAApC,CAA4CyK,OAA5C,GAAsD,IAAtD,CAAA;MACAxB,KAAK,CAAC3O,aAAN,CAAoB,cAApB,CAAA,CAAoC6P,SAApC,GAAgD,8FAAiG1N,GAAAA,MAAM,CAAC,WAAD,CAAvJ,CAAA;MAEA,IAAII,IAAI,GAAG,EAAX,CAAA;;EAVoB,IAAA,IAAA,SAAA,GAAA,0BAAA,CAaPxC,QAAQ,CAACY,gBAAT,CAA0B,aAA1B,CAbO,CAAA;EAAA,QAAA,KAAA,CAAA;;EAAA,IAAA,IAAA;QAapB,KAAsD,SAAA,CAAA,CAAA,EAAA,EAAA,CAAA,CAAA,KAAA,GAAA,SAAA,CAAA,CAAA,EAAA,EAAA,IAAA,GAAA;EAAA,QAAA,IAA9CkK,CAA8C,GAAA,KAAA,CAAA,KAAA,CAAA;;EAElD,QAAA,QAAOA,CAAC,CAACnF,OAAF,CAAUxD,IAAjB;EAGI,UAAA,KAAK,KAAL;EACIK,YAAAA,IAAI,CAACsI,CAAC,CAACnF,OAAF,CAAUF,EAAX,CAAJ,GAAqBqF,CAAC,CAACnF,OAAF,CAAUlF,KAA/B,CAAA;EACA,YAAA,MAAA;;EACJ,UAAA,KAAK,YAAL;EACI+B,YAAAA,IAAI,CAACsI,CAAC,CAACnF,OAAF,CAAUF,EAAX,CAAJ,GAAqBrG,UAAU,CAAC0L,CAAC,CAACnF,OAAF,CAAUlF,KAAX,CAA/B,CAAA;EACA,YAAA,MAAA;;EACJ,UAAA,KAAK,OAAL;EAGI+B,YAAAA,IAAI,CAAC,OAAD,CAAJ,GAAgB,EAAhB,CAAA;;EAHJ,YAAA,IAAA,UAAA,GAAA,0BAAA,CAIoBxC,QAAQ,CAACY,gBAAT,CAA0B,wBAA1B,CAJpB,CAAA;EAAA,gBAAA,MAAA,CAAA;;EAAA,YAAA,IAAA;gBAII,KAAoE,UAAA,CAAA,CAAA,EAAA,EAAA,CAAA,CAAA,MAAA,GAAA,UAAA,CAAA,CAAA,EAAA,EAAA,IAAA,GAAA;EAAA,gBAAA,IAA5DmN,IAA4D,GAAA,MAAA,CAAA,KAAA,CAAA;EAEhE,gBAAA,IAAIkE,IAAI,GAAG5O,IAAI,CAAC4R,KAAL,CAAWpS,QAAQ,CAACkL,IAAI,CAACpI,OAAL,CAAasM,IAAd,CAAnB,CAAX,CAAA;EACA,gBAAA,IAAIxL,IAAI,GAAGpD,IAAI,CAAC4R,KAAL,CAAWpS,QAAQ,CAACkL,IAAI,CAACpI,OAAL,CAAac,IAAd,CAAnB,CAAX,CAAA;EACA,gBAAA,IAAI0L,SAAS,GAAG9O,IAAI,CAAC4R,KAAL,CAAWpS,QAAQ,CAACkL,IAAI,CAACpI,OAAL,CAAawM,SAAd,CAAnB,CAAhB,CAAA;EACA,gBAAA,IAAIC,GAAG,GAAG;EACN,kBAAA,IAAA,EAAMrE,IAAI,CAACpI,OAAL,CAAaF,EADb;oBAEN,KAAOzG,EAAAA,QAAQ,CAAC+O,IAAI,CAAC9N,aAAL,CAAmB,WAAnB,CAAgC0F,CAAAA,OAAhC,CAAwClF,KAAzC,CAFT;EAGN,kBAAA,MAAA,EAAQgG,IAAI,GAAGA,IAAH,GAAU,EAHhB;EAIN,kBAAA,WAAA,EAAa0L,SAAS,GAAGA,SAAH,GAAe,EAJ/B;EAKN,kBAAA,MAAA,EAAQpE,IAAI,CAAC9N,aAAL,CAAmB,YAAnB,EAAiC6P,SALnC;EAMN,kBAAA,MAAA,EAAQ,KANF;EAON,kBAAA,OAAA,EAAS,GAPH;oBAQN,OAASvQ,EAAAA,UAAU,CAACwO,IAAI,CAAC9N,aAAL,CAAmB,aAAnB,CAAkC0F,CAAAA,OAAlC,CAA0CxG,KAA3C,CARb;oBASN,OAAS4O,EAAAA,IAAI,CAAC9N,aAAL,CAAmB,aAAnB,CAAkC0F,CAAAA,OAAlC,CAA0CkB,KAT7C;oBAUN,OAASkH,EAAAA,IAAI,CAAC9N,aAAL,CAAmB,aAAnB,CAAkC0F,CAAAA,OAAlC,CAA0ClF,KAV7C;oBAYN,OAASlB,EAAAA,UAAU,CAACwO,IAAI,CAAC9N,aAAL,CAAmB,aAAnB,CAAkC0F,CAAAA,OAAlC,CAA0ClF,KAA3C,CAZb;oBAaN,YAAcgF,EAAAA,EAAE,IAAI,KAAN,GAAc,EAAd,GAAmBwM,IAAI,GAAGA,IAAH,GAAU,EAAA;mBAbnD,CAAA;;kBAkBA,IAAIlE,IAAI,CAAC9N,aAAL,CAAmB,aAAnB,CAAkC0F,CAAAA,OAAlC,CAA0CmC,gBAA9C,EAAgE;oBAAEsK,GAAG,CAACtK,gBAAJ,GAAuBiG,IAAI,CAAC9N,aAAL,CAAmB,aAAnB,CAAA,CAAkC0F,OAAlC,CAA0CmC,gBAAjE,CAAA;EAAoF,iBAAA;;kBACtJ,IAAIiG,IAAI,CAAC9N,aAAL,CAAmB,aAAnB,CAAkC0F,CAAAA,OAAlC,CAA0CqC,cAA9C,EAA8D;oBAAEoK,GAAG,CAACpK,cAAJ,GAAqB+F,IAAI,CAAC9N,aAAL,CAAmB,aAAnB,CAAA,CAAkC0F,OAAlC,CAA0CqC,cAA/D,CAAA;EAAgF,iBAAA;;EAEhJxF,gBAAAA,IAAI,CAAC,OAAD,CAAJ,CAAc6C,IAAd,CAAmB+M,GAAnB,CAAA,CAAA;EACH,eAAA;EA/BL,aAAA,CAAA,OAAA,GAAA,EAAA;EAAA,cAAA,UAAA,CAAA,CAAA,CAAA,GAAA,CAAA,CAAA;EAAA,aAAA,SAAA;EAAA,cAAA,UAAA,CAAA,CAAA,EAAA,CAAA;EAAA,aAAA;;EAiCA,YAAA,MAAA;;EACA,UAAA,KAAK,MAAL;cACI5P,IAAI,CAACsI,CAAC,CAACnF,OAAF,CAAUF,EAAX,CAAJ,GAAqBqF,CAAC,CAACgF,SAAvB,CAAA;EACA,YAAA,MAAA;;EACJ,UAAA,KAAK,OAAL,CAAA;EACA,UAAA,KAAK,QAAL,CAAA;EACA,UAAA,KAAK,QAAL,CAAA;EACA,UAAA,KAAK,UAAL;cACItN,IAAI,CAACsI,CAAC,CAACrF,EAAH,CAAJ,GAAaqF,CAAC,CAACrK,KAAf,CAAA;EACA,YAAA,MAAA;;EACJ,UAAA,KAAK,OAAL;cACI+B,IAAI,CAACsI,CAAC,CAACrF,EAAH,CAAJ,GAAaqF,CAAC,CAACgJ,aAAF,CAAgBA,aAAhB,CAA8BA,aAA9B,CAA4CA,aAA5C,CAA0DA,aAA1D,CAAwE7T,aAAxE,CAAsF,eAAtF,CAAA,CAAuGQ,KAApH,CAAA;EACA,YAAA,MAAA;;EACJ,UAAA,KAAK,OAAL;EACI+B,YAAAA,IAAI,CAAC,OAAD,CAAJ,GAAgBa,IAAI,CAAC4R,KAAL,CAAW2C,kBAAkB,CAAC9M,CAAC,CAACnF,OAAF,CAAUxG,KAAX,CAA7B,CAAhB,CAAA;cACAqD,IAAI,CAAC,OAAD,CAAJ,GAAgBA,IAAI,CAAC,OAAD,CAAJ,CAAc,OAAd,CAAhB,CAAA;cACAA,IAAI,CAAC,WAAD,CAAJ,GAAoBA,IAAI,CAAC,OAAD,CAAJ,CAAc,aAAd,CAApB,CAAA;cACA,IAAGxC,QAAQ,CAACC,aAAT,CAAuB,wBAAvB,CAAH,EAAqDuC,IAAI,CAAC,OAAD,CAAJ,CAAc,gBAAd,IAAkCxC,QAAQ,CAACC,aAAT,CAAuB,wBAAvB,EAAiDQ,KAAnF,CAAA;EACrD,YAAA,MAAA;EA5DR,SAAA;EA8DH,OAAA;EA7EmB,KAAA,CAAA,OAAA,GAAA,EAAA;EAAA,MAAA,SAAA,CAAA,CAAA,CAAA,GAAA,CAAA,CAAA;EAAA,KAAA,SAAA;EAAA,MAAA,SAAA,CAAA,CAAA,EAAA,CAAA;EAAA,KAAA;;EAiFpB,IAAA,IAAIoX,OAAO,GAAG,IAAI1W,IAAJ,EAAd,CAAA;MACAqB,IAAI,CAAC,aAAD,CAAJ,GAAsBqV,OAAO,CAACC,cAAR,EAA2B,GAAA,EAA3B,GAAgCzZ,EAAE,CAACwZ,OAAO,CAACE,WAAR,EAAwB,GAAA,CAAzB,CAAlC,GAAgE,EAAhE,GAAqE1Z,EAAE,CAACwZ,OAAO,CAACG,UAAR,EAAD,CAA7F,CAAA;EACAxV,IAAAA,IAAI,CAAC,YAAD,CAAJ,GAAqBqV,OAAO,CAACC,cAAR,EAAA,GAA2B,EAA3B,GAAgCzZ,EAAE,CAACwZ,OAAO,CAACE,WAAR,EAAA,GAAwB,CAAzB,CAAvD,CAAA;MACAvV,IAAI,CAAC,WAAD,CAAJ,GAAoBqV,OAAO,CAACC,cAAR,KAA2B,EAA/C,CAAA;EACAtV,IAAAA,IAAI,CAAC,SAAD,CAAJ,GAAkBtD,KAAK,CAACO,KAAN,CAAY+K,YAAZ,GAA2B,IAA3B,GAAkC,KAApD,CAAA;EACAhI,IAAAA,IAAI,CAAC,QAAD,CAAJ,GAAiB,KAAjB,CAAA;EAIA0L,IAAAA,SAAO,CAAChP,KAAR,CAAcO,KAAd,CAAoBkP,OAApB,GAA8B,KAA9B,CAAA;;MAGA,IAAGlJ,EAAE,IAAI,KAAT,EAAe;EAGXjD,MAAAA,IAAI,CAAC,MAAD,CAAJ,GAAeA,IAAI,CAAC,MAAD,CAAnB,CAAA;QACAA,IAAI,CAAC,UAAD,CAAJ,GAAmB;UACf,YAAcA,EAAAA,IAAI,CAAC,MAAD,CADH;EAEf,QAAA,WAAA,EAAa,EAFE;UAGf,KAAO,EAAA,CAAA;SAHX,CAAA;QAOAS,KAAK,CAAC,wCAAD,EAA2C;EAC5CC,QAAAA,MAAM,EAAE,MADoC;EAE5CC,QAAAA,OAAO,EAAEA,OAFmC;EAG5CC,QAAAA,IAAI,EAAEC,IAAI,CAACC,SAAL,CAAe;EACjBC,UAAAA,KAAK,EAAE;EACH8C,YAAAA,KAAK,EAAE;EACHlE,cAAAA,IAAI,EAAQ,cADT;EAEH+D,cAAAA,GAAG,EAAS,iBAFT;EAIH1D,cAAAA,IAAI,EAAQA,IAAAA;EAJT,aAAA;EADJ,WAAA;WADL,CAAA;EAHsC,OAA3C,CAAL,CAcCiB,IAdD,CAcM,UAAAC,QAAQ,EAAA;UAAA,OAAIA,QAAQ,CAACC,IAAT,EAAJ,CAAA;EAAA,OAdd,CAeCF,CAAAA,IAfD,CAeM,UAAAC,QAAQ,EAAI;UAEd,IAAIA,QAAQ,CAACE,OAAb,EAAqB;YAEjB1E,KAAK,CAAC2P,SAAN,CAAgB4I,IAAhB,EAAA,CAAA;;EAEAlN,UAAAA,KAAK,CAAEpM,EAAE,CAAC,eAAD,CAAJ,CAAL,CAAA;EAEA,UAAA,IAAGe,KAAK,CAACO,KAAN,CAAY+K,YAAZ,IAA4B,KAA/B,EAAsCtL,KAAK,CAACO,KAAN,CAAY+K,YAAZ,GAA2BhI,IAAI,CAAC4C,GAAhC,CAAA;;EAKtClG,UAAAA,KAAK,CAACqG,OAAN,EAAA,CAAA;EAEH,SAbD,MAaK;YAAE0B,aAAa,CAACvD,QAAD,CAAb,CAAA;EAA0B,SAAA;SA9BrC,CAAA,CAAA,OAAA,CAAA,CAgCO,UAAAK,KAAK,EAAI;UAAEkD,aAAa,CAAClD,KAAD,CAAb,CAAA;SAhClB,CAAA,CAAA;EAmCH,KA9CD,MA8CK;QAGDd,KAAK,CAAC,wCAAD,EAA2C;EAC5CC,QAAAA,MAAM,EAAE,MADoC;EAE5CC,QAAAA,OAAO,EAAEA,OAFmC;EAG5CC,QAAAA,IAAI,EAAEC,IAAI,CAACC,SAAL,CAAe;EACjBC,UAAAA,KAAK,EAAE;EACH8C,YAAAA,KAAK,EAAE;EACHlE,cAAAA,IAAI,EAAQ,cADT;EAEHsD,cAAAA,EAAE,EAAUA,EAFT;gBAGHkC,GAAG,EAASC,OAAO,EAHhB;EAIHpF,cAAAA,IAAI,EAAQA,IAAAA;EAJT,aAAA;EADJ,WAAA;WADL,CAAA;EAHsC,OAA3C,CAAL,CAcCiB,IAdD,CAcM,UAAAC,QAAQ,EAAA;UAAA,OAAIA,QAAQ,CAACC,IAAT,EAAJ,CAAA;EAAA,OAdd,CAeCF,CAAAA,IAfD,CAeM,UAAAC,QAAQ,EAAI;UAEd,IAAIA,QAAQ,CAACE,OAAb,EAAqB;YAEjB1E,KAAK,CAAC2P,SAAN,CAAgB4I,IAAhB,EAAA,CAAA;;EAEAlN,UAAAA,KAAK,CAAEpM,EAAE,CAAC,eAAD,CAAJ,CAAL,CAAA;;EAKAe,UAAAA,KAAK,CAACqG,OAAN,EAAA,CAAA;EAEH,SAXD,MAWK;YAED0B,aAAa,CAACvD,QAAD,CAAb,CAAA;EACH,SAAA;SA/BL,CAAA,CAAA,OAAA,CAAA,CAiCO,UAAAK,KAAK,EAAI;UACZkD,aAAa,CAAClD,KAAD,CAAb,CAAA;SAlCJ,CAAA,CAAA;EAoCH,KAAA;KAloBK;EAooBV4S,EAAAA,UAAU,EAAE,SAAMA,YAAA,GAAA;EAEdA,IAAAA,UAAU,CAACxY,EAAE,CAAC,kDAAD,EAAqD,mEAArD,EAA0H,MAA1H,EAAkI,mFAAlI,EAAuN,MAAvN,CAAH,EAAmO,EAAnO,CAAV,CAAA;EACH,GAAA;EAvoBS,CAAd,CAAA;;EA0oBAe,KAAK,CAACgX,IAAN,EAAA;;;;;;"}