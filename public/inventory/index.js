!function(){"use strict";function t(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,i(a.key),a)}}function e(t,e,n){return(e=i(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function n(t){return function(t){if(Array.isArray(t))return o(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||a(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(t,e){if(t){if("string"==typeof t)return o(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?o(t,e):void 0}}function o(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,a=new Array(e);n<e;n++)a[n]=t[n];return a}function i(t){var e=function(t,e){if("object"!=typeof t||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var a=n.call(t,e||"default");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:String(e)}const r=(t,e,...n)=>{let a=(t,e)=>(e.forEach(((e,n)=>{t=t.replace("%"+(n+1)+"$",e)})),t);return void 0===window.i18n||void 0===window.i18n.state.locale.values[t]?a(t,n):a(e(window.i18n.state.locale.values[t]),n)},c=t=>0===(t=String(t)).length?"":t.replace(/[&<>'"]/g,(t=>({"&":"&amp;","<":"&lt;",">":"&gt;","'":"&apos;",'"':"&quot;"}[t]))),s=(t,...e)=>{if(0===(t=String(t)).length)return"";return r(t,(t=>t.replace(/[<>'"]/g,(t=>({"&":"&amp;","<":"&lt;",">":"&gt;","'":"&apos;",'"':"&quot;"}[t])))),...e)},l=t=>0===(t=String(t)).length?"":t.replace(/[&<>'"]/g,(t=>({"&":"&amp;","<":"&lt;",">":"&gt;","'":"&apos;",'"':"&quot;"}[t]))),d=(t,...e)=>{if(0===(t=String(t)).length)return"";return r(t,(t=>t.replace(/[&<>'"]/g,(t=>({"&":"&amp;","<":"&lt;",">":"&gt;","'":"&apos;",'"':"&quot;"}[t])))),...e)},u=t=>{let e=new URLSearchParams(window.location.search),n=e.get("sid")?e.get("sid"):"",a=-1==t.indexOf("?")?"?sid="+n:"&sid="+n;return t+a},p=()=>{let t=new URLSearchParams(window.location.search);return t.get("sid")?t.get("sid"):""},m=t=>{let e=t+"=",n=decodeURIComponent(document.cookie).split(";");for(let t=0;t<n.length;t++){let a=n[t];for(;" "==a.charAt(0);)a=a.substring(1);if(0==a.indexOf(e))return a.substring(e.length,a.length)}return""},v=()=>{let t=localStorage.hasOwnProperty("header")&&localStorage.hasOwnProperty("header-version")?localStorage.getItem("header-version"):0,e=window.location.hostname+"/"+p()+"/"+m("locale");return e!=m("check")&&(t=0,console.log("refresh")),((t,e,n)=>{let a="";if(n){let t=new Date;t.setTime(t.getTime()+24*n*60*60*1e3),a=";expires="+t.toUTCString()}document.cookie=t+"="+(escape(e)||"")+a+";path=/;domain=.kenzap.cloud"})("check",e,5),t},f=()=>({Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+m("kenzap_api_key"),"Kenzap-Locale":m("locale")?m("locale"):"en","Kenzap-Header":v(),"Kenzap-Token":m("kenzap_token"),"Kenzap-Sid":p()});m("kenzap_api_key"),m("locale")&&m("locale"),v(),m("kenzap_token"),p();const y=t=>{if(console.log(t),isNaN(t.code)){let e=t;try{e=JSON.stringify(e)}catch(t){}let n=new URLSearchParams;return n.append("cmd","report"),n.append("sid",p()),n.append("token",m("kenzap_token")),n.append("data",e),fetch("https://api-v1.kenzap.cloud/error/",{method:"post",headers:{Accept:"application/json","Content-type":"application/x-www-form-urlencoded"},body:n}),void alert("Can not connect to Kenzap Cloud")}if(401===t.code){if(-1!=window.location.href.indexOf("localhost"))return void alert(t.reason);location.href="https://auth.kenzap.com/?app=65432108792785&redirect="+window.location.href}else alert(t.reason)},b=(t,e)=>{if(document.querySelector(t))for(let n of document.querySelectorAll(t))n.removeEventListener("click",e,!0),n.addEventListener("click",e,!0)},g=t=>{if(!document.querySelector(".toast")){let t='\n        <div class="toast-cont position-fixed bottom-0 p-2 m-4 end-0 align-items-center" style="z-index:10000;">\n            <div class="toast hide align-items-center text-white bg-dark border-0" role="alert" aria-live="assertive" aria-atomic="true" data-bs-delay="3000">\n                <div class="d-flex">\n                    <div class="toast-body"></div>\n                    <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast" aria-label="Close"></button>\n                </div>\n            </div>\n        </div>';document.querySelector("body > div")&&document.querySelector("body > div").insertAdjacentHTML("afterend",t)}let e=new bootstrap.Toast(document.querySelector(".toast"));document.querySelector(".toast .toast-body").innerHTML=t,e.show()};var h,k,w,_=function(t){return(""+t).length<2?"0"+t:t},S=function(){var t=new URLSearchParams(window.location.search),e=t.get("page")?t.get("page"):1;return parseInt(e)},x=function(t,e,n){if(void 0!==e){var o=e.limit+e.offset;o>e.total_records&&(o=e.total_records),document.querySelector("#listing_info").innerHTML=t("Showing %1$ to %2$ of %3$ entries",1+e.offset,o,e.total_records);var i=Math.ceil(e.total_records/e.limit);document.querySelector("#listing_paginate").style.display=i<2?"none":"block";var r=S(),c='<ul class="pagination d-flex justify-content-end pagination-flat mb-0">';c+='<li class="paginate_button page-item previous" id="listing_previous"><a href="#" aria-controls="order-listing" data-type="prev" data-page="0" tabindex="0" class="page-link"><span aria-hidden="true">&laquo;</span></li>';for(var s=0;s<i;)(++s>=r-3&&s<=r||s<=r+3&&s>=r)&&(c+='<li class="paginate_button page-item '+(r==s?"active":"")+'"><a href="#" aria-controls="order-listing" data-type="page" data-page="'+s+'" tabindex="0" class="page-link">'+s+"</a></li>");c+='<li class="paginate_button page-item next" id="order-listing_next"><a href="#" aria-controls="order-listing" data-type="next" data-page="2" tabindex="0" class="page-link"><span aria-hidden="true">&raquo;</span></a></li>',c+="</ul>",document.querySelector("#listing_paginate").innerHTML=c;var l,d=function(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=a(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var o=0,i=function(){};return{s:i,n:function(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,c=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return c=t.done,t},e:function(t){s=!0,r=t},f:function(){try{c||null==n.return||n.return()}finally{if(s)throw r}}}}(document.querySelectorAll(".page-link"));try{var u=function(){var t=l.value;t.addEventListener("click",(function(e){var a,o,r,c,s,l=parseInt(S()),d=l;switch(t.dataset.type){case"prev":(l-=1)<1&&(l=1);break;case"page":l=t.dataset.page;break;case"next":(l+=1)>i&&(l=i)}if(window.history.replaceState){var u=window.location.search;a="page",o=l,r=u,c=new RegExp("([?;&])"+a+"[^&;]*[;&]?"),u=((s=r.replace(c,"$1").replace(/&$/,"")).length>2?s+"&":"?")+(o?a+"="+o:""),window.history.replaceState("kenzap-cloud",document.title,window.location.pathname+u)}return d!=l&&n(),e.preventDefault(),!1}))};for(d.s();!(l=d.n()).done;)u()}catch(t){d.e(t)}finally{d.f()}}else document.querySelector("#listing_info").innerHTML=t("no records to display")},q=function(t,e){return e.stock_amount<=0?'<div data-stock="out" class="badge bg-danger text-light fw-light">'+d("Out of stock")+"</div>":e.stock_warning>=e.stock_amount?'<div data-stock="low" class="badge bg-warning text-dark fw-light">'+d("Low stock")+"</div>":'<div data-stock="in" class="badge bg-success text-light fw-light">'+d("In stock")+"</div>"},L=function(t,e){switch(e=T(e),e=(Math.round(100*parseFloat(e))/100).toFixed(2),t.state.settings.currency_symb_loc){case"left":e=t.state.settings.currency_symb+" "+e;break;case"right":e+=t.state.settings.currency_symb}return e},T=function(t){return t=t||0,t=parseFloat(t),t=Math.round(100*t)/100},M=function(t,e){return new Date(1e3*parseInt(e)).toLocaleDateString()},z=function(t,e){document.querySelector(t)&&(e.push.apply(e,[9,37,38,39,40,98,100,102,104]),n(document.querySelectorAll(t)).forEach((function(t){t.addEventListener("keydown",(function(t){var n=t.key.toLowerCase();"control"!=n&&"meta"!=n||(window[n]=!0),console.log(n.length+" / "+a+" / "+t.which);var a=n>="0"&&n<="9";return(window.control||window.meta)&&[86,88,65,67,90].includes(t.which)?(console.log("pushing"),!0):a||e.includes(t.which)?void 0:(t.preventDefault(),!1)})),t.addEventListener("keyup",(function(t){var e=t.key.toLowerCase();"control"!=e&&"meta"!=e||(window[e]=!1)}))})))},A=function(t){if(!t)throw new Error("DOM Element is undifined! Please choose HTML target element.");var e,n,a,o,i,r,c=t;function s(){e.innerHTML="",o.forEach((function(t,n){if(t){var a=document.createElement("li");a.innerHTML="".concat(t," <a>&times;</a>"),a.querySelector("a").addEventListener("click",(function(){var t;t=n,o=o.filter((function(e,n){return n!==t&&e})),s()})),e.appendChild(a)}})),c.setAttribute("data-simple-tags",o.toString())}a=(a=c.getAttribute("data-simple-tags")).split(","),o=a.map((function(t){return t.trim()})),i=document.createElement("ul"),(r=document.createElement("input")).setAttribute("placeholder",d("new tag")),c.appendChild(i),c.appendChild(r),e=c.firstElementChild,n=c.lastElementChild,s(),n.addEventListener("keyup",(function(t){var e=this.value.trim();(e.includes(",")||13===t.keyCode)&&(""!==e.replace(",","")&&o.push(e.replace(",","")),this.value=""),s()}))},H=function(t){var e=d("E-commerce 2.1.2 by %1$Kenzap%2$. ❤️ Licensed %3$GPLv3%4$.",'<a class="text-muted" href="https://kenzap.com/" target="_blank">',"</a>",'<a class="text-muted" href="https://github.com/kenzap/ecommerce" target="_blank">',"</a>");document.querySelector("footer .row").innerHTML='\n    <div class="d-sm-flex justify-content-center justify-content-sm-between">\n        <span class="text-muted text-center text-sm-left d-block d-sm-inline-block">'.concat(e,'</span>\n        <span class="float-none float-sm-right d-block mt-1 mt-sm-0 text-center text-muted">').concat("","</span>\n    </div>")},C=function(t){var e={img:[],price:0,price_per_unit:0,price_per_unit_prev:0,status:"1",tags:[],stock_amount:0,stock_unit:"kg",stock_warning:"",title:"",write_off:{type:"never",dof:[],time:"0",amount:0},updated:0};"edit"==t.state.action&&t.state.id&&(e=t.state.response.inventory.filter((function(e){return e._id==t.state.id}))[0]);var a=document.querySelector(".modal"),o=new bootstrap.Modal(a);a.querySelector(".modal-dialog").classList.add("modal-fullscreen"),a.querySelector(".modal-title").innerHTML="edit"==t.state.action?d("Edit Item"):d("Add Item"),a.querySelector(".modal-footer").innerHTML='\n        <button type="button" class="btn btn-primary btn-modal btn-add-item">'.concat("edit"==t.state.action?d("Update"):d("Add"),'</button>\n        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">').concat(d("Cancel"),'</button>\n        <button class="btn btn-danger btn-remove-item btn-lg- ').concat("edit"==t.state.action?"":"d-none",'" type="button" title="').concat(d("Remove application."),'"><span><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-trash" viewBox="0 0 16 16"><path d="M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0V6z"/><path fill-rule="evenodd" d="M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1v1zM4.118 4 4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4H4.118zM2.5 3V2h11v1h-11z"/></svg></span></button>\n    ');var i='\n\n    <h4 class="card-title mb-lg-4 mt-sm-3 mt-3">'.concat(d("Item"),'</h4>\n    <div class="row">\n        <div class="col-lg-6">\n            <div class="form-group row mb-lg-3 mt-1">\n            <label class="col-sm-3 col-form-label">').concat(d("Title"),'</label>\n            <div class="col-sm-9">\n                <input id="title" type="text" class="form-control inp" name="title" data-type="emails" value="').concat(e.title,'"  autocomplete="off">\n                <p class="form-text">').concat(d("Item description."),'</p>\n            </div>\n            </div>\n        </div>\n        <div class="col-lg-6">\n            <div class="form-group row mb-lg-3 mt-1">\n            <label class="col-sm-3 col-form-label">').concat(d("Price per 1 "),'<span id="price_stock_unit">').concat(e.stock_unit,'</span></label>\n            <div class="col-sm-9">\n                <div class="input-group">\n                    <input id="price_per_unit" type="text" class="form-control inp" name="price_per_unit" aria-label="Current stock amount" aria-describedby="basic-addon1" value="').concat(e.price_per_unit?e.price_per_unit:0,'" autocomplete="off">\n                    <span class="input-group-text" id="price_curr">').concat(l(t.state.settings.currency_symb?t.state.settings.currency_symb:""),'</span>\n                </div>\n                <p class="form-text">').concat(d("Price per one stock measurement unit."),'</p>\n            </div>\n            </div>\n        </div>\n    </div>\n\n    <h4 class="card-title mb-lg-4 mt-sm-0 mt-3">').concat(d("Stock"),'</h4>\n    <div class="row">\n        <div class="col-lg-6">\n            <div class="form-group row mb-lg-3 mt-1">\n            <label class="col-sm-3 col-form-label">').concat(d("Stock unit"),'</label>\n            <div class="col-sm-9">\n                <select id="stock_unit" class="form-select inp" name="stock_unit" data-type="select">\n                    <option value="g" ').concat("g"==e.stock_unit?"selected":"",">").concat(d("g"),'</option>\n                    <option value="kg" ').concat("kg"==e.stock_unit?"selected":"",">").concat(d("kg"),'</option>\n                    <option value="set" ').concat("set"==e.stock_unit?"selected":"",">").concat(d("set"),'</option>\n                    <option value="pc" ').concat("pc"==e.stock_unit?"selected":"",">").concat(d("piece"),'</option>\n                    <option value="l" ').concat("l"==e.stock_unit?"selected":"",">").concat(d("liter"),'</option>\n                </select>\n                <p class="form-text">').concat(d("Stock measurement unit for inventory deductions."),'</p>\n            </div>\n            </div>\n        </div>\n        <div class="col-lg-6">\n            <div class="form-group row mb-lg-3 mt-1">\n            <label class="col-sm-3 col-form-label">').concat(d("Current stock"),'</label>\n            <div class="col-sm-9">\n                <div class="input-group">\n                    <input id="stock_amount" type="text" class="form-control inp" name="stock_amount" aria-label="Current stock amount" aria-describedby="basic-addon1" value="').concat(e.stock_amount,'" autocomplete="off">\n                    <span class="input-group-text" id="stock_amount_unit">').concat(e.stock_unit,'</span>\n                </div>\n                <p class="form-text">').concat(d("Current stock amount."),'</p>\n            </div>\n            </div>\n        </div>\n        <div class="col-lg-6">\n            <div class="form-group row mb-lg-3 mt-1">\n            <label class="col-sm-3 col-form-label">').concat(d("Low stock"),'</label>\n            <div class="col-sm-9">\n                <div class="input-group">\n                    <input id="stock_warning" type="text" class="form-control inp" name="stock_warning" aria-label="Low stock warning" aria-describedby="basic-addon2" value="').concat(e.stock_warning,'" autocomplete="off">\n                    <span class="input-group-text" id="stock_warning_unit">').concat(e.stock_unit,'</span>\n                </div>\n                <p class="form-text">').concat(d("Trigger alert when stock drops below this value."),'</p>\n            </div>\n            </div>\n        </div>\n    </div>\n\n    <h4 class="card-title mb-lg-4 mt-sm-0 mt-3">').concat(d("Write-off"),'</h4>\n    <div class="row">\n        <div class="col-lg-6">\n            <div class="form-group row mb-lg-3 mt-1">\n            <label class="col-sm-3 col-form-label">').concat(d("Auto deduction"),'</label>\n            <div class="col-sm-9">\n                <div class="input-group">\n                    <select id="write_off" class="form-select inp" name="write_off" data-type="select">\n                        <option value="never" ').concat("never"==e.write_off.type?"selected":"",">").concat(d("Never"),'</option>\n                        <option value="daily" ').concat("daily"==e.write_off.type?"selected":"",">").concat(d("Daily"),'</option>\n                        <option value="ai" ').concat("ai"==e.write_off.type?"selected":"",">").concat(d("AI-driven"),'</option>\n                    </select>\n                </div>\n                <p class="form-text">').concat(d("Trigger alert when stock drops below this value."),'</p>\n            </div>\n            </div>\n            <div class="form-group row mb-lg-3 mt-1 write_off_cont ').concat("never"==e.write_off.type?"d-none":"",'">\n                <label class="col-sm-3 col-form-label">').concat(d("Days of week"),'</label>\n                <div class="col-sm-9">\n                    <div class="form-check">\n                        <label for="week-monday" class="form-check-label form-label">\n                            <input id="week-monday" type="checkbox" class="form-check-input " ').concat("",' value="1">\n                            ').concat(d("Monday"),'\n                        </label>\n                    </div>\n                    <div class="form-check">\n                        <label for="week-tuesday" class="form-check-label form-label">\n                            <input id="week-tuesday" type="checkbox" class="form-check-input" ').concat("",' value="1">\n                            ').concat(d("Tuesday"),'\n                        </label>\n                    </div>\n                    <div class="form-check">\n                        <label id="week-wednesday" class="form-check-label form-label">\n                            <input id="week-wednesday" type="checkbox" class="form-check-input" ').concat("",' value="1">\n                            ').concat(d("Wednesday"),'\n                        </label>\n                    </div>\n                    <div class="form-check">\n                        <label id="week-thursday" class="form-check-label form-label">\n                            <input id="week-thursday" type="checkbox" class="form-check-input" ').concat("",' value="1">\n                            ').concat(d("Thursday"),'\n                        </label>\n                    </div>\n                    <div class="form-check">\n                        <label id="week-friday" class="form-check-label form-label">\n                            <input id="week-friday" type="checkbox" class="form-check-input" ').concat("",' value="1">\n                            ').concat(d("Friday"),'\n                        </label>\n                    </div>\n                    <div class="form-check">\n                        <label id="week-saturday" class="form-check-label form-label">\n                            <input id="week-saturday" type="checkbox" class="form-check-input" ').concat("",' value="1">\n                            ').concat(d("Saturday"),'\n                        </label>\n                    </div>\n                    <div class="form-check">\n                        <label id="week-sunday" class="form-check-label form-label">\n                            <input id="week-sunday" type="checkbox" class="form-check-input" ').concat("",' value="1">\n                            ').concat(d("Sunday"),'\n                        </label>\n                    </div>\n                    <p class="form-text">').concat(d("Days of the week when discount is available."),'</p>\n                </div>\n            </div>\n        </div>\n        <div class="col-lg-6 write_off_cont ').concat("never"==e.write_off.type?"d-none":"",'">\n            <div class="form-group row mb-lg-3 mt-1">\n                <label class="col-sm-3 col-form-label">').concat(d("Amount"),'</label>\n                <div class="col-sm-9">\n                    <div class="input-group">\n                        <input id="write_off_amount" type="text" class="form-control inp" name="write_off_amount" aria-label="write off stock amount" aria-describedby="basic-addon1" value="').concat(e.write_off.amount?e.write_off.amount:0,'" autocomplete="off">\n                        <span class="input-group-text" id="write_off_amount_unit">').concat(e.stock_unit,'</span>\n                    </div>\n                    <p class="form-text">').concat(d("Amount to deduct from current stock amount."),'</p>\n                </div>\n            </div>\n            <div class="form-group row mb-lg-3 mt-1">\n                <label class="col-sm-3 col-form-label">').concat(d("When"),'</label>\n                <div class="col-sm-9">\n                    <select id="write_off_time" class="form-select inp" name="write_off_time" data-type="select">\n                        <option value="2" ').concat("2"==e.write_off.time?"selected":"",">").concat(d("2:00 AM"),'</option>\n                        <option value="4" ').concat("4"==e.write_off.time?"selected":"",">").concat(d("4:00 AM"),'</option>\n                        <option value="6" ').concat("6"==e.write_off.time?"selected":"",">").concat(d("6:00 AM"),'</option>\n                        <option value="8" ').concat("8"==e.write_off.time?"selected":"",">").concat(d("8:00 AM"),'</option>\n                        <option value="10" ').concat("10"==e.write_off.time?"selected":"",">").concat(d("10:00 AM"),'</option>\n                        <option value="12" ').concat("12"==e.write_off.time?"selected":"",">").concat(d("12:00 PM"),'</option>\n                        <option value="14" ').concat("14"==e.write_off.time?"selected":"",">").concat(d("14:00 PM"),'</option>\n                        <option value="16" ').concat("16"==e.write_off.time?"selected":"",">").concat(d("16:00 PM"),'</option>\n                        <option value="18" ').concat("18"==e.write_off.time?"selected":"",">").concat(d("18:00 PM"),'</option>\n                        <option value="20" ').concat("20"==e.write_off.time?"selected":"",">").concat(d("20:00 PM"),'</option>\n                        <option value="22" ').concat("22"==e.write_off.time?"selected":"",">").concat(d("22:00 PM"),'</option>\n                    </select>\n                    <p class="form-text">').concat(d("Local time when deduction is called."),'</p>\n                </div>\n            </div>\n        </div>\n    </div>\n\n    <h4 class="card-title mb-lg-4 mt-sm-0 mt-3">').concat(d("Tagging"),'</h4>\n    <div class="row">\n        <div class="col-lg-6">\n            <div class="form-group row mb-lg-3 mt-1">\n            <label class="col-sm-3 col-form-label">').concat(d("Tags"),'</label>\n            <div class="col-sm-9">\n                <div class="form-group">\n                    <div id="tags" class="simple-tags" data-simple-tags=""></div>\n                </div>\n                <p class="form-text">').concat(d("Use tagging for inventory grouping."),"</p>\n            </div>\n            </div>\n        </div>\n    </div>\n    ");a.querySelector(".modal-body").innerHTML=i,a.querySelector(".modal-body").innerHTML;var r=a.querySelector("#tags");e.tags&&r.setAttribute("data-simple-tags",e.tags),new A(r),z("#price",[8,46,190]),z("#stock_amount",[8,46,190,189,229]),z("#stock_warning",[8,46,190]),a.querySelector("#stock_unit").addEventListener("change",(function(t){t.preventDefault(),a.querySelector("#stock_warning_unit").innerHTML=t.currentTarget.value,a.querySelector("#stock_amount_unit").innerHTML=t.currentTarget.value,a.querySelector("#write_off_amount_unit").innerHTML=t.currentTarget.value,a.querySelector("#price_stock_unit").innerHTML=t.currentTarget.value})),a.querySelector("#write_off").addEventListener("change",(function(t){if(t.preventDefault(),n(a.querySelectorAll(".write_off_cont")).forEach((function(t){t.classList.add("d-none")})),"never"===t.currentTarget.value);else n(a.querySelectorAll(".write_off_cont")).forEach((function(t){t.classList.remove("d-none")}))})),a.querySelector(".btn-add-item").addEventListener("click",(function(e){if(e.preventDefault(),a.querySelector(".btn-add-item").dataset.loading)return!1;var i={write_off:{}};if(i.title=a.querySelector("#title").value.trim(),i.price_per_unit=parseFloat(a.querySelector("#price_per_unit").value.trim()),i.stock_unit=a.querySelector("#stock_unit").value.trim(),i.stock_amount=parseFloat(a.querySelector("#stock_amount").value.trim()),i.stock_warning=parseFloat(a.querySelector("#stock_warning").value.trim()),i.write_off.type=a.querySelector("#write_off").value.trim(),i.write_off.time=a.querySelector("#write_off_time").value.trim(),i.write_off.amount=parseFloat(a.querySelector("#write_off_amount").value.trim()),i.tags=[],n(a.querySelectorAll("#tags ul li")).forEach((function(t){i.tags.push(t.innerHTML.replace("<a>×</a>","").trim())})),i.status="1",i.img=[],i.cats=[],i.title.length<2)alert(d("Please provide longer title"));else{0==i.price_per_unit.length&&(i.price_per_unit="0"),0==i.stock_amount&&(i.stock_amount="0"),i.stock_warning.length<2&&(i.stock_warning=0),i.price_per_unit_prev=i.price_per_unit;var r={update:{type:"create",key:"ecommerce-inventory",data:i}};"edit"==t.state.action&&t.state.id&&(r.update.type="update",r.update.id=t.state.id);var c=a.querySelector(".btn-add-item").innerHTML;a.querySelector(".btn-add-item").dataset.loading=!0,a.querySelector(".btn-add-item").innerHTML='<span class="spinner-border spinner-border-sm me-2" role="status" aria-hidden="true"></span>'+d("Loading.."),fetch("https://api-v1.kenzap.cloud/",{method:"post",headers:f(),body:JSON.stringify({query:r})}).then((function(t){return t.json()})).then((function(e){a.querySelector(".btn-add-item").dataset.loading="",a.querySelector(".btn-add-item").innerHTML=c,e.success?(o.hide(),t.getData(),g("edit"==t.state.action?d("Item updated"):d("Item created"))):y(e)})).catch((function(t){y(t)}))}})),a.querySelector(".btn-remove-item").addEventListener("click",(function(e){if(e.preventDefault(),a.querySelector(".btn-add-item").dataset.loading)return!1;if(confirm(d("Completely remove from inventory?"))){var n=a.querySelector(".btn-remove-item").innerHTML;a.querySelector(".btn-add-item").dataset.loading=!0,a.querySelector(".btn-remove-item").innerHTML='<span class="spinner-border spinner-border-sm me-2" role="status" aria-hidden="true"></span>'+d("Loading.."),fetch("https://api-v1.kenzap.cloud/",{method:"post",headers:f(),body:JSON.stringify({query:{product:{type:"delete",key:"ecommerce-inventory",id:t.state.id}}})}).then((function(t){return t.json()})).then((function(e){a.querySelector(".btn-add-item").dataset.loading="",a.querySelector(".btn-add-item").innerHTML=n,e.success?(o.hide(),t.getData(),g(d("Item removed"))):y(e)})).catch((function(t){y(t)}))}})),o.show(),"edit"!=t.state.action&&setTimeout((function(){return a.querySelector("#title").focus()}),100)},E=function(t){var e={img:[],price:0,price_per_unit:0,price_per_unit_prev:0,status:"1",tags:[],stock_amount:0,stock_unit:"kg",stock_warning:"",title:"",updated:0};(e=t.state.response.inventory.filter((function(e){return e._id==t.state.id}))[0]).stock_amount=parseFloat(e.stock_amount),e.price||(e.price=0);var a=document.querySelector(".modal"),o=new bootstrap.Modal(a);a.querySelector(".modal-dialog").classList.add("modal-fullscreen"),a.querySelector(".modal-title").innerHTML='<div class="d-flex align-items-center">'+l(e.title)+'<div class="fs-6 ms-2">'+q(0,e)+"</div></div>",a.querySelector(".modal-footer").innerHTML='\n        <button type="button" class="btn btn-danger btn-modal btn-deduct btn-stock-update d-none">'.concat(d("Deduct"),'</button>\n        <button type="button" class="btn btn-success btn-modal btn-top-up btn-stock-update d-none">').concat(d("Top up"),'</button>\n        <button type="button" class="btn btn-primary btn-modal btn-settings">').concat(d("Settings"),'</button>\n        <button class="btn btn-outline-secondary remove-application btn-lg d-none" type="button" title="').concat(d("Remove application."),'"><span><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-trash" viewBox="0 0 16 16"><path d="M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0V6z"/><path fill-rule="evenodd" d="M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1v1zM4.118 4 4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4H4.118zM2.5 3V2h11v1h-11z"/></svg></span></button>\n        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">').concat(d("Close"),"</button>\n    ");var i='\n\n    <h4 class="card-title mb-lg-4 mt-sm-3 mt-3 mb-0">'.concat(d("Live stock"),'</h4>\n    <div class="form-text d-flex">\n        <div class="d-flex align-items-center">\n            <div>').concat(parseFloat(e.stock_amount).toFixed(2)," ").concat(e.stock_unit,'</div>\n            <div id="stock_arrow" class="triangle_down mx-2"></div>\n        </div>\n        <div class="d-flex align-items-center ms-2">\n            <div>').concat(L(t,parseFloat(e.price_per_unit)),'</div>\n            <div id="price_arrow" class="').concat(parseFloat(e.price_per_unit_prev)-parseFloat(e.price_per_unit)>=0?"triangle_down triangle_green":"triangle_up triangle_red",' mx-2"></div>\n        </div>\n        <div class="d-flex align-items-center ms-2">\n            <div>').concat(d("5 days"),'</div>\n            <div class="mx-2 d-flex">\n                <svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" fill="currentColor" class="bi bi-clock-history" viewBox="0 0 16 16">\n                    <path d="M8.515 1.019A7 7 0 0 0 8 1V0a8 8 0 0 1 .589.022l-.074.997zm2.004.45a7.003 7.003 0 0 0-.985-.299l.219-.976c.383.086.76.2 1.126.342l-.36.933zm1.37.71a7.01 7.01 0 0 0-.439-.27l.493-.87a8.025 8.025 0 0 1 .979.654l-.615.789a6.996 6.996 0 0 0-.418-.302zm1.834 1.79a6.99 6.99 0 0 0-.653-.796l.724-.69c.27.285.52.59.747.91l-.818.576zm.744 1.352a7.08 7.08 0 0 0-.214-.468l.893-.45a7.976 7.976 0 0 1 .45 1.088l-.95.313a7.023 7.023 0 0 0-.179-.483zm.53 2.507a6.991 6.991 0 0 0-.1-1.025l.985-.17c.067.386.106.778.116 1.17l-1 .025zm-.131 1.538c.033-.17.06-.339.081-.51l.993.123a7.957 7.957 0 0 1-.23 1.155l-.964-.267c.046-.165.086-.332.12-.501zm-.952 2.379c.184-.29.346-.594.486-.908l.914.405c-.16.36-.345.706-.555 1.038l-.845-.535zm-.964 1.205c.122-.122.239-.248.35-.378l.758.653a8.073 8.073 0 0 1-.401.432l-.707-.707z"/>\n                    <path d="M8 1a7 7 0 1 0 4.95 11.95l.707.707A8.001 8.001 0 1 1 8 0v1z"/>\n                    <path d="M7.5 3a.5.5 0 0 1 .5.5v5.21l3.248 1.856a.5.5 0 0 1-.496.868l-3.5-2A.5.5 0 0 1 7 9V3.5a.5.5 0 0 1 .5-.5z"/>\n                </svg>\n            </div>\n        </div>\n    </div>\n\n    <div class="row">\n        <div class="col-lg-12">\n            <div class="form-group row mb-lg-3 mt-1"></div>\n            <div id="live_stock" style="width: 100%; height: 320px;"></div>\n        </div>\n    </div>\n\n    <h4 class="card-title mb-lg-4 mt-sm-0 mt-3">').concat(d("History"),'</h4>\n\n    <div class="row mb-4">\n        <div class="col-sm-12">\n            <div class="table-responsive-">\n                <table class="table table-hover table-borderless align-middle table-striped table-history-list mb-0" style="">\n                    <thead>\n                        <tr>\n                            <th>\n                                ').concat(d("Details"),"\n                            </th>\n                            <th>\n                                ").concat(d("Amount"),'\n                            </th>\n                            <th>\n                              \n                            </th>\n                        </tr>\n                    </thead>\n                    <tbody id="inventory-history">\n                        <tr>\n                            <td colspan="3">\n                                ').concat(d("Loading"),'\n                            </td>\n                        </tr>\n                    </tbody>\n                </table>\n            </div>\n        </div>\n    </div>\n    \n    <div class="row mb-4">\n        <div class="col-lg-5">\n            <div class="form-group row mb-lg-3 mt-1">\n            <label class="col-sm-3 col-form-label">').concat(d("Details"),'</label>\n            <div class="col-sm-9">  \n                <input id="details" type="text" class="form-control inp mb-sm-2" name="details" aria-label="details" aria-describedby="basic-addon-details" value="" autocomplete="off">\n                <p class="form-text d-none">').concat(d("Use tagging for inventory grouping."),'</p>\n            </div>\n            </div>\n        </div>\n        <div class="col-lg-5">\n            <div class="form-group row mb-lg-3 mt-1">\n            <label class="col-sm-3 col-form-label">').concat(d("Amount"),'</label>\n            <div class="col-sm-9">\n                <div class="input-group mb-sm-2">           \n                    <input id="stock_amount" type="text" class="form-control inp" name="stock_amount" aria-label="Current stock amount" aria-describedby="basic-addon1" value="" autocomplete="off">\n                    <span class="input-group-text" id="stock_amount_unit">').concat(e.stock_unit,'</span>\n                </div>\n                <p class="form-text d-none">').concat(d("Use tagging for inventory grouping."),'</p>\n            </div>\n            </div>\n        </div>\n        <div class="col-lg-5">\n            <div class="form-group row mb-lg-3 mt-1">\n            <label class="col-sm-3 col-form-label">').concat(d("Total price"),'</label>\n            <div class="col-sm-9">\n                <div class="input-group mb-sm-2">           \n                    <input id="stock_price" type="text" class="form-control inp" name="stock_price" aria-label="Price" aria-describedby="basic-addon2" value="0" autocomplete="off">\n                    <span class="input-group-text" id="price_cur">').concat(l(t.state.settings.currency_symb?t.state.settings.currency_symb:""),'</span>\n                </div>\n                <p class="form-text d-none">').concat(d("Use tagging for inventory grouping."),"</p>\n            </div>\n            </div>\n        </div>\n    </div>\n\n    ");a.querySelector(".modal-body").innerHTML=i;google.charts.load("current",{packages:["corechart"]}),google.charts.setOnLoadCallback((function(){var t=google.visualization.arrayToDataTable([[d("Day"),d("Stock amount ("+e.stock_unit+")")],[d("-7 days"),e.stock_amount+9],[d("-6 days"),e.stock_amount+8.1],[d("-5 days"),e.stock_amount+7.5],[d("-4 days"),e.stock_amount+6],[d("-3 days"),e.stock_amount+3.5],[d("-2 days"),e.stock_amount+1.5],[d("Yesterday"),e.stock_amount+.3],[d("Today"),e.stock_amount]]),n={vAxis:{title:d("Stock amount ("+e.stock_unit+")")},isStacked:!0,legend:{position:"left"}};new google.visualization.SteppedAreaChart(a.querySelector("#live_stock")).draw(t,n)})),z("#stock_price",[8,46,190,189,229]),z("#stock_amount",[8,46,190,189,229]),a.querySelector(".btn-settings").addEventListener("click",(function(e){t.state.action="edit",o.hide(),C(t)}));var r=function(t){var e=parseFloat(t.currentTarget.value);return 0==t.currentTarget.value.length?(a.querySelector(".btn-top-up").classList.add("d-none"),void a.querySelector(".btn-deduct").classList.add("d-none")):e<0?(a.querySelector(".btn-top-up").classList.add("d-none"),a.querySelector(".btn-deduct").classList.remove("d-none"),a.querySelector("#stock_price").setAttribute("disabled",!0),void(a.querySelector("#stock_price").value="")):e>0?(a.querySelector(".btn-top-up").classList.remove("d-none"),a.querySelector(".btn-deduct").classList.add("d-none"),void a.querySelector("#stock_price").removeAttribute("disabled")):void 0};a.querySelector("#stock_amount").addEventListener("keyup",(function(t){r(t)})),a.querySelector("#stock_amount").addEventListener("click",(function(t){r(t)})),n(a.querySelectorAll(".btn-stock-update")).forEach((function(n){n.addEventListener("click",(function(n){if(n.preventDefault(),a.querySelector(".btn-stock-update").dataset.loading)return!1;var o=new Date,i={};if(i.iid=t.state.id,i.details=a.querySelector("#details").value.trim(),i.price=a.querySelector("#stock_price").value.trim(),i.stock_unit=a.querySelector("#stock_amount_unit").innerHTML.trim(),i.amount=parseFloat(a.querySelector("#stock_amount").value.trim()),i.ym=o.getFullYear()+""+_(o.getMonth()+1),i.ymd=o.getFullYear()+""+_(o.getMonth()+1)+_(o.getDay()),i.time=Math.round(o.getTime()/1e3),i.details.length<2)alert(d("Please provide longer description"));else if(0!=i.amount.length)if(i.amount>0&&0==i.price.length)alert(d("Please enter price"));else{i.price.length>0&&(i.price=parseFloat(i.price));var r={update:{type:"create",key:"ecommerce-inventory-history",data:i}};t.state.btnHTML=a.querySelector(".btn-stock-update").innerHTML,a.querySelector(".btn-stock-update").dataset.loading=!0,a.querySelector(".btn-stock-update").innerHTML='<span class="spinner-border spinner-border-sm me-2" role="status" aria-hidden="true"></span>'+d("Loading.."),fetch("https://api-v1.kenzap.cloud/",{method:"post",headers:f(),body:JSON.stringify({query:r})}).then((function(t){return t.json()})).then((function(n){n.success?s(t,e,i):y(n)})).catch((function(t){y(t)}))}else alert(d("Please enter amount"))}))}));var s=function(t,e,n){e.price||(e.price=0);var i=null;console.log(e),console.log(n),i=n.amount>0?{stock_amount:parseFloat(e.stock_amount)+parseFloat(n.amount),price_per_unit:Math.round(parseFloat(n.price)/parseFloat(n.amount)*100)/100,price_per_unit_prev:Math.round(parseFloat(e.price)/parseFloat(e.stock_amount)*100)/100,price:Math.round(100*parseFloat(n.price))/100,price_prev:e.price}:{stock_amount:parseFloat(e.stock_amount)+parseFloat(n.amount)};var r={update:{type:"update",id:t.state.id,key:"ecommerce-inventory",data:i}};fetch("https://api-v1.kenzap.cloud/",{method:"post",headers:f(),body:JSON.stringify({query:r})}).then((function(t){return t.json()})).then((function(e){e.success?(a.querySelector(".btn-stock-update").dataset.loading="",a.querySelector(".btn-stock-update").innerHTML=t.state.btnHTML,o.hide(),t.getData(),g(d("Stock updated"))):y(e)})).catch((function(t){y(t)}))},u=function(t,e){console.log(e);var n=t.state.history.filter((function(t){return t._id==e}))[0];document.querySelector("#details").value=n.details,document.querySelector("#stock_amount").value=n.amount,document.querySelector("#stock_price").value=n.price,(t=>{let e=new MouseEvent("click",{bubbles:!0,cancelable:!0,view:window});t.dispatchEvent(e)})(document.querySelector("#stock_amount")),document.querySelector("#stock_amount").focus(),g(d("Row copied"))},p=function(t,e){fetch("https://api-v1.kenzap.cloud/",{method:"post",headers:f(),body:JSON.stringify({query:{history:{type:"delete",key:"ecommerce-inventory-history",id:e}}})}).then((function(t){return t.json()})).then((function(e){e.success?(m(t),g(d("Record removed"))):y(e)})).catch((function(t){y(t)}))},m=function(t){fetch("https://api-v1.kenzap.cloud/",{method:"post",headers:f(),body:JSON.stringify({query:{history:{type:"find",key:"ecommerce-inventory-history",fields:["_id","details","price","price_per_unit","stock_unit","amount","time","updated"],limit:10,term:[{field:"iid",relation:"=",type:"string",value:t.state.id}],offset:"".length>0?0:10*S()-10,search:{field:"details",s:""},sortby:{field:"created",order:"DESC"}}}})}).then((function(t){return t.json()})).then((function(e){if(e.success){if(t.state.history=e.history,0==e.history.length)return void(document.querySelector("#inventory-history").innerHTML='<tr><td colspan="2" class="form-text">'.concat(d("No data to display."),"</td></tr>"));e.history&&(document.querySelector("#inventory-history").innerHTML=e.history.map((function(e,n){return'\n                        <tr>\n                            <td data-id="'.concat(c(e._id),'">\n                                ').concat(e.details,'\n                                <div class="form-text">').concat(M(0,e.time)," / ").concat(L(t,e.price),'</div>\n                            </td>\n                            <td data-id="').concat(c(e._id),'">\n                                <div class="fw-bold ').concat(e.amount<0?"text-danger":"text-success",'">').concat((e.amount<0?"":"+")+e.amount+e.stock_unit,'</div>\n                            </td>\n                            <td class="text-end d-none-">\n                                <div class="dropdown inventoryHistoryActionsCont">\n                                    <svg id="inventoryHistoryActions').concat(n,'" data-bs-toggle="dropdown" data-boundary="viewport" aria-expanded="false" xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" class="bi bi-three-dots-vertical dropdown-toggle po" viewBox="0 0 16 16">\n                                        <path d="M9.5 13a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0zm0-5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0zm0-5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0z"/>\n                                    </svg>\n                                    <ul class="dropdown-menu" aria-labelledby="inventoryHistoryActions').concat(n,'">\n                                        <li><a class="dropdown-item po" href="#" data-action="copy" data-id="').concat(c(e._id),'" data-index="').concat(n,'">').concat(d("Copy"),'</a></li>\n                                        <li><hr class="dropdown-divider"></li>\n                                        <li><a class="dropdown-item po" href="#" data-action="remove" data-id="').concat(c(e._id),'" data-index="').concat(n,'">').concat(d("Remove"),"</a></li>\n                                    </ul>\n                                </div>\n                            </td>\n                        </tr>")})).join("")),n(document.querySelectorAll(".inventoryHistoryActionsCont .dropdown-item")).forEach((function(e){e.addEventListener("click",(function(e){switch(e.currentTarget.dataset.action){case"copy":u(t,e.currentTarget.dataset.id);break;case"remove":if(!confirm(d("Remove this record?")))return;p(t,e.currentTarget.dataset.id)}}))}))}else y(e)})).catch((function(t){y(t)}))};m(t),o.show()},D=(h=function t(){var a=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),e(this,"getData",(function(){a.state.firstLoad&&(()=>{let t=document.querySelector(".loader");t&&(t.style.display="block")})();var t=document.querySelector(".search-cont input")?document.querySelector(".search-cont input").value:"",e=[];document.querySelector(".select-stock-btn")&&"in"==document.querySelector(".select-stock-btn").dataset.key&&e.push({type:"string",field:"stock_amount",value:0,relation:"!="}),document.querySelector(".select-stock-btn")&&"out"==document.querySelector(".select-stock-btn").dataset.key&&e.push({type:"string",field:"stock_amount",value:0,relation:"="});var n=[];document.querySelector(".select-title-btn")&&"title"==document.querySelector(".select-title-btn").dataset.key&&n.push({field:"title",order:"ASC"}),document.querySelector(".select-title-btn")&&"updated"==document.querySelector(".select-title-btn").dataset.key&&n.push({field:"updated",order:"DESC"}),0==n.length&&n.push({field:"title",order:"ASC"});var o={};a.state.tag&&(console.log("tag: "+a.state.tag),document.querySelector(".select-title-btn").innerHTML=d("Tag %1$",'<span class="fw-light">'+a.state.tag+"</span>"),o={field:"tags",s:a.state.tag}),t&&(o={field:"title",s:t}),fetch("https://api-v1.kenzap.cloud/",{method:"post",headers:f(),body:JSON.stringify({query:{user:{type:"authenticate",fields:["avatar"],token:m("kenzap_token")},locale:{type:"locale",source:["extension"],key:"ecommerce"},settings:{type:"get",key:"ecommerce-settings",fields:["currency","currency_symb","currency_symb_loc","tax_calc","tax_auto_rate","tax_rate","tax_display","fee_calc","fee_percent","fee_display"]},inventory:{type:"find",key:"ecommerce-inventory",fields:["_id","id","img","status","tags","price","price_prev","price_per_unit","price_per_unit_prev","write_off","title","stock_amount","stock_unit","stock_warning","updated"],limit:a.state.limit,offset:t.length>0?0:S()*a.state.limit-a.state.limit,search:o,sortby:n,term:e}}})}).then((function(t){return t.json()})).then((function(t){(()=>{let t=document.querySelector(".loader");t&&(t.style.display="none")})(),t.success?(a.state.settings=t.settings,a.state.response=t,(t=>{if(t.header&&localStorage.setItem("header",t.header),!document.querySelector("#k-script")){let t=document.createElement("div");t.innerHTML=localStorage.getItem("header"),t=t.firstChild,document.body.prepend(t),Function(document.querySelector("#k-script").innerHTML).call("test")}t.locale&&window.i18n.init(t.locale)})(t),a.html(),a.render(t),a.initListeners(),a.initPagination(t),H(),a.state.firstLoad=!1):y(t)})).catch((function(t){y(t)}))})),e(this,"authUser",(function(t){t.user&&t.user.success})),e(this,"html",(function(){a.state.firstLoad&&(document.querySelector("#contents").innerHTML=function(t){return'\n    <div class="container">\n\n        <div class="d-md-flex justify-content-between bd-highlight mb-3">\n            <nav class="bc" aria-label="breadcrumb"></nav>\n            <button class="btn btn-primary btn-add mt-3 mb-1 mt-md-0 mb-md-0" type="button">'.concat(t("Add item"),'</button>\n        </div>\n\n        <div class="row">\n            <div class="col-md-12 grid-margin grid-margin-lg-0 grid-margin-md-0 stretch-card">\n                <div class="card border-white shadow-sm border-0">\n                    <div class="card-body p-0">\n                        <div class="no-footer">\n                            <div class="row">\n                                <div class="col-sm-12">\n                                    <div class="table-responsive">\n                                        <table class="table table-hover table-borderless align-middle table-striped table-p-list mb-0" >\n                                            <thead>\n\n                                            </thead>\n                                            <tbody>\n\n                                            </tbody>\n                                        </table>\n                                    </div>\n                                </div>\n                            </div>\n\n                            <div class="row my-2">\n                                <div class="col-sm-12 col-md-5 d-flex align-items-center">\n                                    <div class="dataTables_info mx-2 text-secondary fw-lighter " id="listing_info" role="status" aria-live="polite">&nbsp;</div>\n                                </div>\n                                <div class="col-sm-12 col-md-7">\n                                    <div class="dataTables_paginate paging_simple_numbers m-2" id="listing_paginate">\n                                    </div>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>\n    \n    <div class="modal" tabindex="-1">\n        <div class="modal-dialog">\n            <div class="modal-content">\n                <div class="modal-header">\n                    <h3 class="modal-title"></h3>\n                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>\n                </div>\n                <div class="modal-body">\n\n                </div>\n                <div class="modal-footer">\n                    <button type="button" class="btn btn-primary btn-modal"></button>\n                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal"></button>\n                </div>\n            </div>\n        </div>\n    </div>\n    \n    ')}(__))})),e(this,"render",(function(t){console.log(t);var e=a;if(a.state.firstLoad&&((t=>{let e='<ol class="breadcrumb mt-2 mb-0">';for(let n of t)void 0===n.link?e+=`<li class="breadcrumb-item">${n.text}</li>`:e+=`<li class="breadcrumb-item"><a href="${n.link}">${n.text}</a></li>`;e+="</ol>",document.querySelector(".bc").innerHTML=e})([{link:u("https://dashboard.kenzap.cloud"),text:d("Home")},{link:u("/"),text:d("E-commerce")},{text:d("Inventory")}]),document.querySelector(".table thead").innerHTML='\n                <tr>\n                    <th class="align-middle text-center">\n                        <div class="d-block m-auto">\n                            <svg xmlns="http://www.w3.org/2000/svg" width="19" height="19" fill="#212529" class="bi justify-content-end bi-search" viewBox="0 0 16 16" >\n                                <path d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001c.03.04.062.078.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1.007 1.007 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0z"></path>\n                            </svg>\n                        </div>\n                    </th>\n                    <th class="align-middle">\n                        <div class="search-cont input-group input-group-sm mb-0 justify-content-start">     \n                            <div class="input-group">\n                                <input type="text" placeholder="'.concat(d("Search inventory"),'" class="form-control border-top-0 border-start-0 border-end-0 rounded-0 pe-4" aria-label="').concat(d("Search inventory"),'" aria-describedby="inputGroup-sizing-sm" style="max-width: 200px;">\n                                <button type="button" class="btn bg-transparent btn-search-clear" style="margin-left: -32px; z-index: 100;">\n                                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-x-circle" viewBox="0 0 16 16">\n                                        <path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z"/>\n                                        <path d="M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z"/>\n                                    </svg>\n                                </button>\n                            </div>\n                        </div>\n                        <div class="st-opts st-table dropdown dropstart-">\n                            <a class="text-black text-dark text-decoration-none fw-bolder border-0 dropdown-toggle select-title-btn" data-key="key" href="#" role="button" id="order-updated" data-id="updated" data-value="" data-bs-toggle="dropdown" aria-expanded="false">').concat(d("Title"),'</a>\n                            <ul class="dropdown-menu select-title" aria-labelledby="order-title">\n                                <li><a class="dppi dropdown-item" data-key="title" href="#" >').concat(d("Title"),'</a></li>\n                                <li><a class="dppi dropdown-item" data-key="updated" href="#" >').concat(d("Updated"),'</a></li>\n                                <li><a class="dppi dropdown-item" data-key="tag" href="#" >').concat(d("Tag"),'</a></li>\n                            </ul>\n                        </div>\n                    </th>\n                    <th class="align-middle">\n                        <a class="text-black text-dark text-decoration-none fw-bolder border-0 dropdown-toggle select-stock-btn" href="#" data-key="" role="button" id="order-updated" data-id="updated" data-value="" data-bs-toggle="dropdown" aria-expanded="false">').concat(d("All"),'</a>\n                        <ul class="dropdown-menu select-stock" aria-labelledby="order-stock">\n                            <li><a class="dppi dropdown-item" data-key="" href="#" >').concat(d("All"),'</a></li>\n                            <li><a class="dppi dropdown-item" data-key="in" href="#" >').concat(d("In stock"),'</a></li>\n                            <li><a class="dppi dropdown-item d-none" data-key="low" href="#" >').concat(d("Low stock"),'</a></li>\n                            <li><a class="dppi dropdown-item" data-key="out" href="#" >').concat(d("Out of stock"),'</a></li>\n                        </ul>\n                    </th>\n                    <th class="align-middle d-none d-sm-table-cell">\n                        ').concat(d("Price"),'\n                    </th>\n                    <th class="align-middle d-none d-sm-table-cell">\n                        ').concat(d("Updated"),'\n                    </th>\n                    <th class="d-none"></th>\n                </tr>')),0!=t.inventory.length){var n=(()=>{let t=new URLSearchParams(window.location.search);return t.get("sid")?t.get("sid"):""})(),o="";for(var i in t.inventory){t.inventory[i].stock_warning||(t.inventory[i].stock_warning=0),t.inventory[i].stock_warning=parseFloat(t.inventory[i].stock_warning),t.inventory[i].stock_amount=parseFloat(t.inventory[i].stock_amount);var r="https://cdn.kenzap.com/loading.png";void 0===t.inventory[i].img&&(t.inventory[i].img=[]),t.inventory[i].img[0]&&(r=CDN+"/S"+n+"/product-"+t.inventory[i]._id+"-1-100x100.jpeg?"+t.inventory[i].updated),o+='\n                <tr>\n                    <td>\n                        <div class="timgc view-item" data-id="'.concat(c(t.inventory[i]._id),'">\n                            <a href="#"><img src="').concat(r,'" data-srcset="').concat(r,'" class="img-fluid rounded" alt="').concat(s("Product placeholder"),'" srcset="').concat(r,'" ></a>\n                        </div>\n                    </td>\n                    <td class="destt view-item" data-id="').concat(c(t.inventory[i]._id),'" style="max-width:250px;min-width:120px;">\n                        <div class="my-1"> \n                            <a class="text-body" href="#" >').concat(t.inventory[i].title,'</a>\n                            <div class="form-text form-text d-flex fst-italic my-0">\n                                <div class="d-flex align-items-center">\n                                    <div>').concat(parseFloat(t.inventory[i].stock_amount).toFixed(2)," ").concat(t.inventory[i].stock_unit,'</div>\n                                    <div id="stock_arrow" class="triangle_down mx-2"></div>\n                                </div>\n                                <div class="d-flex align-items-center ms-1">\n                                    <div>').concat(L(e,parseFloat(t.inventory[i].price_per_unit)),'</div>\n                                    <div id="price_arrow" class="').concat(parseFloat(t.inventory[i].price_per_unit_prev)-parseFloat(t.inventory[i].price_per_unit)>0?"triangle_down triangle_green":""," ").concat(parseFloat(t.inventory[i].price_per_unit_prev)-parseFloat(t.inventory[i].price_per_unit)<0?"triangle_up triangle_red":"",' mx-2"></div>\n                                </div>\n                            </div>\n                        </div>\n                    </td>\n                    <td>\n                        <span>').concat(q(0,t.inventory[i]),'</span>\n                    </td>\n                    <td class="d-none d-sm-table-cell">\n                        <span>').concat(L(e,t.inventory[i].price),'</span>\n                    </td>\n                    <td class="d-none d-sm-table-cell">\n                        <span>').concat(M(__,t.inventory[i].updated),'</span>\n                    </td>\n                    <td class="text-end d-none">\n\n                    </td>\n                </tr>')}document.querySelector(".table tbody").innerHTML=o,t.inventory.length<2?document.querySelector(".table tbody").style.height="150px":document.querySelector(".table tbody").style.height="auto"}else document.querySelector(".table tbody").innerHTML='<tr><td colspan="6" class="form-text">'.concat(d("No items to display."),"</td></tr>")})),e(this,"initListeners",(function(){b(".view-item",(function(t){a.viewItem(t)})),b(".table-p-list .bi-search",a.listeners.searchInventoryActivate),b(".table-p-list .btn-search-clear",a.listeners.searchInventoryDeactivate),b(".table-p-list .inventoryActionsCont .dropdown-item",a.listeners.tableAction),b(".select-stock a",a.listeners.stockSort),b(".select-title a",a.listeners.titleSort),a.state.firstLoad&&b(".btn-add",a.addItem)})),e(this,"listeners",{titleSort:function(t){t.preventDefault(),a.state.tag="","tag"==t.currentTarget.dataset.key?function(t){var e=document.querySelector(".modal");t.state.modalCont=new bootstrap.Modal(e),e.querySelector(".modal-dialog").classList.add("modal-lg"),e.querySelector(".modal-title").innerHTML=d("Sort by Tag"),e.querySelector(".modal-footer").innerHTML='\n        <button type="button" class="btn btn-success btn-modal btn-add btn-inventory-add d-none">'.concat(d("Add"),'</button>\n        <button class="btn btn-outline-secondary remove-application btn-lg d-none" type="button" title="').concat(d("Remove application."),'"><span><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-trash" viewBox="0 0 16 16"><path d="M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0V6z"/><path fill-rule="evenodd" d="M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1v1zM4.118 4 4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4H4.118zM2.5 3V2h11v1h-11z"/></svg></span></button>\n        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">').concat(d("Close"),"</button>\n    "),e.querySelector(".modal-body").innerHTML='\n        <div class="row mb-4">\n            <div class="col-sm-12">\n                <div class="table-responsive-">\n                    <table class="table table-hover table-borderless align-middle table-striped table-inventory-list mb-0" style="">\n                        <tbody id="category-list">\n                            <tr>\n                                <td >\n                                    '.concat(d("Loading"),"\n                                </td>\n                            </tr>\n                        </tbody>\n                    </table>\n                </div>\n            </div>\n        </div>\n    "),function(t){var e=[];fetch("https://api-v1.kenzap.cloud/",{method:"post",headers:f(),body:JSON.stringify({query:{inventory:{type:"find",key:"ecommerce-inventory",fields:["_id","tags"],limit:250,offset:"".length>0?0:250*S()-250,term:[{type:"string",field:"tags",value:"[]",relation:"!="}]}}})}).then((function(t){return t.json()})).then((function(a){if(a.success){if(t.state.inventory=a.inventory,0==a.inventory.length)return void(document.querySelector("#category-list").innerHTML='<tr><td colspan="2" class="form-text">'.concat(d("No data to display."),"</td></tr>"));console.log(a.inventory),a.inventory.forEach((function(t,n){t.tags.forEach((function(t,n){0==e.filter((function(e){return t==e.title})).length&&e.push({title:t})}))})),console.log(e),document.querySelector("#category-list").innerHTML=e.map((function(t,e){return'\n                        <tr>\n                            <td class="add-inventory-item" data-tag="'.concat(c(t.title),'">\n                                ').concat(l(t.title),'\n                            </td>\n                            <td class="text-end d-none- add-inventory-item" data-index="').concat(e,'" data-tag="').concat(c(t.title),'">\n                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-plus-circle text-success po" viewBox="0 0 16 16">\n                                    <path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z"/>\n                                    <path d="M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4z"/>\n                                </svg>\n                            </td>\n                        </tr>')})).join(""),n(document.querySelectorAll(".add-inventory-item")).forEach((function(e){e.addEventListener("click",(function(n){t.state.tag=e.dataset.tag,t.state.modalCont.hide(),t.getData()}))}))}else y(a)})).catch((function(t){y(t)}))}(t),t.state.modalCont.show()}(a):(document.querySelector(".select-title-btn").innerHTML=t.currentTarget.innerHTML,document.querySelector(".select-title-btn").dataset.key=t.currentTarget.dataset.key,a.getData())},stockSort:function(t){t.preventDefault(),document.querySelector(".select-stock-btn").innerHTML=t.currentTarget.innerHTML,document.querySelector(".select-stock-btn").dataset.key=t.currentTarget.dataset.key,a.getData()},searchInventoryActivate:function(t){t.preventDefault(),document.querySelector(".table-p-list thead tr th:nth-child(2) .st-table").style.display="none",document.querySelector(".table-p-list thead tr th:nth-child(2) .search-cont").style.display="flex",document.querySelector(".table-p-list thead tr th:nth-child(2) .search-cont input").focus(),((t,e)=>{if(document.querySelector(t))for(let n of document.querySelectorAll(t))n.removeEventListener("keyup",e,!0),n.addEventListener("keyup",e,!0)})(".table-p-list thead tr th:nth-child(2) .search-cont input",a.listeners.searchInventory)},searchInventoryDeactivate:function(t){t.preventDefault(),document.querySelector(".table-p-list thead tr th:nth-child(2) .st-table").style.display="block",document.querySelector(".table-p-list thead tr th:nth-child(2) .search-cont").style.display="none",document.querySelector(".search-cont input").value="",setTimeout((function(){a.getData()}),500)},tableAction:function(t){t.preventDefault(),a.state.id=t.currentTarget.dataset.id,"edit"===t.currentTarget.dataset.action&&a.editItem(t)},searchInventory:function(t){t.preventDefault(),a.getData()}}),e(this,"viewItem",(function(t){a.state.id=t.currentTarget.dataset.id,E(a)})),e(this,"editItem",(function(t){a.state.action="edit",C(a)})),e(this,"addItem",(function(t){a.state.action="add",C(a)})),e(this,"initPagination",(function(t){x(__,t.meta,a.getData)})),e(this,"initFooter",(function(){H(d("Created by %1$Kenzap%2$. ❤️ Licensed %3$GPL3%4$.",'<a class="text-muted" href="https://kenzap.com/" target="_blank">',"</a>",'<a class="text-muted" href="https://github.com/kenzap/ecommerce" target="_blank">',"</a>"))})),this.state={firstLoad:!0,settings:{},limit:50},this.getData()},k&&t(h.prototype,k),w&&t(h,w),Object.defineProperty(h,"prototype",{writable:!1}),h);new D}();
