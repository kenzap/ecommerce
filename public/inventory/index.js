!function(){"use strict";const t=(t,e,...n)=>{let a=(t,e)=>(e.forEach(((e,n)=>{t=t.replace("%"+(n+1)+"$",e)})),t);return void 0===window.i18n||void 0===window.i18n.state.locale.values[t]?a(t,n):a(e(window.i18n.state.locale.values[t]),n)},e=t=>0===(t=String(t)).length?"":t.replace(/[&<>'"]/g,(t=>({"&":"&amp;","<":"&lt;",">":"&gt;","'":"&apos;",'"':"&quot;"}[t]))),n=(e,...n)=>{if(0===(e=String(e)).length)return"";return t(e,(t=>t.replace(/[<>'"]/g,(t=>({"&":"&amp;","<":"&lt;",">":"&gt;","'":"&apos;",'"':"&quot;"}[t])))),...n)},a=t=>0===(t=String(t)).length?"":t.replace(/[&<>'"]/g,(t=>({"&":"&amp;","<":"&lt;",">":"&gt;","'":"&apos;",'"':"&quot;"}[t]))),o=(e,...n)=>{if(0===(e=String(e)).length)return"";return t(e,(t=>t.replace(/[&<>'"]/g,(t=>({"&":"&amp;","<":"&lt;",">":"&gt;","'":"&apos;",'"':"&quot;"}[t])))),...n)},i=t=>{let e=new URLSearchParams(window.location.search),n=e.get("sid")?e.get("sid"):"",a=-1==t.indexOf("?")?"?sid="+n:"&sid="+n;return t+a},c=()=>{let t=new URLSearchParams(window.location.search);return t.get("sid")?t.get("sid"):""},r=t=>{let e=t+"=",n=decodeURIComponent(document.cookie).split(";");for(let t=0;t<n.length;t++){let a=n[t];for(;" "==a.charAt(0);)a=a.substring(1);if(0==a.indexOf(e))return a.substring(e.length,a.length)}return""},s=()=>{let t=localStorage.hasOwnProperty("header")&&localStorage.hasOwnProperty("header-version")?localStorage.getItem("header-version"):0,e=window.location.hostname+"/"+c()+"/"+r("locale");return e!=r("check")&&(t=0,console.log("refresh")),((t,e,n)=>{let a="";if(n){let t=new Date;t.setTime(t.getTime()+24*n*60*60*1e3),a=";expires="+t.toUTCString()}document.cookie=t+"="+(escape(e)||"")+a+";path=/;domain=.kenzap.cloud"})("check",e,5),t},l=()=>({Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+r("kenzap_api_key"),"Kenzap-Locale":r("locale")?r("locale"):"en","Kenzap-Header":s(),"Kenzap-Token":r("kenzap_token"),"Kenzap-Sid":c()});r("kenzap_api_key"),r("locale")&&r("locale"),s(),r("kenzap_token"),c();const d=t=>{if(console.log(t),isNaN(t.code)){let e=t;try{e=JSON.stringify(e)}catch(t){}let n=new URLSearchParams;return n.append("cmd","report"),n.append("sid",c()),n.append("token",r("kenzap_token")),n.append("data",e),fetch("https://api-v1.kenzap.cloud/error/",{method:"post",headers:{Accept:"application/json","Content-type":"application/x-www-form-urlencoded"},body:n}),void alert("Can not connect to Kenzap Cloud")}if(401===t.code){if(-1!=window.location.href.indexOf("localhost"))return void alert(t.reason);location.href="https://auth.kenzap.com/?app=65432108792785&redirect="+window.location.href}else alert(t.reason)},u=(t,e)=>{if(document.querySelector(t))for(let n of document.querySelectorAll(t))n.removeEventListener("click",e,!0),n.addEventListener("click",e,!0)},p=t=>{if(!document.querySelector(".toast")){let t='\n        <div class="toast-cont position-fixed bottom-0 p-2 m-4 end-0 align-items-center" style="z-index:10000;">\n            <div class="toast hide align-items-center text-white bg-dark border-0" role="alert" aria-live="assertive" aria-atomic="true" data-bs-delay="3000">\n                <div class="d-flex">\n                    <div class="toast-body"></div>\n                    <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast" aria-label="Close"></button>\n                </div>\n            </div>\n        </div>';document.querySelector("body > div")&&document.querySelector("body > div").insertAdjacentHTML("afterend",t)}let e=new bootstrap.Toast(document.querySelector(".toast"));document.querySelector(".toast .toast-body").innerHTML=t,e.show()};function m(t){return function(t){if(Array.isArray(t))return f(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||v(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function v(t,e){if(t){if("string"==typeof t)return f(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?f(t,e):void 0}}function f(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,a=new Array(e);n<e;n++)a[n]=t[n];return a}var b=function(t){return(""+t).length<2?"0"+t:t},y=function(){var t=new URLSearchParams(window.location.search),e=t.get("page")?t.get("page"):1;return parseInt(e)},g=function(t,e,n){if(void 0!==e){var a=e.limit+e.offset;a>e.total_records&&(a=e.total_records),document.querySelector("#listing_info").innerHTML=t("Showing %1$ to %2$ of %3$ entries",1+e.offset,a,e.total_records);var o=Math.ceil(e.total_records/e.limit);document.querySelector("#listing_paginate").style.display=o<2?"none":"block";var i=y(),c='<ul class="pagination d-flex justify-content-end pagination-flat mb-0">';c+='<li class="paginate_button page-item previous" id="listing_previous"><a href="#" aria-controls="order-listing" data-type="prev" data-page="0" tabindex="0" class="page-link"><span aria-hidden="true">&laquo;</span></li>';for(var r=0;r<o;)(++r>=i-3&&r<=i||r<=i+3&&r>=i)&&(c+='<li class="paginate_button page-item '+(i==r?"active":"")+'"><a href="#" aria-controls="order-listing" data-type="page" data-page="'+r+'" tabindex="0" class="page-link">'+r+"</a></li>");c+='<li class="paginate_button page-item next" id="order-listing_next"><a href="#" aria-controls="order-listing" data-type="next" data-page="2" tabindex="0" class="page-link"><span aria-hidden="true">&raquo;</span></a></li>',c+="</ul>",document.querySelector("#listing_paginate").innerHTML=c;var s,l=function(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=v(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var a=0,o=function(){};return{s:o,n:function(){return a>=t.length?{done:!0}:{done:!1,value:t[a++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,c=!0,r=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return c=t.done,t},e:function(t){r=!0,i=t},f:function(){try{c||null==n.return||n.return()}finally{if(r)throw i}}}}(document.querySelectorAll(".page-link"));try{var d=function(){var t=s.value;t.addEventListener("click",(function(e){var a,i,c,r,s,l=parseInt(y()),d=l;switch(t.dataset.type){case"prev":(l-=1)<1&&(l=1);break;case"page":l=t.dataset.page;break;case"next":(l+=1)>o&&(l=o)}if(window.history.replaceState){var u=window.location.search;a="page",i=l,c=u,r=new RegExp("([?;&])"+a+"[^&;]*[;&]?"),u=((s=c.replace(r,"$1").replace(/&$/,"")).length>2?s+"&":"?")+(i?a+"="+i:""),window.history.replaceState("kenzap-cloud",document.title,window.location.pathname+u)}return d!=l&&n(),e.preventDefault(),!1}))};for(l.s();!(s=l.n()).done;)d()}catch(t){l.e(t)}finally{l.f()}}else document.querySelector("#listing_info").innerHTML=t("no records to display")},h=function(t,e){return e.stock_warning||(e.stock_warning=0),e.stock_warning=parseFloat(e.stock_warning),e.stock_amount=parseFloat(e.stock_amount),console.log(e.stock_warning+" "+e.stock_amount),e.stock_amount<=0?'<div class="badge bg-danger text-light fw-light">'+o("Out of stock")+"</div>":e.stock_warning>=e.stock_amount?'<div class="badge bg-warning text-dark fw-light">'+o("Low stock")+"</div>":'<div class="badge bg-success text-light fw-light">'+o("In stock")+"</div>"},_=function(t,e){switch(e=k(e),e=(Math.round(100*parseFloat(e))/100).toFixed(2),t.state.settings.currency_symb_loc){case"left":e=t.state.settings.currency_symb+" "+e;break;case"right":e+=t.state.settings.currency_symb}return e},k=function(t){return t=t||0,t=parseFloat(t),t=Math.round(100*t)/100},w=function(t,e){return new Date(1e3*parseInt(e)).toLocaleDateString()},S=function(t,e){document.querySelector(t)&&(e.push.apply(e,[9,37,38,39,40,98,100,102,104]),m(document.querySelectorAll(t)).forEach((function(t){t.addEventListener("keydown",(function(t){var n=t.key.toLowerCase();"control"!=n&&"meta"!=n||(window[n]=!0),console.log(n.length+" / "+a+" / "+t.which);var a=n>="0"&&n<="9";return(window.control||window.meta)&&[86,88,65,67,90].includes(t.which)?(console.log("pushing"),!0):a||e.includes(t.which)?void 0:(t.preventDefault(),!1)})),t.addEventListener("keyup",(function(t){var e=t.key.toLowerCase();"control"!=e&&"meta"!=e||(window[e]=!1)}))})))},x=function(t){if(!t)throw new Error("DOM Element is undifined! Please choose HTML target element.");var e,n,a,i,c,r,s=t;function l(){e.innerHTML="",i.forEach((function(t,n){if(t){var a=document.createElement("li");a.innerHTML="".concat(t," <a>&times;</a>"),a.querySelector("a").addEventListener("click",(function(){var t;t=n,i=i.filter((function(e,n){return n!==t&&e})),l()})),e.appendChild(a)}})),s.setAttribute("data-simple-tags",i.toString())}a=(a=s.getAttribute("data-simple-tags")).split(","),i=a.map((function(t){return t.trim()})),c=document.createElement("ul"),(r=document.createElement("input")).setAttribute("placeholder",o("new tag")),s.appendChild(c),s.appendChild(r),e=s.firstElementChild,n=s.lastElementChild,l(),n.addEventListener("keyup",(function(t){var e=this.value.trim();(e.includes(",")||13===t.keyCode)&&(""!==e.replace(",","")&&i.push(e.replace(",","")),this.value=""),l()}))},q=function(t){var e=o("E-commerce 2.0 by %1$Kenzap%2$. ❤️ Licensed %3$GPL3%4$.",'<a class="text-muted" href="https://kenzap.com/" target="_blank">',"</a>",'<a class="text-muted" href="https://github.com/kenzap/ecommerce" target="_blank">',"</a>");document.querySelector("footer .row").innerHTML='\n    <div class="d-sm-flex justify-content-center justify-content-sm-between">\n        <span class="text-muted text-center text-sm-left d-block d-sm-inline-block">'.concat(e,'</span>\n        <span class="float-none float-sm-right d-block mt-1 mt-sm-0 text-center text-muted">').concat("","</span>\n    </div>")},L=function(t){var e={img:[],price:0,price_per_unit:0,price_per_unit_prev:0,status:"1",tags:[],stock_amount:0,stock_unit:"kg",stock_warning:"",title:"",write_off:{type:"never",dof:[],time:"0",amount:0},updated:0};"edit"==t.state.action&&t.state.id&&(e=t.state.response.inventory.filter((function(e){return e._id==t.state.id}))[0]);var n=document.querySelector(".modal"),i=new bootstrap.Modal(n);n.querySelector(".modal-dialog").classList.add("modal-fullscreen"),n.querySelector(".modal-title").innerHTML="edit"==t.state.action?o("Edit Item"):o("Add Item"),n.querySelector(".modal-footer").innerHTML='\n        <button type="button" class="btn btn-primary btn-modal btn-add-item">'.concat("edit"==t.state.action?o("Update"):o("Add"),'</button>\n        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">').concat(o("Cancel"),'</button>\n        <button class="btn btn-danger btn-remove-item btn-lg- ').concat("edit"==t.state.action?"":"d-none",'" type="button" title="').concat(o("Remove application."),'"><span><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-trash" viewBox="0 0 16 16"><path d="M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0V6z"/><path fill-rule="evenodd" d="M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1v1zM4.118 4 4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4H4.118zM2.5 3V2h11v1h-11z"/></svg></span></button>\n    ');var c='\n\n    <h4 class="card-title mb-lg-4 mt-sm-3 mt-3">'.concat(o("Item"),'</h4>\n    <div class="row">\n        <div class="col-lg-6">\n            <div class="form-group row mb-lg-3 mt-1">\n            <label class="col-sm-3 col-form-label">').concat(o("Title"),'</label>\n            <div class="col-sm-9">\n                <input id="title" type="text" class="form-control inp" name="title" data-type="emails" value="').concat(e.title,'"  autocomplete="off">\n                <p class="form-text">').concat(o("Item description."),'</p>\n            </div>\n            </div>\n        </div>\n        <div class="col-lg-6">\n            <div class="form-group row mb-lg-3 mt-1">\n            <label class="col-sm-3 col-form-label">').concat(o("Price per 1 "),'<span id="price_stock_unit">').concat(e.stock_unit,'</span></label>\n            <div class="col-sm-9">\n                <div class="input-group">\n                    <input id="price_per_unit" type="text" class="form-control inp" name="price_per_unit" aria-label="Current stock amount" aria-describedby="basic-addon1" value="').concat(e.price_per_unit,'" autocomplete="off">\n                    <span class="input-group-text" id="price_curr">').concat(a(t.state.settings.currency_symb?t.state.settings.currency_symb:""),'</span>\n                </div>\n                <p class="form-text">').concat(o("Price per one stock measurement unit."),'</p>\n            </div>\n            </div>\n        </div>\n    </div>\n\n    <h4 class="card-title mb-lg-4 mt-sm-0 mt-3">').concat(o("Stock"),'</h4>\n    <div class="row">\n        <div class="col-lg-6">\n            <div class="form-group row mb-lg-3 mt-1">\n            <label class="col-sm-3 col-form-label">').concat(o("Stock unit"),'</label>\n            <div class="col-sm-9">\n                <select id="stock_unit" class="form-select inp" name="stock_unit" data-type="select">\n                    <option value="g" ').concat("g"==e.stock_unit?"selected":"",">").concat(o("g"),'</option>\n                    <option value="kg" ').concat("kg"==e.stock_unit?"selected":"",">").concat(o("kg"),'</option>\n                    <option value="set" ').concat("set"==e.stock_unit?"selected":"",">").concat(o("set"),'</option>\n                    <option value="pc" ').concat("pc"==e.stock_unit?"selected":"",">").concat(o("piece"),'</option>\n                    <option value="l" ').concat("l"==e.stock_unit?"selected":"",">").concat(o("liter"),'</option>\n                </select>\n                <p class="form-text">').concat(o("Stock measurement unit for inventory deductions."),'</p>\n            </div>\n            </div>\n        </div>\n        <div class="col-lg-6">\n            <div class="form-group row mb-lg-3 mt-1">\n            <label class="col-sm-3 col-form-label">').concat(o("Current stock"),'</label>\n            <div class="col-sm-9">\n                <div class="input-group">\n                    <input id="stock_amount" type="text" class="form-control inp" name="stock_amount" aria-label="Current stock amount" aria-describedby="basic-addon1" value="').concat(e.stock_amount,'" autocomplete="off">\n                    <span class="input-group-text" id="stock_amount_unit">').concat(e.stock_unit,'</span>\n                </div>\n                <p class="form-text">').concat(o("Current stock amount."),'</p>\n            </div>\n            </div>\n        </div>\n        <div class="col-lg-6">\n            <div class="form-group row mb-lg-3 mt-1">\n            <label class="col-sm-3 col-form-label">').concat(o("Low stock"),'</label>\n            <div class="col-sm-9">\n                <div class="input-group">\n                    <input id="stock_warning" type="text" class="form-control inp" name="stock_warning" aria-label="Low stock warning" aria-describedby="basic-addon2" value="').concat(e.stock_warning,'" autocomplete="off">\n                    <span class="input-group-text" id="stock_warning_unit">').concat(e.stock_unit,'</span>\n                </div>\n                <p class="form-text">').concat(o("Trigger alert when stock drops below this value."),'</p>\n            </div>\n            </div>\n        </div>\n    </div>\n\n    <h4 class="card-title mb-lg-4 mt-sm-0 mt-3">').concat(o("Write-off"),'</h4>\n    <div class="row">\n        <div class="col-lg-6">\n            <div class="form-group row mb-lg-3 mt-1">\n            <label class="col-sm-3 col-form-label">').concat(o("Auto deduction"),'</label>\n            <div class="col-sm-9">\n                <div class="input-group">\n                    <select id="write_off" class="form-select inp" name="write_off" data-type="select">\n                        <option value="never" ').concat("never"==e.write_off.type?"selected":"",">").concat(o("Never"),'</option>\n                        <option value="daily" ').concat("daily"==e.write_off.type?"selected":"",">").concat(o("Daily"),'</option>\n                        <option value="ai" ').concat("ai"==e.write_off.type?"selected":"",">").concat(o("AI-driven"),'</option>\n                    </select>\n                </div>\n                <p class="form-text">').concat(o("Trigger alert when stock drops below this value."),'</p>\n            </div>\n            </div>\n            <div class="form-group row mb-lg-3 mt-1 write_off_cont ').concat("never"==e.write_off.type?"d-none":"",'">\n                <label class="col-sm-3 col-form-label">').concat(o("Days of week"),'</label>\n                <div class="col-sm-9">\n                    <div class="form-check">\n                        <label for="week-monday" class="form-check-label form-label">\n                            <input id="week-monday" type="checkbox" class="form-check-input " ').concat("",' value="1">\n                            ').concat(o("Monday"),'\n                        </label>\n                    </div>\n                    <div class="form-check">\n                        <label for="week-tuesday" class="form-check-label form-label">\n                            <input id="week-tuesday" type="checkbox" class="form-check-input" ').concat("",' value="1">\n                            ').concat(o("Tuesday"),'\n                        </label>\n                    </div>\n                    <div class="form-check">\n                        <label id="week-wednesday" class="form-check-label form-label">\n                            <input id="week-wednesday" type="checkbox" class="form-check-input" ').concat("",' value="1">\n                            ').concat(o("Wednesday"),'\n                        </label>\n                    </div>\n                    <div class="form-check">\n                        <label id="week-thursday" class="form-check-label form-label">\n                            <input id="week-thursday" type="checkbox" class="form-check-input" ').concat("",' value="1">\n                            ').concat(o("Thursday"),'\n                        </label>\n                    </div>\n                    <div class="form-check">\n                        <label id="week-friday" class="form-check-label form-label">\n                            <input id="week-friday" type="checkbox" class="form-check-input" ').concat("",' value="1">\n                            ').concat(o("Friday"),'\n                        </label>\n                    </div>\n                    <div class="form-check">\n                        <label id="week-saturday" class="form-check-label form-label">\n                            <input id="week-saturday" type="checkbox" class="form-check-input" ').concat("",' value="1">\n                            ').concat(o("Saturday"),'\n                        </label>\n                    </div>\n                    <div class="form-check">\n                        <label id="week-sunday" class="form-check-label form-label">\n                            <input id="week-sunday" type="checkbox" class="form-check-input" ').concat("",' value="1">\n                            ').concat(o("Sunday"),'\n                        </label>\n                    </div>\n                    <p class="form-text">').concat(o("Days of the week when discount is available."),'</p>\n                </div>\n            </div>\n        </div>\n        <div class="col-lg-6 write_off_cont ').concat("never"==e.write_off.type?"d-none":"",'">\n            <div class="form-group row mb-lg-3 mt-1">\n                <label class="col-sm-3 col-form-label">').concat(o("Amount"),'</label>\n                <div class="col-sm-9">\n                    <div class="input-group">\n                        <input id="write_off_amount" type="text" class="form-control inp" name="write_off_amount" aria-label="write off stock amount" aria-describedby="basic-addon1" value="').concat(e.write_off.amount?e.write_off.amount:0,'" autocomplete="off">\n                        <span class="input-group-text" id="write_off_amount_unit">').concat(e.stock_unit,'</span>\n                    </div>\n                    <p class="form-text">').concat(o("Amount to deduct from current stock amount."),'</p>\n                </div>\n            </div>\n            <div class="form-group row mb-lg-3 mt-1">\n                <label class="col-sm-3 col-form-label">').concat(o("When"),'</label>\n                <div class="col-sm-9">\n                    <select id="write_off_time" class="form-select inp" name="write_off_time" data-type="select">\n                        <option value="2" ').concat("2"==e.write_off.time?"selected":"",">").concat(o("2:00 AM"),'</option>\n                        <option value="4" ').concat("4"==e.write_off.time?"selected":"",">").concat(o("4:00 AM"),'</option>\n                        <option value="6" ').concat("6"==e.write_off.time?"selected":"",">").concat(o("6:00 AM"),'</option>\n                        <option value="8" ').concat("8"==e.write_off.time?"selected":"",">").concat(o("8:00 AM"),'</option>\n                        <option value="10" ').concat("10"==e.write_off.time?"selected":"",">").concat(o("10:00 AM"),'</option>\n                        <option value="12" ').concat("12"==e.write_off.time?"selected":"",">").concat(o("12:00 PM"),'</option>\n                        <option value="14" ').concat("14"==e.write_off.time?"selected":"",">").concat(o("14:00 PM"),'</option>\n                        <option value="16" ').concat("16"==e.write_off.time?"selected":"",">").concat(o("16:00 PM"),'</option>\n                        <option value="18" ').concat("18"==e.write_off.time?"selected":"",">").concat(o("18:00 PM"),'</option>\n                        <option value="20" ').concat("20"==e.write_off.time?"selected":"",">").concat(o("20:00 PM"),'</option>\n                        <option value="22" ').concat("22"==e.write_off.time?"selected":"",">").concat(o("22:00 PM"),'</option>\n                    </select>\n                    <p class="form-text">').concat(o("Local time when deduction is called."),'</p>\n                </div>\n            </div>\n        </div>\n    </div>\n\n    <h4 class="card-title mb-lg-4 mt-sm-0 mt-3">').concat(o("Tagging"),'</h4>\n    <div class="row">\n        <div class="col-lg-6">\n            <div class="form-group row mb-lg-3 mt-1">\n            <label class="col-sm-3 col-form-label">').concat(o("Tags"),'</label>\n            <div class="col-sm-9">\n                <div class="form-group">\n                    <div id="tags" class="simple-tags" data-simple-tags=""></div>\n                </div>\n                <p class="form-text">').concat(o("Use tagging for inventory grouping."),"</p>\n            </div>\n            </div>\n        </div>\n    </div>\n    ");n.querySelector(".modal-body").innerHTML=c,n.querySelector(".modal-body").innerHTML;var r=n.querySelector("#tags");e.tags&&r.setAttribute("data-simple-tags",e.tags),new x(r),S("#price",[8,46,190]),S("#stock_amount",[8,46,190,189,229]),S("#stock_warning",[8,46,190]),n.querySelector("#stock_unit").addEventListener("change",(function(t){t.preventDefault(),n.querySelector("#stock_warning_unit").innerHTML=t.currentTarget.value,n.querySelector("#stock_amount_unit").innerHTML=t.currentTarget.value,n.querySelector("#write_off_amount_unit").innerHTML=t.currentTarget.value,n.querySelector("#price_stock_unit").innerHTML=t.currentTarget.value})),n.querySelector("#write_off").addEventListener("change",(function(t){if(t.preventDefault(),m(n.querySelectorAll(".write_off_cont")).forEach((function(t){t.classList.add("d-none")})),"never"===t.currentTarget.value);else m(n.querySelectorAll(".write_off_cont")).forEach((function(t){t.classList.remove("d-none")}))})),n.querySelector(".btn-add-item").addEventListener("click",(function(e){if(e.preventDefault(),n.querySelector(".btn-add-item").dataset.loading)return!1;var a={write_off:{}};if(a.title=n.querySelector("#title").value.trim(),a.price_per_unit=parseFloat(n.querySelector("#price_per_unit").value.trim()),a.stock_unit=n.querySelector("#stock_unit").value.trim(),a.stock_amount=parseFloat(n.querySelector("#stock_amount").value.trim()),a.stock_warning=parseFloat(n.querySelector("#stock_warning").value.trim()),a.write_off.type=n.querySelector("#write_off").value.trim(),a.write_off.time=n.querySelector("#write_off_time").value.trim(),a.write_off.amount=parseFloat(n.querySelector("#write_off_amount").value.trim()),a.tags=[],m(n.querySelectorAll("#tags ul li")).forEach((function(t){a.tags.push(t.innerHTML.replace("<a>×</a>","").trim())})),a.status="1",a.img=[],a.cats=[],a.title.length<2)alert(o("Please provide longer title"));else{0==a.price_per_unit.length&&(a.price_per_unit="0"),0==a.stock_amount&&(a.stock_amount="0"),a.stock_warning.length<2&&(a.stock_warning=0),a.price_per_unit_prev=a.price_per_unit;var c={update:{type:"create",key:"ecommerce-inventory",data:a}};"edit"==t.state.action&&t.state.id&&(c.update.type="update",c.update.id=t.state.id);var r=n.querySelector(".btn-add-item").innerHTML;n.querySelector(".btn-add-item").dataset.loading=!0,n.querySelector(".btn-add-item").innerHTML='<span class="spinner-border spinner-border-sm me-2" role="status" aria-hidden="true"></span>'+o("Loading.."),fetch("https://api-v1.kenzap.cloud/",{method:"post",headers:l(),body:JSON.stringify({query:c})}).then((function(t){return t.json()})).then((function(e){n.querySelector(".btn-add-item").dataset.loading="",n.querySelector(".btn-add-item").innerHTML=r,e.success?(i.hide(),t.getData(),p("edit"==t.state.action?o("Item updated"):o("Item created"))):d(e)})).catch((function(t){d(t)}))}})),n.querySelector(".btn-remove-item").addEventListener("click",(function(e){if(e.preventDefault(),n.querySelector(".btn-add-item").dataset.loading)return!1;if(confirm("Completely remove from inventory?")){var a=n.querySelector(".btn-remove-item").innerHTML;n.querySelector(".btn-add-item").dataset.loading=!0,n.querySelector(".btn-remove-item").innerHTML='<span class="spinner-border spinner-border-sm me-2" role="status" aria-hidden="true"></span>'+o("Loading.."),fetch("https://api-v1.kenzap.cloud/",{method:"post",headers:l(),body:JSON.stringify({query:{product:{type:"delete",key:"ecommerce-inventory",id:t.state.id}}})}).then((function(t){return t.json()})).then((function(e){n.querySelector(".btn-add-item").dataset.loading="",n.querySelector(".btn-add-item").innerHTML=a,e.success?(i.hide(),t.getData(),p(o("Item removed"))):d(e)})).catch((function(t){d(t)}))}})),i.show(),"edit"!=t.state.action&&setTimeout((function(){return n.querySelector("#title").focus()}),100)},M=function(t){var n={img:[],price:0,price_per_unit:0,price_per_unit_prev:0,status:"1",tags:[],stock_amount:0,stock_unit:"kg",stock_warning:"",title:"",updated:0};(n=t.state.response.inventory.filter((function(e){return e._id==t.state.id}))[0]).stock_amount=parseFloat(n.stock_amount),n.price||(n.price=0);var i=document.querySelector(".modal"),c=new bootstrap.Modal(i);i.querySelector(".modal-dialog").classList.add("modal-fullscreen"),i.querySelector(".modal-title").innerHTML='<div class="d-flex align-items-center">'+a(n.title)+'<div class="fs-6 ms-2">'+h(0,n)+"</div></div>",i.querySelector(".modal-footer").innerHTML='\n        <button type="button" class="btn btn-danger btn-modal btn-deduct btn-stock-update d-none">'.concat(o("Deduct"),'</button>\n        <button type="button" class="btn btn-success btn-modal btn-top-up btn-stock-update d-none">').concat(o("Top up"),'</button>\n        <button type="button" class="btn btn-primary btn-modal btn-settings">').concat(o("Settings"),'</button>\n        <button class="btn btn-outline-secondary remove-application btn-lg d-none" type="button" title="').concat(o("Remove application."),'"><span><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-trash" viewBox="0 0 16 16"><path d="M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0V6z"/><path fill-rule="evenodd" d="M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1v1zM4.118 4 4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4H4.118zM2.5 3V2h11v1h-11z"/></svg></span></button>\n        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">').concat(o("Close"),"</button>\n    ");var r='\n\n    <h4 class="card-title mb-lg-4 mt-sm-3 mt-3 mb-0">'.concat(o("Live stock"),'</h4>\n    <div class="form-text d-flex">\n        <div class="d-flex align-items-center">\n            <div>').concat(parseFloat(n.stock_amount).toFixed(2)," ").concat(n.stock_unit,'</div>\n            <div id="stock_arrow" class="triangle_down mx-2"></div>\n        </div>\n        <div class="d-flex align-items-center ms-2">\n            <div>').concat(_(t,parseFloat(n.price_per_unit)),'</div>\n            <div id="price_arrow" class="').concat(parseFloat(n.price_per_unit_prev)-parseFloat(n.price_per_unit)>=0?"triangle_down triangle_green":"triangle_up triangle_red",' mx-2"></div>\n        </div>\n        <div class="d-flex align-items-center ms-2">\n            <div>').concat(o("5 days"),'</div>\n            <div class="mx-2 d-flex">\n                <svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" fill="currentColor" class="bi bi-clock-history" viewBox="0 0 16 16">\n                    <path d="M8.515 1.019A7 7 0 0 0 8 1V0a8 8 0 0 1 .589.022l-.074.997zm2.004.45a7.003 7.003 0 0 0-.985-.299l.219-.976c.383.086.76.2 1.126.342l-.36.933zm1.37.71a7.01 7.01 0 0 0-.439-.27l.493-.87a8.025 8.025 0 0 1 .979.654l-.615.789a6.996 6.996 0 0 0-.418-.302zm1.834 1.79a6.99 6.99 0 0 0-.653-.796l.724-.69c.27.285.52.59.747.91l-.818.576zm.744 1.352a7.08 7.08 0 0 0-.214-.468l.893-.45a7.976 7.976 0 0 1 .45 1.088l-.95.313a7.023 7.023 0 0 0-.179-.483zm.53 2.507a6.991 6.991 0 0 0-.1-1.025l.985-.17c.067.386.106.778.116 1.17l-1 .025zm-.131 1.538c.033-.17.06-.339.081-.51l.993.123a7.957 7.957 0 0 1-.23 1.155l-.964-.267c.046-.165.086-.332.12-.501zm-.952 2.379c.184-.29.346-.594.486-.908l.914.405c-.16.36-.345.706-.555 1.038l-.845-.535zm-.964 1.205c.122-.122.239-.248.35-.378l.758.653a8.073 8.073 0 0 1-.401.432l-.707-.707z"/>\n                    <path d="M8 1a7 7 0 1 0 4.95 11.95l.707.707A8.001 8.001 0 1 1 8 0v1z"/>\n                    <path d="M7.5 3a.5.5 0 0 1 .5.5v5.21l3.248 1.856a.5.5 0 0 1-.496.868l-3.5-2A.5.5 0 0 1 7 9V3.5a.5.5 0 0 1 .5-.5z"/>\n                </svg>\n            </div>\n        </div>\n    </div>\n\n    <div class="row">\n        <div class="col-lg-12">\n            <div class="form-group row mb-lg-3 mt-1">\n            <div id="live_stock" style="width: 100%; height: 320px;"></div>\n        </div>\n    </div>\n\n    <h4 class="card-title mb-lg-4 mt-sm-0 mt-3">').concat(o("History"),'</h4>\n\n    <div class="row mb-4">\n        <div class="col-sm-12">\n            <div class="table-responsive-">\n                <table class="table table-hover table-borderless align-middle table-striped table-history-list mb-0" style="">\n                    <thead>\n                        <tr>\n                            <th>\n                                ').concat(o("Details"),"\n                            </th>\n                            <th>\n                                ").concat(o("Amount"),'\n                            </th>\n                            <th>\n                              \n                            </th>\n                        </tr>\n                    </thead>\n                    <tbody id="inventory-history">\n                        <tr>\n                            <td colspan="3">\n                                ').concat(o("Loading"),'\n                            </td>\n                        </tr>\n                    </tbody>\n                </table>\n            </div>\n        </div>\n    </div>\n    \n    <div class="row mb-4">\n        <div class="col-lg-5">\n            <div class="form-group row mb-lg-3 mt-1">\n            <label class="col-sm-3 col-form-label">').concat(o("Details"),'</label>\n            <div class="col-sm-9">  \n                <input id="details" type="text" class="form-control inp mb-sm-2" name="details" aria-label="details" aria-describedby="basic-addon-details" value="" autocomplete="off">\n                <p class="form-text d-none">').concat(o("Use tagging for inventory grouping."),'</p>\n            </div>\n            </div>\n        </div>\n        <div class="col-lg-5">\n            <div class="form-group row mb-lg-3 mt-1">\n            <label class="col-sm-3 col-form-label">').concat(o("Amount"),'</label>\n            <div class="col-sm-9">\n                <div class="input-group mb-sm-2">           \n                    <input id="stock_amount" type="text" class="form-control inp" name="stock_amount" aria-label="Current stock amount" aria-describedby="basic-addon1" value="" autocomplete="off">\n                    <span class="input-group-text" id="stock_amount_unit">').concat(n.stock_unit,'</span>\n                </div>\n                <p class="form-text d-none">').concat(o("Use tagging for inventory grouping."),'</p>\n            </div>\n            </div>\n        </div>\n        <div class="col-lg-5">\n            <div class="form-group row mb-lg-3 mt-1">\n            <label class="col-sm-3 col-form-label">').concat(o("Total price"),'</label>\n            <div class="col-sm-9">\n                <div class="input-group mb-sm-2">           \n                    <input id="stock_price" type="text" class="form-control inp" name="stock_price" aria-label="Price" aria-describedby="basic-addon2" value="0" autocomplete="off">\n                    <span class="input-group-text" id="price_cur">').concat(a(t.state.settings.currency_symb?t.state.settings.currency_symb:""),'</span>\n                </div>\n                <p class="form-text d-none">').concat(o("Use tagging for inventory grouping."),"</p>\n            </div>\n            </div>\n        </div>\n    </div>\n\n    ");i.querySelector(".modal-body").innerHTML=r;google.charts.load("current",{packages:["corechart"]}),google.charts.setOnLoadCallback((function(){var t=google.visualization.arrayToDataTable([[o("Day"),o("Stock amount ("+n.stock_unit+")")],[o("-7 days"),n.stock_amount+9],[o("-6 days"),n.stock_amount+8.1],[o("-5 days"),n.stock_amount+7.5],[o("-4 days"),n.stock_amount+6],[o("-3 days"),n.stock_amount+3.5],[o("-2 days"),n.stock_amount+1.5],[o("Yesterday"),n.stock_amount+.3],[o("Today"),n.stock_amount]]),e={vAxis:{title:o("Stock amount ("+n.stock_unit+")")},isStacked:!0,legend:{position:"left"}};new google.visualization.SteppedAreaChart(i.querySelector("#live_stock")).draw(t,e)})),S("#stock_price",[8,46,190,189,229]),S("#stock_amount",[8,46,190,189,229]),i.querySelector(".btn-settings").addEventListener("click",(function(e){t.state.action="edit",c.hide(),L(t)}));var s=function(t){var e=parseFloat(t.currentTarget.value);return 0==t.currentTarget.value.length?(i.querySelector(".btn-top-up").classList.add("d-none"),void i.querySelector(".btn-deduct").classList.add("d-none")):e<0?(i.querySelector(".btn-top-up").classList.add("d-none"),i.querySelector(".btn-deduct").classList.remove("d-none"),i.querySelector("#stock_price").setAttribute("disabled",!0),void(i.querySelector("#stock_price").value="")):e>0?(i.querySelector(".btn-top-up").classList.remove("d-none"),i.querySelector(".btn-deduct").classList.add("d-none"),void i.querySelector("#stock_price").removeAttribute("disabled")):void 0};i.querySelector("#stock_amount").addEventListener("keyup",(function(t){s(t)})),i.querySelector("#stock_amount").addEventListener("click",(function(t){s(t)})),m(i.querySelectorAll(".btn-stock-update")).forEach((function(e){e.addEventListener("click",(function(e){if(e.preventDefault(),i.querySelector(".btn-stock-update").dataset.loading)return!1;var a=new Date,c={};if(c.iid=t.state.id,c.details=i.querySelector("#details").value.trim(),c.price=i.querySelector("#stock_price").value.trim(),c.stock_unit=i.querySelector("#stock_amount_unit").innerHTML.trim(),c.amount=parseFloat(i.querySelector("#stock_amount").value.trim()),c.ym=a.getFullYear()+""+b(a.getMonth()+1),c.ymd=a.getFullYear()+""+b(a.getMonth()+1)+b(a.getDay()),c.time=Math.round(a.getTime()/1e3),c.details.length<2)alert(o("Please provide longer description"));else if(0!=c.amount.length)if(c.amount>0&&0==c.price.length)alert(o("Please enter price"));else{c.price.length>0&&(c.price=parseFloat(c.price));var r={update:{type:"create",key:"ecommerce-inventory-history",data:c}};t.state.btnHTML=i.querySelector(".btn-stock-update").innerHTML,i.querySelector(".btn-stock-update").dataset.loading=!0,i.querySelector(".btn-stock-update").innerHTML='<span class="spinner-border spinner-border-sm me-2" role="status" aria-hidden="true"></span>'+o("Loading.."),fetch("https://api-v1.kenzap.cloud/",{method:"post",headers:l(),body:JSON.stringify({query:r})}).then((function(t){return t.json()})).then((function(e){e.success?u(t,n,c):d(e)})).catch((function(t){d(t)}))}else alert(o("Please enter amount"))}))}));var u=function(t,e,n){e.price||(e.price=0);var a=null;console.log(e),console.log(n),a=n.amount>0?{stock_amount:parseFloat(e.stock_amount)+parseFloat(n.amount),price_per_unit:Math.round(parseFloat(n.price)/parseFloat(n.amount)*100)/100,price_per_unit_prev:Math.round(parseFloat(e.price)/parseFloat(e.stock_amount)*100)/100,price:Math.round(100*parseFloat(n.price))/100,price_prev:e.price}:{stock_amount:parseFloat(e.stock_amount)+parseFloat(n.amount)};var r={update:{type:"update",id:t.state.id,key:"ecommerce-inventory",data:a}};fetch("https://api-v1.kenzap.cloud/",{method:"post",headers:l(),body:JSON.stringify({query:r})}).then((function(t){return t.json()})).then((function(e){e.success?(i.querySelector(".btn-stock-update").dataset.loading="",i.querySelector(".btn-stock-update").innerHTML=t.state.btnHTML,c.hide(),t.getData(),p(o("Stock updated"))):d(e)})).catch((function(t){d(t)}))},v=function(t,e){console.log(e);var n=t.state.history.filter((function(t){return t._id==e}))[0];document.querySelector("#details").value=n.details,document.querySelector("#stock_amount").value=n.amount,document.querySelector("#stock_price").value=n.price,(t=>{let e=new MouseEvent("click",{bubbles:!0,cancelable:!0,view:window});t.dispatchEvent(e)})(document.querySelector("#stock_amount")),document.querySelector("#stock_amount").focus(),p(o("Row copied"))},f=function(t,e){fetch("https://api-v1.kenzap.cloud/",{method:"post",headers:l(),body:JSON.stringify({query:{history:{type:"delete",key:"ecommerce-inventory-history",id:e}}})}).then((function(t){return t.json()})).then((function(e){e.success?(g(t),p(o("Record removed"))):d(e)})).catch((function(t){d(t)}))},g=function(t){t.state.limit=10;fetch("https://api-v1.kenzap.cloud/",{method:"post",headers:l(),body:JSON.stringify({query:{history:{type:"find",key:"ecommerce-inventory-history",fields:["_id","details","price","price_per_unit","stock_unit","amount","time","updated"],limit:t.state.limit,term:[{field:"iid",relation:"=",type:"string",value:t.state.id}],offset:"".length>0?0:y()*t.state.limit-t.state.limit,search:{field:"details",s:""},sortby:{field:"created",order:"DESC"}}}})}).then((function(t){return t.json()})).then((function(n){if(n.success){if(t.state.history=n.history,0==n.history.length)return void(document.querySelector("#inventory-history").innerHTML='<tr><td colspan="2" class="form-text">'.concat(o("No data to display."),"</td></tr>"));document.querySelector("#inventory-history").innerHTML=n.history.map((function(n,a){return'\n                        <tr>\n                            <td data-id="'.concat(e(n._id),'">\n                                ').concat(n.details,'\n                                <div class="form-text">').concat(w(0,n.time)," / ").concat(_(t,n.price),'</div>\n                            </td>\n                            <td data-id="').concat(e(n._id),'">\n                                <div class="fw-bold ').concat(n.amount<0?"text-danger":"text-success",'">').concat((n.amount<0?"":"+")+n.amount+n.stock_unit,'</div>\n                            </td>\n                            <td class="text-end d-none-">\n                                <div class="dropdown inventoryHistoryActionsCont">\n                                    <svg id="inventoryHistoryActions').concat(a,'" data-bs-toggle="dropdown" data-boundary="viewport" aria-expanded="false" xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" class="bi bi-three-dots-vertical dropdown-toggle po" viewBox="0 0 16 16">\n                                        <path d="M9.5 13a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0zm0-5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0zm0-5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0z"/>\n                                    </svg>\n                                    <ul class="dropdown-menu" aria-labelledby="inventoryHistoryActions').concat(a,'">\n                                        <li><a class="dropdown-item po" href="#" data-action="copy" data-id="').concat(e(n._id),'" data-index="').concat(a,'">').concat(o("Copy"),'</a></li>\n                                        <li><hr class="dropdown-divider"></li>\n                                        <li><a class="dropdown-item po" href="#" data-action="remove" data-id="').concat(e(n._id),'" data-index="').concat(a,'">').concat(o("Remove"),"</a></li>\n                                    </ul>\n                                </div>\n                            </td>\n                        </tr>")})).join(""),m(document.querySelectorAll(".inventoryHistoryActionsCont .dropdown-item")).forEach((function(e){e.addEventListener("click",(function(e){switch(e.currentTarget.dataset.action){case"copy":v(t,e.currentTarget.dataset.id);break;case"remove":if(!confirm(o("Remove this record?")))return;f(t,e.currentTarget.dataset.id)}}))}))}else d(n)})).catch((function(t){d(t)}))};g(t),c.show()},T={state:{firstLoad:!0,settings:{},limit:10},init:function(){T.getData()},getData:function(){T.state.firstLoad&&(()=>{let t=document.querySelector(".loader");t&&(t.style.display="block")})();var t=document.querySelector(".search-cont input")?document.querySelector(".search-cont input").value:"";fetch("https://api-v1.kenzap.cloud/",{method:"post",headers:l(),body:JSON.stringify({query:{user:{type:"authenticate",fields:["avatar"],token:r("kenzap_token")},locale:{type:"locale",source:["extension"],key:"ecommerce"},settings:{type:"get",key:"ecommerce-settings",fields:["currency","currency_symb","currency_symb_loc","tax_calc","tax_auto_rate","tax_rate","tax_display","fee_calc","fee_percent","fee_display"]},inventory:{type:"find",key:"ecommerce-inventory",fields:["_id","id","img","status","tags","price","price_prev","price_per_unit","price_per_unit_prev","write_off","title","stock_amount","stock_unit","stock_warning","updated"],limit:T.state.limit,offset:t.length>0?0:y()*T.state.limit-T.state.limit,search:{field:"title",s:t},sortby:{field:"created",order:"DESC"}}}})}).then((function(t){return t.json()})).then((function(t){(()=>{let t=document.querySelector(".loader");t&&(t.style.display="none")})(),t.success?(T.state.settings=t.settings,T.state.response=t,(t=>{if(t.header&&localStorage.setItem("header",t.header),!document.querySelector("#k-script")){let t=document.createElement("div");t.innerHTML=localStorage.getItem("header"),t=t.firstChild,document.body.prepend(t),Function(document.querySelector("#k-script").innerHTML).call("test")}t.locale&&window.i18n.init(t.locale)})(t),T.loadPageStructure(),T.renderPage(t),T.initListeners(),T.initPagination(t),q(),T.state.firstLoad=!1):d(t)})).catch((function(t){d(t)}))},authUser:function(t){t.user&&t.user.success},loadPageStructure:function(){T.state.firstLoad&&(document.querySelector("#contents").innerHTML=function(t){return'\n    <div class="container">\n\n        <div class="d-md-flex justify-content-between bd-highlight mb-3">\n            <nav class="bc" aria-label="breadcrumb"></nav>\n            <button class="btn btn-primary btn-add mt-3 mb-1 mt-md-0 mb-md-0" type="button">'.concat(t("Add item"),'</button>\n        </div>\n\n        <div class="row">\n            <div class="col-md-12 grid-margin grid-margin-lg-0 grid-margin-md-0 stretch-card">\n                <div class="card border-white shadow-sm border-0">\n                    <div class="card-body p-0">\n                        <div class="no-footer">\n                            <div class="row">\n                                <div class="col-sm-12">\n                                    <div class="table-responsive">\n                                        <table class="table table-hover table-borderless align-middle table-striped table-p-list mb-0" >\n                                            <thead>\n\n                                            </thead>\n                                            <tbody>\n\n                                            </tbody>\n                                        </table>\n                                    </div>\n                                </div>\n                            </div>\n\n                            <div class="row my-2">\n                                <div class="col-sm-12 col-md-5 d-flex align-items-center">\n                                    <div class="dataTables_info mx-2 text-secondary fw-lighter " id="listing_info" role="status" aria-live="polite">&nbsp;</div>\n                                </div>\n                                <div class="col-sm-12 col-md-7">\n                                    <div class="dataTables_paginate paging_simple_numbers m-2" id="listing_paginate">\n                                    </div>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>\n    \n    <div class="modal" tabindex="-1">\n        <div class="modal-dialog">\n            <div class="modal-content">\n                <div class="modal-header">\n                    <h3 class="modal-title"></h3>\n                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>\n                </div>\n                <div class="modal-body">\n\n                </div>\n                <div class="modal-footer">\n                    <button type="button" class="btn btn-primary btn-modal"></button>\n                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal"></button>\n                </div>\n            </div>\n        </div>\n    </div>\n    \n    ')}(__))},renderPage:function(t){if(T.state.firstLoad&&((t=>{let e='<ol class="breadcrumb mt-2 mb-0">';for(let n of t)void 0===n.link?e+=`<li class="breadcrumb-item">${n.text}</li>`:e+=`<li class="breadcrumb-item"><a href="${n.link}">${n.text}</a></li>`;e+="</ol>",document.querySelector(".bc").innerHTML=e})([{link:i("https://dashboard.kenzap.cloud"),text:o("Home")},{link:i("/"),text:o("E-commerce")},{text:o("Inventory")}]),document.querySelector(".table thead").innerHTML='\n                <tr>\n                    <th class="align-middle text-center">\n                        <div class="d-block m-auto">\n                            <svg xmlns="http://www.w3.org/2000/svg" width="19" height="19" fill="#212529" class="bi justify-content-end bi-search" viewBox="0 0 16 16" >\n                                <path d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001c.03.04.062.078.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1.007 1.007 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0z"></path>\n                            </svg>\n                        </div>\n                    </th>\n                    <th class="align-middle">\n                        <div class="search-cont input-group input-group-sm mb-0 justify-content-start">     \n                            <div class="input-group">\n                                <input type="text" placeholder="'.concat(o("Search inventory"),'" class="form-control border-top-0 border-start-0 border-end-0 rounded-0 pe-4" aria-label="').concat(o("Search inventory"),'" aria-describedby="inputGroup-sizing-sm" style="max-width: 200px;">\n                                <button type="button" class="btn bg-transparent btn-search-clear" style="margin-left: -32px; z-index: 100;">\n                                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-x-circle" viewBox="0 0 16 16">\n                                        <path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z"/>\n                                        <path d="M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z"/>\n                                    </svg>\n                                </button>\n                            </div>\n                        </div>\n                        <div class="st-opts st-table dropdown dropstart-">\n                            <a class="text-black text-dark text-decoration-none fw-bolder border-0 dropdown-toggle select-updated-btn" href="#" role="button" id="order-updated" data-id="updated" data-value="" data-bs-toggle="dropdown" aria-expanded="false">\n                                ').concat(o("Title"),'\n                            </a>\n                            <ul class="dropdown-menu select-updated" aria-labelledby="order-updated">\n                                <li><a class="dppi dropdown-item" data-key="updated" href="#" >').concat(o("Title"),'</a></li>\n                                <li><a class="dppi dropdown-item" data-key="updated" href="#" >').concat(o("Updated"),'</a></li>\n                                <li><a class="dppi dropdown-item" data-key="stock_prediction" href="#" >').concat(o("Low stock warning"),'</a></li>\n                                <li><a class="dppi dropdown-item" data-key="updated" href="#" >').concat(o("Out of stock"),'</a></li>\n                            </ul>\n                        </div>\n                    </th>\n                    <th class="align-middle">\n                        ').concat(o("Stock"),'\n                    </th>\n                    <th class="align-middle d-none d-sm-table-cell">\n                        ').concat(o("Price"),'\n                    </th>\n                    <th class="align-middle d-none d-sm-table-cell">\n                        ').concat(o("Updated"),'\n                    </th>\n                    <th class="d-none"></th>\n                </tr>')),0!=t.inventory.length){var a=(()=>{let t=new URLSearchParams(window.location.search);return t.get("sid")?t.get("sid"):""})(),c="";for(var r in t.inventory){var s="https://cdn.kenzap.com/loading.png";void 0===t.inventory[r].img&&(t.inventory[r].img=[]),t.inventory[r].img[0]&&(s=CDN+"/S"+a+"/product-"+t.inventory[r]._id+"-1-100x100.jpeg?"+t.inventory[r].updated),c+='\n                <tr>\n                    <td>\n                        <div class="timgc view-item" data-id="'.concat(e(t.inventory[r]._id),'">\n                            <a href="#"><img src="').concat(s,'" data-srcset="').concat(s,'" class="img-fluid rounded" alt="').concat(n("Product placeholder"),'" srcset="').concat(s,'" ></a>\n                        </div>\n                    </td>\n                    <td class="destt view-item" data-id="').concat(e(t.inventory[r]._id),'" style="max-width:250px;min-width:120px;">\n                        <div class="my-1"> \n                            <a class="text-body" href="#" >').concat(t.inventory[r].title,'</a>\n                            <div class="form-text form-text d-flex fst-italic my-0">\n                                <div class="d-flex align-items-center">\n                                    <div>').concat(parseFloat(t.inventory[r].stock_amount).toFixed(2)," ").concat(t.inventory[r].stock_unit,'</div>\n                                    <div id="stock_arrow" class="triangle_down mx-2"></div>\n                                </div>\n                                <div class="d-flex align-items-center ms-1">\n                                    <div>').concat(_(T,parseFloat(t.inventory[r].price_per_unit)),'</div>\n                                    <div id="price_arrow" class="').concat(parseFloat(t.inventory[r].price_per_unit_prev)-parseFloat(t.inventory[r].price_per_unit)>0?"triangle_down triangle_green":""," ").concat(parseFloat(t.inventory[r].price_per_unit_prev)-parseFloat(t.inventory[r].price_per_unit)<0?"triangle_up triangle_red":"",' mx-2"></div>\n                                </div>\n                            </div>\n                        </div>\n                    </td>\n                    <td>\n                        <span>').concat(h(0,t.inventory[r]),'</span>\n                    </td>\n                    <td class="d-none d-sm-table-cell">\n                        <span>').concat(_(T,t.inventory[r].price),'</span>\n                    </td>\n                    <td class="d-none d-sm-table-cell">\n                        <span>').concat(w(__,t.inventory[r].updated),'</span>\n                    </td>\n                    <td class="text-end d-none">\n\n                    </td>\n                </tr>')}document.querySelector(".table tbody").innerHTML=c}else document.querySelector(".table tbody").innerHTML='<tr><td colspan="6" class="form-text">'.concat(o("No items to display."),"</td></tr>")},initListeners:function(){u(".remove-product",T.listeners.removeProduct),u(".view-item",(function(t){T.viewItem(t)})),u(".table-p-list .bi-search",T.listeners.searchInventoryActivate),u(".table-p-list .btn-search-clear",T.listeners.searchInventoryDeactivate),u(".table-p-list .inventoryActionsCont .dropdown-item",T.listeners.tableAction),T.state.firstLoad&&u(".btn-add",T.addItem)},listeners:{removeProduct:function(t){t.preventDefault(),confirm(n("Completely remove this product?"))&&fetch("https://api-v1.kenzap.cloud/",{method:"post",headers:l(),body:JSON.stringify({query:{product:{type:"delete",key:"ecommerce-inventory",id:t.currentTarget.dataset.id}}})}).then((function(t){return t.json()})).then((function(t){t.success?T.getData():d(t)})).catch((function(t){d(t)}))},searchInventoryActivate:function(t){t.preventDefault(),document.querySelector(".table-p-list thead tr th:nth-child(2) .st-table").style.display="none",document.querySelector(".table-p-list thead tr th:nth-child(2) .search-cont").style.display="flex",document.querySelector(".table-p-list thead tr th:nth-child(2) .search-cont input").focus(),((t,e)=>{if(document.querySelector(t))for(let n of document.querySelectorAll(t))n.removeEventListener("keyup",e,!0),n.addEventListener("keyup",e,!0)})(".table-p-list thead tr th:nth-child(2) .search-cont input",T.listeners.searchInventory)},searchInventoryDeactivate:function(t){t.preventDefault(),document.querySelector(".table-p-list thead tr th:nth-child(2) .st-table").style.display="block",document.querySelector(".table-p-list thead tr th:nth-child(2) .search-cont").style.display="none",document.querySelector(".search-cont input").value="",setTimeout((function(){T.getData()}),500)},tableAction:function(t){if(t.preventDefault(),T.state.id=t.currentTarget.dataset.id,"edit"===t.currentTarget.dataset.action)T.editItem(t)},searchInventory:function(t){t.preventDefault(),T.getData()}},viewItem:function(t){T.state.id=t.currentTarget.dataset.id,M(T)},editItem:function(t){T.state.action="edit",L(T)},addItem:function(t){T.state.action="add",L(T)},initPagination:function(t){g(__,t.meta,T.getData)},initFooter:function(){q(o("Created by %1$Kenzap%2$. ❤️ Licensed %3$GPL3%4$.",'<a class="text-muted" href="https://kenzap.com/" target="_blank">',"</a>",'<a class="text-muted" href="https://github.com/kenzap/ecommerce" target="_blank">',"</a>"))}};T.init()}();
